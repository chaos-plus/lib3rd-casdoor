(self.webpackChunkweb=self.webpackChunkweb||[]).push([[9436,6495],{28800:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return hs}});var a=n(1413),i=n(29439),r=n(3548),s=n(64657),o=n(97410),l=n(61763),c=n(29139),d=n(43295),p=n(97229),u=n(4574),h=n(87301),g=n(12998),m=n(14576),x=n(29074),Z=n(96351),y=n(47313),f=n(21911),v=n(46417),j=function(e){var t,n=e.account,a=g.ZP.useNotification(),s=(0,i.Z)(a,2),o=s[0],l=s[1],c=(0,f.k6)(),p=(0,f.TH)();(0,y.useEffect)((function(){var e;if(null!==n){var t,a=r.f3(n,null===n||void 0===n?void 0:n.organization,[r.BZ,r.CE]);if("/login"===(null===(e=p.state)||void 0===e?void 0:e.from)&&0!==a.length)if(a.some((function(e){return e.rule===r.BZ})))h(a.find((function(e){return e.rule===r.BZ})).name);else u(null===(t=a.filter((function(e){return e.rule===r.CE})))||void 0===t?void 0:t.map((function(e){return e.name})))}}),[n,null===(t=p.state)||void 0===t?void 0:t.from]);var u=function(e){var t="open".concat(Date.now()),n=(0,v.jsxs)(m.Z,{children:[(0,v.jsx)(d.ZP,{type:"link",size:"small",onClick:function(){return o.destroy(t)},children:Z.Z.t("general:Later")}),(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:function(){c.push("/mfa/setup?mfaType=".concat(e[0]),{from:"/"}),o.destroy(t)},children:Z.Z.t("general:Go to enable")})]});o.open({message:Z.Z.t("mfa:Enable multi-factor authentication"),description:(0,v.jsxs)(m.Z,{direction:"vertical",children:[Z.Z.t("mfa:To ensure the security of your account, it is recommended that you enable multi-factor authentication"),(0,v.jsx)(m.Z,{children:e.map((function(e){return(0,v.jsx)(x.Z,{color:"orange",children:e},e)}))})]}),btn:n,key:t})},h=function(e){var t="open".concat(Date.now()),n=(0,v.jsx)(m.Z,{children:(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:function(){o.destroy(t)},children:Z.Z.t("general:Confirm")})});o.open({message:Z.Z.t("mfa:Enable multi-factor authentication"),description:(0,v.jsxs)(m.Z,{direction:"vertical",children:[Z.Z.t("mfa:To ensure the security of your account, it is required to enable multi-factor authentication"),(0,v.jsx)(m.Z,{children:(0,v.jsx)(x.Z,{color:"orange",children:e})})]}),btn:n,key:t})};return(0,v.jsx)(v.Fragment,{children:l})},T=n(28303),k=n(69893),C=n(62458),b=n(67440),S=n(85104),w=n(30428),P=n(62505),A=n(67154),I=n(63004),F=n(36758),z=n(33466),N=n(88779),U=n(78270),E=n(82021),R=n(68197),L=n(74661),O=n(11034),V=n(30680),q=n(86151);function D(e){return fetch("".concat(r.nn,"/api/get-dashboard?owner=").concat(e),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var M=n(57499),B=function(e){var t=y.useState(null),n=(0,i.Z)(t,2),a=n[0],s=n[1],o=y.useState(M.x5()),l=(0,i.Z)(o,2),c=l[0],d=l[1],p=M.ny("home");y.useEffect((function(){return window.addEventListener("storageTourChanged",g),function(){return window.removeEventListener("storageTourChanged",g)}}),[]),y.useEffect((function(){return window.addEventListener("storageOrganizationChanged",m),function(){return window.removeEventListener("storageOrganizationChanged",m)}}),[e.owner]),y.useEffect((function(){r.$J(e.account)||e.history.push("/apps")}),[e.account]);var u=function(){var t="All"===localStorage.getItem("organization")?"":localStorage.getItem("organization");return!r.VN(e.account)&&r.$J(e.account)&&(t=e.account.owner),t};y.useEffect((function(){r.$J(e.account)&&D(u()).then((function(e){"ok"===e.status?s(e.data):r.PV("error",e.msg)}))}),[e.owner]);var g=function(){d(M.x5())},m=function(){r.$J(e.account)&&D(u()).then((function(e){"ok"===e.status?s(e.data):r.PV("error",e.msg)}))};return(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:[function(){if(null!==a){for(var e=document.getElementById("echarts-chart"),t=q.S1(e),n=new Date,i=[],s=30;s>=0;s--){var o=new Date(n);o.setDate(o.getDate()-s);var l=parseInt(o.getMonth())+1,c=parseInt(o.getDate()),d="".concat(l,"-").concat(c);i.push(d)}var p={title:{text:Z.Z.t("home:Past 30 Days")},tooltip:{trigger:"axis"},legend:{data:[Z.Z.t("general:Users"),Z.Z.t("general:Providers"),Z.Z.t("general:Applications"),Z.Z.t("general:Organizations"),Z.Z.t("general:Subscriptions"),Z.Z.t("general:Roles"),Z.Z.t("general:Groups"),Z.Z.t("general:Resources"),Z.Z.t("general:Certs"),Z.Z.t("general:Permissions"),Z.Z.t("general:Transactions"),Z.Z.t("general:Models"),Z.Z.t("general:Adapters"),Z.Z.t("general:Enforcers")],top:"10%"},grid:{left:"3%",right:"4%",bottom:"0",top:"25%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:i},yAxis:{type:"value"},series:[{name:Z.Z.t("general:Organizations"),type:"line",data:a.organizationCounts},{name:Z.Z.t("general:Users"),type:"line",data:a.userCounts},{name:Z.Z.t("general:Providers"),type:"line",data:a.providerCounts},{name:Z.Z.t("general:Applications"),type:"line",data:a.applicationCounts},{name:Z.Z.t("general:Subscriptions"),type:"line",data:a.subscriptionCounts},{name:Z.Z.t("general:Roles"),type:"line",data:a.roleCounts},{name:Z.Z.t("general:Groups"),type:"line",data:a.groupCounts},{name:Z.Z.t("general:Resources"),type:"line",data:a.resourceCounts},{name:Z.Z.t("general:Certs"),type:"line",data:a.certCounts},{name:Z.Z.t("general:Permissions"),type:"line",data:a.permissionCounts},{name:Z.Z.t("general:Transactions"),type:"line",data:a.transactionCounts},{name:Z.Z.t("general:Models"),type:"line",data:a.modelCounts},{name:Z.Z.t("general:Adapters"),type:"line",data:a.adapterCounts},{name:Z.Z.t("general:Enforcers"),type:"line",data:a.enforcerCounts}]};t.setOption(p);var u={body:{width:r.tq()?"340px":"100%",height:r.tq()?"100px":"150px",display:"flex",alignItems:"center",justifyContent:"center"}};return(0,v.jsxs)(R.Z,{id:"statistic",gutter:80,justify:"center",children:[(0,v.jsx)(L.Z,{span:50,style:{marginBottom:"10px"},children:(0,v.jsx)(h.Z,{variant:"borderless",styles:u,children:(0,v.jsx)(O.Z,{title:Z.Z.t("home:Total users"),fontSize:"100px",value:a.userCounts[30],valueStyle:{fontSize:"30px"},style:{width:"200px",paddingLeft:"10px"}})})}),(0,v.jsx)(L.Z,{span:50,style:{marginBottom:"10px"},children:(0,v.jsx)(h.Z,{variant:"borderless",styles:u,children:(0,v.jsx)(O.Z,{title:Z.Z.t("home:New users today"),fontSize:"100px",value:a.userCounts[30]-a.userCounts[29],valueStyle:{fontSize:"30px"},prefix:(0,v.jsx)(E.Z,{}),style:{width:"200px",paddingLeft:"10px"}})})}),(0,v.jsx)(L.Z,{span:50,style:{marginBottom:"10px"},children:(0,v.jsx)(h.Z,{variant:"borderless",styles:u,children:(0,v.jsx)(O.Z,{title:Z.Z.t("home:New users past 7 days"),value:a.userCounts[30]-a.userCounts[23],valueStyle:{fontSize:"30px"},prefix:(0,v.jsx)(E.Z,{}),style:{width:"200px",paddingLeft:"10px"}})})}),(0,v.jsx)(L.Z,{span:50,style:{marginBottom:"10px"},children:(0,v.jsx)(h.Z,{variant:"borderless",styles:u,children:(0,v.jsx)(O.Z,{title:Z.Z.t("home:New users past 30 days"),value:a.userCounts[30]-a.userCounts[0],valueStyle:{fontSize:"30px"},prefix:(0,v.jsx)(E.Z,{}),style:{width:"200px",paddingLeft:"10px"}})})})]})}}(),(0,v.jsx)("div",{id:"echarts-chart",style:{width:"80%",height:"400px",textAlign:"center",marginTop:"20px"}}),(0,v.jsx)(V.Z,{open:!r.tq()&&c,onClose:function(){M.o4(!1),d(!1)},steps:function(){var e=M.gk.home;return e.map((function(t,n){t.target=function(){return document.getElementById(t.id)||null},n===e.length-1&&(t.nextButtonProps={children:M.ts(p)})})),e}(),indicatorsRender:function(e,t){return(0,v.jsxs)("span",{children:[e+1," / ",t]})},onFinish:function(){""!==p&&(e.history.push("/"+p),M.o4(!0))}})]})},W=n(46652),H=n(13608),G=n(15671),J=n(43144),Q=n(60136),K=n(29388),_=h.Z.Meta,$=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"wrappedAsSilentSigninLink",value:function(e){return e.startsWith("http")&&(e+=e.includes("?")?"&silentSignin=1":"?silentSignin=1"),e}},{key:"renderCardMobile",value:function(e,t,n,a,i,s){var o=this,l=this.wrappedAsSilentSigninLink(t);return(0,v.jsxs)(h.Z.Grid,{style:{width:"100vw",textAlign:"center",cursor:"pointer"},onClick:function(){return r.d8(o,l)},children:[(0,v.jsx)("img",{src:e,alt:"logo",width:"100%",style:{marginBottom:"20px"}}),(0,v.jsx)(_,{title:n,description:a,style:{justifyContent:"center"}})]})}},{key:"renderCard",value:function(e,t,n,a,i,s){var o=this,l=this.wrappedAsSilentSigninLink(t);return(0,v.jsx)(L.Z,{style:{paddingLeft:"20px",paddingRight:"20px",paddingBottom:"20px",marginBottom:"20px"},span:6,children:(0,v.jsxs)(h.Z,{hoverable:!0,cover:(0,v.jsx)("img",{alt:"logo",src:e,style:{width:"100%",height:"200px",padding:"20px",objectFit:"scale-down"}}),onClick:function(){return r.d8(o,l)},style:s?{width:"320px",height:"100%"}:{width:"100%",height:"100%"},children:[(0,v.jsx)(_,{title:n,description:a}),(0,v.jsx)("br",{}),(0,v.jsx)("br",{}),(0,v.jsx)(_,{title:"",description:r.Hv(i)})]})})}},{key:"render",value:function(){return r.tq()?this.renderCardMobile(this.props.logo,this.props.link,this.props.title,this.props.desc,this.props.time,this.props.isSingle):this.renderCard(this.props.logo,this.props.link,this.props.title,this.props.desc,this.props.time,this.props.isSingle)}}]),n}(y.Component),Y=(0,f.EN)($),X=function(e){var t=e.items;return null===t||void 0===t?(0,v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"10%"},children:(0,v.jsx)(H.Z,{size:"large",tip:Z.Z.t("login:Loading"),style:{paddingTop:"10%"}})}):r.tq()?(0,v.jsx)(h.Z,{styles:{body:{padding:0}},children:t.map((function(e){return(0,v.jsx)(Y,{logo:e.logo,link:e.link,title:e.name,desc:e.description,isSingle:1===t.length},e.link)}))}):(0,v.jsx)("div",{style:{margin:"0 15px"},children:(0,v.jsx)(R.Z,{children:t.map((function(e){return(0,v.jsx)(Y,{logo:e.logo,link:e.link,title:e.name,desc:e.description,time:e.createdTime,isSingle:1===t.length},e.name)}))})})},ee=function(e){var t=y.useState(null),n=(0,i.Z)(t,2),a=n[0],r=n[1];y.useEffect((function(){null!==e.account&&W.rW("admin",e.account.owner).then((function(e){r(e.data||[])}))}),[e.account]);return(0,v.jsx)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:(0,v.jsx)(X,{items:null===a?null:a.map((function(t){var n=t.homepageUrl;return"<custom-url>"===n&&(n=e.account.homepage),{link:n,name:t.displayName,description:t.description,logo:t.logo,createdTime:""}}))})})},te=function(){var e=[{link:"/organizations",name:Z.Z.t("general:Organizations"),description:Z.Z.t("general:User containers")},{link:"/users",name:Z.Z.t("general:Users"),description:Z.Z.t("general:Users under all organizations")},{link:"/providers",name:Z.Z.t("general:Providers"),description:Z.Z.t("general:OAuth providers")},{link:"/applications",name:Z.Z.t("general:Applications"),description:Z.Z.t("general:Applications that require authentication")}];return(0,v.jsx)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:(0,v.jsx)(X,{items:e.map((function(e){return e.logo="".concat(r.WD,"/img").concat(e.link,".png"),e.createdTime="",e}))})})},ne=n(74294),ae=n(65454),ie=n(67155),re=n(68270),se=n(67019),oe=n(42375),le=n(14890);function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return fetch("".concat(r.nn,"/api/get-groups?owner=").concat(e,"&p=").concat(n,"&pageSize=").concat(a,"&field=").concat(i,"&value=").concat(s,"&sortField=").concat(o,"&sortOrder=").concat(l,"&withTree=").concat(t),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function de(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-group"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function pe(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-group"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var ue=n(76399),he=n(89772),ge=n(43932),me=n(83620),xe=function(e){var t=e.user,n=e.mfaType,s=e.onSuccess,o=(0,y.useState)(!1),l=(0,i.Z)(o,2),c=l[0],p=l[1],u=(0,y.useState)(!1),h=(0,i.Z)(u,2),g=h[0],m=h[1];(0,y.useEffect)((function(){c&&t&&me.D((0,a.Z)({mfaType:n},t)).then((function(e){"error"===e.status&&r.PV("error",Z.Z.t("mfa:Failed to initiate MFA"))}))}),[c]);var x=function(){return n===le.rW?""!==t.email:""!==t.phone};return(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(d.ZP,{type:"primary",onClick:function(){x()?p(!0):n===le.rW?r.PV("error",Z.Z.t("signup:Please input your Email!")):r.PV("error",Z.Z.t("signup:Please input your phone number!"))},children:Z.Z.t("general:Enable")}),(0,v.jsx)(ge.Z,{title:Z.Z.t("mfa:Enable multi-factor authentication"),open:c,onOk:function(){m(!0),me.PA((0,a.Z)({mfaType:n},t)).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Enabled successfully")),p(!1),s()):r.PV("error","".concat(Z.Z.t("general:Failed to enable"),": ").concat(e.msg))})).finally((function(){m(!1)}))},onCancel:function(){p(!1)},confirmLoading:g,children:(0,v.jsxs)("p",{children:[Z.Z.t("mfa:Please confirm the information below"),(0,v.jsx)("br",{}),(0,v.jsx)("b",{children:Z.Z.t("general:User")}),": ","".concat(t.owner,"/").concat(t.name),(0,v.jsx)("br",{}),n===le.rW?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("b",{children:Z.Z.t("general:Email")})," : ",t.email]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("b",{children:Z.Z.t("general:Phone")})," : ",t.phone]})]})})]})},Ze=n(74165),ye=n(15861),fe=n(70530);n(34);function ve(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return fetch("".concat(r.nn,"/api/get-resources?owner=").concat(e,"&user=").concat(t,"&p=").concat(n,"&pageSize=").concat(a,"&field=").concat(i,"&value=").concat(s,"&sortField=").concat(o,"&sortOrder=").concat(l),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function je(e,t,n,a,i,s){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=new FormData;return l.append("file",s),fetch("".concat(r.nn,"/api/upload-resource?owner=").concat(e,"&user=").concat(t,"&application=").concat("app-built-in","&tag=").concat(n,"&parent=").concat(a,"&fullFilePath=").concat(encodeURIComponent(i),"&provider=").concat(o),{body:l,method:"POST",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var Te=function(e){var t,n=(0,y.useState)(!0),a=(0,i.Z)(n,2),s=a[0],o=a[1],l=(0,y.useState)([]),c=(0,i.Z)(l,2),p=c[0],u=c[1],h=(0,y.useState)(""),g=(0,i.Z)(h,2),m=g[0],x=g[1],f=(0,y.useState)(),j=(0,i.Z)(f,2),T=j[0],k=j[1],C=(0,y.useState)(!1),b=(0,i.Z)(C,2),S=b[0],w=b[1],P=(0,y.useState)(!1),A=(0,i.Z)(P,2),I=A[0],F=A[1],z=e.title,N=e.setTitle,U=e.tag,E=e.disabled,O=e.user,V=e.buttonText,q=e.organization,D=function(e){return new Promise((function(t){var n=new Image;n.src=e,n.setAttribute("crossOrigin","anonymous"),n.onload=function(){var e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0,n.width,n.height);var a=e.toDataURL("image/png");t(a)}}))};return(0,y.useEffect)((function(){o(!0),ve(O.owner,O.name,"","","","","","").then((function(e){if("error"===e.status)return r.PV("error",e.msg),void o(!1);o(!1),u(function(e){var t=[];t.push({value:null===q||void 0===q?void 0:q.defaultAvatar});for(var n=0;n<e.length;n++)if("image"===e[n].fileType){var a="".concat(e[n].url);t.push({value:a})}return t}(e))}))}),[]),(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{type:"default",onClick:function(){w(!0)},disabled:E,children:V}),(0,v.jsx)(ge.Z,{maskClosable:!1,title:z,open:S,okText:z,confirmLoading:I,onCancel:function(){w(!1)},width:600,footer:[(0,v.jsx)(d.ZP,{block:!0,type:"primary",onClick:function(){F(!0),void T.getCroppedCanvas().toBlob((function(e){if(null===e)return r.PV("error","You must select a picture first!"),!1;var t=m.substring(m.indexOf("/")+1,m.indexOf(";base64")),n="".concat(U,"/").concat(O.owner,"/").concat(O.name,".").concat(t);return je(O.owner,O.name,U,"CropperDivModal",n,e).then((function(e){"ok"===e.status?window.location.href=window.location.pathname:r.PV("error",e.msg)})),!0}))||F(!1)},children:N},"submit")],children:(0,v.jsxs)(L.Z,{style:{margin:"0px auto 60px auto",width:1e3,height:350},children:[(0,v.jsxs)(R.Z,{style:{width:"100%",marginBottom:"20px"},children:[(0,v.jsx)("input",{style:{display:"none"},ref:function(e){return t=e},type:"file",accept:"image/*",onChange:function(e){var t;e.preventDefault(),e.dataTransfer?t=e.dataTransfer.files:e.target&&(t=e.target.files);var n=new FileReader;n.onload=function(){x(n.result)},t[0]instanceof Blob&&n.readAsDataURL(t[0])}}),(0,v.jsx)(d.ZP,{block:!0,onClick:function(){t.click()},children:Z.Z.t("user:Select a photo...")}),(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},loading:s,placeholder:Z.Z.t("user:Please select avatar from resources"),onChange:function(){var e=(0,ye.Z)((0,Ze.Z)().mark((function e(t){return(0,Ze.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=x,e.next=3,D(t);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),options:p,allowClear:!0})]}),(0,v.jsx)(fe.Z,{style:{height:"100%"},initialAspectRatio:1,preview:".img-preview",src:m,viewMode:1,guides:!0,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,onInitialized:function(e){k(e)}})]})})]})},ke=n(37718),Ce=function(e){var t=y.useState(!1),n=(0,i.Z)(t,2),a=n[0],s=n[1],o=y.useState(!1),l=(0,i.Z)(o,2),c=l[0],p=l[1],u=y.useState(""),h=(0,i.Z)(u,2),g=h[0],m=h[1],x=y.useState(""),f=(0,i.Z)(x,2),j=f[0],T=f[1],k=y.useState(""),C=(0,i.Z)(k,2),b=C[0],S=C[1],w=e.user,P=e.userName,A=e.organization,I=e.account,F=y.useState([]),z=(0,i.Z)(F,2),N=z[0],U=z[1],E=y.useState(!1),O=(0,i.Z)(E,2),V=O[0],q=O[1],D=y.useState(!1),M=(0,i.Z)(D,2),B=M[0],W=M[1],H=y.useState(""),G=(0,i.Z)(H,2),J=G[0],Q=G[1],K=y.useState(""),_=(0,i.Z)(K,2),$=_[0],Y=_[1];y.useEffect((function(){A&&U(A.passwordOptions)}),[w.owner]);var X=""!==w.password||""!==w.ldap;return(0,v.jsxs)(R.Z,{children:[(0,v.jsx)(d.ZP,{type:"default",disabled:e.disabled,onClick:function(){s(!0)},children:X?Z.Z.t("user:Modify password..."):Z.Z.t("user:Set password...")}),(0,v.jsx)(ge.Z,{maskClosable:!1,title:Z.Z.t("general:Password"),open:a,okText:Z.Z.t("user:Set Password"),cancelText:Z.Z.t("general:Cancel"),confirmLoading:c,onCancel:function(){s(!1)},onOk:function(){if(""!==j&&""!==b)if(j===b){if(p(!0),null===A)return r.PV("error","organization is null"),void p(!1);var e=ke.h(j,A.passwordOptions);if(""!==e)return r.PV("error",e),void p(!1);ue.setPassword(w.owner,P,g,j).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("user:Password set successfully")),s(!1)):r.PV("error",Z.Z.t("user:".concat(e.msg)))})).finally((function(){p(!1)}))}else r.PV("error",Z.Z.t("user:Two passwords you typed do not match."));else r.PV("error",Z.Z.t("user:Empty input!"))},width:600,children:(0,v.jsxs)(L.Z,{style:{margin:"0px auto 40px auto",width:1e3,height:300},children:[X&&!r.VN(I)?(0,v.jsx)(R.Z,{style:{width:"100%",marginBottom:"20px"},children:(0,v.jsx)(ae.Z.Password,{addonBefore:Z.Z.t("user:Old Password"),placeholder:Z.Z.t("user:input password"),onChange:function(e){return m(e.target.value)}})}):null,(0,v.jsx)(R.Z,{style:{width:"100%",marginBottom:"20px"},children:(0,v.jsx)(ae.Z.Password,{addonBefore:Z.Z.t("user:New Password"),placeholder:Z.Z.t("user:input password"),onChange:function(e){!function(e){T(e);var t=ke.h(e,N);q(""===t),Q(t)}(e.target.value)},status:!V&&J?"error":void 0})}),!V&&J&&(0,v.jsx)("div",{style:{color:"red",marginTop:"-20px"},children:J}),(0,v.jsx)(R.Z,{style:{width:"100%",marginBottom:"20px"},children:(0,v.jsx)(ae.Z.Password,{addonBefore:Z.Z.t("user:Re-enter New"),placeholder:Z.Z.t("user:input password"),onChange:function(e){return t=e.target.value,S(t),void(t!==j?(Y(Z.Z.t("signup:Your confirmed password is inconsistent with the password!")),W(!1)):W(!0));var t},status:!B&&$?"error":void 0})}),!B&&$&&(0,v.jsx)("div",{style:{color:"red",marginTop:"-20px"},children:$})]})})]})},be=n(15434),Se=n(87866),we=n(4123),Pe=function(e){var t=y.useState(!1),n=(0,i.Z)(t,2),a=n[0],s=n[1],o=y.useState(!1),l=(0,i.Z)(o,2),c=l[0],p=l[1],u=y.useState(""),h=(0,i.Z)(u,2),g=h[0],m=h[1],x=y.useState(""),f=(0,i.Z)(x,2),j=f[0],T=f[1],k=e.buttonText,C=e.destType,b=e.application,S=e.countryCode,w="";return"email"===C?w=Z.Z.t("user:Input your email"):"phone"===C&&(w=Z.Z.t("user:Input your phone number")),(0,v.jsxs)(R.Z,{children:[(0,v.jsx)(d.ZP,{type:"default",onClick:function(){s(!0)},children:k}),(0,v.jsx)(ge.Z,{maskClosable:!1,title:k,open:a,okText:k,cancelText:Z.Z.t("general:Cancel"),confirmLoading:c,onCancel:function(){s(!1)},onOk:function(){""!==g?""!==j?(p(!0),ue.resetEmailOrPhone(g,C,j).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("user:Email/phone reset successfully")),window.location.reload()):(r.PV("error",Z.Z.t("user:"+e.msg)),p(!1))}))):r.PV("error",Z.Z.t("code:Empty code")):"phone"===C?r.PV("error",Z.Z.t("user:Phone cannot be empty")):r.PV("error",Z.Z.t("user:Email cannot be empty"))},width:600,children:(0,v.jsxs)(L.Z,{style:{margin:"0px auto 40px auto",width:1e3,height:300},children:[(0,v.jsx)(R.Z,{style:{width:"100%",marginBottom:"20px"},children:(0,v.jsx)(ae.Z,{addonBefore:"email"===C?Z.Z.t("user:New Email"):Z.Z.t("user:New phone"),prefix:"email"===C?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(Se.Z,{}),"\xa0\xa0"]}):(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(we.Z,{}),"\xa0\xa0",""!==S?"+":null,r.so(S),"\xa0"]}),placeholder:w,onChange:function(e){return m(e.target.value)}})}),(0,v.jsx)(R.Z,{style:{width:"100%",marginBottom:"20px"},children:(0,v.jsx)(be.r,{textBefore:Z.Z.t("code:Code you received"),onChange:T,method:"reset",onButtonClickArgs:[g,C,r.ks(b)],application:b})})]})})]})},Ae=n(94346),Ie=n(70816),Fe=n.n(Ie),ze=n(98862),Ne=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,addressOptions:[],affiliationOptions:[]},a}return(0,J.Z)(n,[{key:"renderIdp",value:function(e,t,n){var a=n.provider,i=e.name;return(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:this.props.labelSpan,children:[r.ex(a),(0,v.jsx)("span",{style:{marginLeft:"5px"},children:"".concat(a.type,":")})]}),(0,v.jsx)(L.Z,{span:24-this.props.labelSpan,style:{marginTop:"5px"},children:(0,v.jsx)("span",{style:{width:3===this.props.labelSpan?"300px":"130px",display:r.tq()?"inline":"inline-block"},children:i})})]},a.name)}},{key:"render",value:function(){return this.renderIdp(this.props.user,this.props.application,this.props.providerItem)}}]),n}(y.Component),Ue=n(25453),Ee=n(11053),Re=n(13544),Le=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){return(0,G.Z)(this,n),t.apply(this,arguments)}return(0,J.Z)(n,[{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.props.updateTable(e)}},{key:"registerWebAuthn",value:function(){var e=this;Re.jT().then((function(t){"ok"===t.status?r.PV("success","Successfully added webauthn credentials"):r.PV("error",t.msg),e.props.refresh()})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this,t=[{title:Z.Z.t("general:Name"),dataIndex:"ID",key:"ID"},{title:Z.Z.t("general:Action"),key:"action",width:"170px",render:function(t,n,a){return(0,v.jsx)(d.ZP,{style:{marginTop:"5px",marginBottom:"5px",marginRight:"5px"},type:"primary",danger:!0,onClick:function(){e.deleteRow(e.props.table,a)},children:Z.Z.t("general:Delete")})}}];return(0,v.jsx)(Ee.Z,{rowKey:"ID",columns:t,dataSource:this.props.table,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("user:WebAuthn credentials"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{disabled:!e.props.isSelf,style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){e.registerWebAuthn()},children:Z.Z.t("general:Add")})]})}})}}]),n}(y.Component),Oe=Le,Ve=n(93433),qe=n(99223),De=n(18578),Me=n(47515),Be=ne.Z.Option,We=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a,i,r;return(0,G.Z)(this,n),(r=t.call(this,e)).count=null!==(a=null===(i=r.props.table)||void 0===i?void 0:i.length)&&void 0!==a?a:0,r.state={classes:e,managedAccounts:null!==r.props.table?r.props.table.map((function(e,t){return e.key=t,e})):[]},r}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.setState({managedAccounts:e}),this.props.onUpdateTable((0,Ve.Z)(e).map((function(e){var t=r.p$(e);return delete t.key,t})))}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={key:this.count,application:"",username:"",password:""};void 0!==e&&null!==e||(e=[]),this.count+=1,e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Application"),dataIndex:"application",key:"application",render:function(n,a,i){var r=t.props.applications;return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"application",n)},children:r.map((function(e,t){return(0,v.jsx)(Be,{value:e.name,children:e.name},t)}))})}},{title:Z.Z.t("general:Signin URL"),dataIndex:"signinUrl",key:"signinUrl",render:function(n,a,i){return(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:n,onChange:function(n){t.updateField(e,i,"signinUrl",n.target.value)}})}},{title:Z.Z.t("signup:Username"),dataIndex:"username",key:"username",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"username",n.target.value)}})}},{title:Z.Z.t("general:Password"),dataIndex:"password",key:"password",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z.Password,{value:n,onChange:function(n){t.updateField(e,i,"password",n.target.value)}})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"key",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.state.managedAccounts)})})})}}]),n}(y.Component),He=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).page=1,a.pageSize=10,a.count=null!==a.props.properties?Object.entries(a.props.properties).length:0,a.state={properties:[]},null!==a.props.properties&&Object.entries(a.props.properties).map((function(e,t){a.state.properties.push({key:t,name:e[0],value:e[1]})})),a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.setState({properties:e});var t={};e.map((function(e){t[e.name]=e.value})),this.props.onUpdateTable(t)}},{key:"addRow",value:function(e){var t={key:this.count,name:"",value:""};void 0===e&&(e=[]),e=r.SA(e,t),this.count=this.count+1,this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,this.getIndex(t)),this.updateTable(e)}},{key:"getIndex",value:function(e){return e+(this.page-1)*this.pageSize}},{key:"updateField",value:function(e,t,n,a){e[this.getIndex(t)][n]=a,this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("user:Keys"),dataIndex:"name",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"name",n.target.value)}})}},{title:Z.Z.t("user:Values"),dataIndex:"value",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"value",n.target.value)}})}},{title:Z.Z.t("general:Action"),dataIndex:"operation",width:"20px",render:function(n,a,i){return(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})}}];return(0,v.jsx)(Ee.Z,{title:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})})},pagination:{defaultPageSize:this.pageSize,onChange:function(e){t.page=e}},columns:n,dataSource:e,rowKey:"key",size:"middle",bordered:!0})}},{key:"render",value:function(){return(0,v.jsx)(y.Fragment,{children:this.renderTable(this.state.properties)})}}]),n}(y.Component),Ge=He,Je=n(39790),Qe=n(23983),Ke=function(e){var t=e.text?e.text:Z.Z.t("general:Delete"),n=e.size?e.size:"middle";return(0,v.jsx)(Qe.Z,{title:e.title,onConfirm:e.onConfirm,disabled:e.disabled,okText:Z.Z.t("general:OK"),cancelText:Z.Z.t("general:Cancel"),children:(0,v.jsx)(d.ZP,{style:(0,a.Z)({},e.style),size:n,disabled:e.disabled,type:"primary",danger:!0,children:t})})},_e=n(45717),$e=n(96827),Ye=n(16430),Xe=n(26361),et=(0,y.lazy)((function(){return Promise.all([n.e(5918),n.e(1041)]).then(n.bind(n,98558))})),tt=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,openFaceRecognitionModal:!1},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"addFaceId",value:function(e,t){var n={name:r.VO(),faceIdData:t};void 0!==e&&null!==e||(e=[]),e=r.SA(e,n),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{defaultValue:n,onChange:function(n){t.updateField(e,i,"name",n.target.value)}})}},{title:Z.Z.t("general:FaceIdData"),dataIndex:"faceIdData",key:"faceIdData",render:function(e,t,n){return"["+e.slice(0,3).join(", ")+" ... "+e.slice(-3).join(", ")+"]"}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsx)(d.ZP,{style:{marginTop:"5px",marginBottom:"5px",marginRight:"5px"},type:"primary",danger:!0,onClick:function(){t.deleteRow(e,i)},children:Z.Z.t("general:Delete")})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:this.props.table,size:"middle",bordered:!0,pagination:!1,title:function(){var n,a;return(0,v.jsxs)("div",{children:[Z.Z.t("user:Face IDs"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{disabled:(null===(n=t.props.table)||void 0===n?void 0:n.length)>=5,style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.setState({openFaceRecognitionModal:!0,withImage:!1})},children:Z.Z.t("general:Add Face Id")}),(0,v.jsx)(d.ZP,{disabled:(null===(a=t.props.table)||void 0===a?void 0:a.length)>=5,style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.setState({openFaceRecognitionModal:!0,withImage:!0})},children:Z.Z.t("general:Add Face Id with image")}),(0,v.jsx)(y.Suspense,{fallback:null,children:(0,v.jsx)(et,{visible:t.state.openFaceRecognitionModal,withImage:t.state.withImage,onOk:function(n){t.addFaceId(e,n),t.setState({openFaceRecognitionModal:!1})},onCancel:function(){return t.setState({openFaceRecognitionModal:!1})}})})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),nt=n(22971),at=n(61677),it=n(39479),rt=n(92692),st=n(92229),ot=n.n(st),lt=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",a=null;return e?(n="casdoor-authenticator://login?serverUrl=".concat(window.location.origin,"&accessToken=").concat(e),t&&n.length>=2e3&&(n="",a=Z.Z.t("general:QR code is too large")),{qrUrl:n,error:a}):{qrUrl:n,error:a=Z.Z.t("general:Access token is empty")}},ct=function(e){var t=e.accessToken,n=e.icon,a=lt(t,!0),i=a.qrUrl,r=a.error;return r?(0,v.jsx)(it.Z,{message:r,type:"error",showIcon:!0}):(0,v.jsx)(rt.Z,{value:i,icon:n,errorLevel:"M",size:230,bordered:!1})},dt=function(e){var t=e.accessToken,n=lt(t,!1),a=n.qrUrl,i=n.error,s=function(){var e=(0,ye.Z)((0,Ze.Z)().mark((function e(){return(0,Ze.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isSecureContext){e.next=2;break}return e.abrupt("return");case 2:ot()(a),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i?(0,v.jsx)(it.Z,{message:i,type:"error",showIcon:!0}):(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:window.isSecureContext&&(0,v.jsx)(d.ZP,{size:"small",type:"primary",onClick:s,style:{marginLeft:"10px"},children:Z.Z.t("resource:Copy Link")})}),(0,v.jsx)("div",{style:{padding:"10px",maxWidth:"400px",maxHeight:"100px",overflow:"auto",wordBreak:"break-all",whiteSpace:"pre-wrap",cursor:"pointer",userSelect:"all",backgroundColor:"#f5f5f5",borderRadius:"4px"},onClick:function(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e.target),t.removeAllRanges(),t.addRange(n)},children:a})]})},pt=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a,i,r;return(0,G.Z)(this,n),(r=t.call(this,e)).count=null!==(a=null===(i=r.props.table)||void 0===i?void 0:i.length)&&void 0!==a?a:0,r.state={classes:e,icon:r.props.icon,mfaAccounts:null!==r.props.table?r.props.table.map((function(e,t){return e.key=t,e})):[]},r}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.setState({mfaAccounts:e}),this.props.onUpdateTable((0,Ve.Z)(e).map((function(e){var t=r.p$(e);return delete t.key,t})))}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={key:this.count,accountName:"",issuer:"",secretKey:""};void 0!==e&&null!==e||(e=[]),this.count+=1,e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("mfaAccount:Account Name"),dataIndex:"accountName",key:"accountName",width:"400px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"accountName",n.target.value)}})}},{title:Z.Z.t("mfaAccount:Issuer"),dataIndex:"issuer",key:"issuer",width:"300px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"issuer",n.target.value)}})}},{title:Z.Z.t("mfaAccount:Origin"),dataIndex:"origin",key:"origin",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"origin",n.target.value)}})}},{title:Z.Z.t("mfaAccount:Secret Key"),dataIndex:"secretKey",key:"secretKey",render:function(n,a,i){return(0,v.jsx)(ae.Z.Password,{value:n,onChange:function(n){t.updateField(e,i,"secretKey",n.target.value)}})}},{title:Z.Z.t("general:Logo"),dataIndex:"issuer",key:"logo",width:"60px",render:function(e,t,n){return(0,v.jsx)(l.Z,{children:e?(0,v.jsx)(nt.Z,{width:36,height:36,preview:!1,src:"https://cdn.casbin.org/img/social_".concat(e.toLowerCase(),".png"),fallback:"https://cdn.casbin.org/img/social_default.png",alt:e}):(0,v.jsx)(nt.Z,{width:36,height:36,preview:!1,src:"https://cdn.casbin.org/img/social_default.png",alt:"default"})})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"key",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"10px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")}),(0,v.jsx)(at.Z,{trigger:"focus",overlayInnerStyle:{padding:0},content:(0,v.jsx)(ct,{accessToken:t.props.accessToken,icon:t.state.icon}),children:(0,v.jsx)(d.ZP,{style:{marginRight:"10px"},type:"primary",size:"small",children:Z.Z.t("general:QR Code")})}),(0,v.jsx)(at.Z,{trigger:"click",content:(0,v.jsx)(dt,{accessToken:t.props.accessToken}),children:(0,v.jsx)(d.ZP,{type:"primary",size:"small",children:Z.Z.t("general:URL")})})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.state.mfaAccounts)})})})}}]),n}(y.Component),ut=ne.Z.Option,ht=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).deleteMfa=function(){a.setState({RemoveMfaLoading:!0}),(0,me.pj)({owner:a.state.user.owner,name:a.state.user.name}).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),a.setState({multiFactorAuths:e.data})):r.PV("error",Z.Z.t("general:Failed to delete"))})).finally((function(){a.setState({RemoveMfaLoading:!1})}))},a.state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,userName:void 0!==e.userName?e.userName:e.match.params.userName,user:null,application:null,groups:null,organizations:[],applications:[],mode:void 0!==e.location.mode?e.location.mode:"edit",loading:!0,returnUrl:null,idCardInfo:["ID card front","ID card back","ID card with person"],openFaceRecognitionModal:!1},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getUser(),r.$J(this.props.account)&&this.getOrganizations(),this.getApplicationsByOrganization(this.state.organizationName),this.getUserApplication(),this.setReturnUrl()}},{key:"componentDidUpdate",value:function(e,t,n){t.application!==this.state.application&&this.getGroups(this.state.organizationName)}},{key:"getUser",value:function(){var e=this;ue.getUser(this.state.organizationName,this.state.userName).then((function(t){var n,a;null!==t.data?"error"!==t.status?e.setState({user:t.data,multiFactorAuths:null!==(n=null===(a=t.data)||void 0===a?void 0:a.multiFactorAuths)&&void 0!==n?n:[],loading:!1}):r.PV("error",t.msg):e.props.history.push("/404")}))}},{key:"addUserKeys",value:function(){var e=this;ue.addUserKeys(this.state.user).then((function(t){"ok"===t.status?e.getUser():r.PV("error",t.msg)}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getApplicationsByOrganization",value:function(e){var t=this;W.rW("admin",e).then((function(e){t.setState({applications:e.data||[]});var n=e.data;t.state.user&&(""!==t.state.user.signupApplication&&0!==n.filter((function(e){return e.name===t.state.user.signupApplication})).length||(n.length>0?t.updateUserField("signupApplication",n[0].name):t.updateUserField("signupApplication","")))}))}},{key:"getUserApplication",value:function(){var e=this;W.QL(this.state.organizationName,this.state.userName).then((function(t){"error"!==t.status?e.setState({application:t.data}):r.PV("error",t.msg)}))}},{key:"getUserOrganization",value:function(){var e;return null===(e=this.state.application)||void 0===e?void 0:e.organizationObj}},{key:"isGroupsVisible",value:function(){var e,t=this.getUserOrganization();return!!t&&(null===(e=t.accountItems)||void 0===e?void 0:e.some((function(e){return"Groups"===e.name&&e.visible})))}},{key:"getGroups",value:function(e){var t=this;r.$J(this.props.account)&&this.isGroupsVisible()&&ce(e).then((function(e){"ok"===e.status&&t.setState({groups:e.data})}))}},{key:"setReturnUrl",value:function(){var e=new URLSearchParams(this.props.location.search).get("returnUrl");null!==e&&this.setState({returnUrl:e})}},{key:"parseUserField",value:function(e,t){return["score","karma","ranking"].includes(e)&&(t=r.Js(t)),t}},{key:"updateUserField",value:function(e,t,n){if(null!==this.props.account){t=this.parseUserField(e,t);var a=this.state.user;"address"===e?(a[e]||(a[e]=["",""]),a[e][n]=t):a[e]=t,this.setState({user:a})}}},{key:"unlinked",value:function(){this.getUser()}},{key:"isSelf",value:function(){var e;return this.state.user.id===(null===(e=this.props.account)||void 0===e?void 0:e.id)}},{key:"isSelfOrAdmin",value:function(){return this.isSelf()||r.$J(this.props.account)}},{key:"getCountryCode",value:function(){return this.props.account.countryCode}},{key:"renderAccountItem",value:function(e){var t,n=this,a=r.$J(this.props.account),i=!1;("Self"===e.modifyRule?this.isSelfOrAdmin()||(i=!0):"Admin"===e.modifyRule?a||(i=!0):"Immutable"===e.modifyRule&&(i=!0),"Organization"!==e.name&&"Name"!==e.name||"built-in"===this.state.user.owner&&"admin"===this.state.user.name&&(i=!0),"ID card info"===e.name||"ID card"===e.name)&&("true"===(null===(t=this.state.user.properties)||void 0===t?void 0:t.isIdCardVerified)&&(i=!0));var s,o,c,p,u,g,f,j,T,k,C=!1;if(""!==this.state.user.accessKey&&""!==this.state.user.accessKey&&(C=!0),"Organization"===e.name)return(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:i,value:this.state.user.owner,onChange:function(e){n.getApplicationsByOrganization(e),n.updateUserField("owner",e),n.getGroups(e)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(ut,{value:e.name,children:e.name},t)}))})})]});if("Groups"===e.name)return(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Groups"),Z.Z.t("general:Groups - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},disabled:i,value:null!==(s=this.state.user.groups)&&void 0!==s?s:[],onChange:function(e){var t;(null===(t=n.state.groups)||void 0===t?void 0:t.filter((function(t){return e.includes(t.name)})).filter((function(e){return"Physical"===e.type})).length)>1?r.PV("error",Z.Z.t("general:You can only select one physical group")):n.updateUserField("groups",e)},children:null===(o=this.state.groups)||void 0===o?void 0:o.map((function(e){return(0,v.jsx)(ut,{value:"".concat(e.owner,"/").concat(e.name),children:(0,v.jsxs)(m.Z,{children:["Physical"===e.type?(0,v.jsx)(_e.Z,{}):(0,v.jsx)($e.Z,{}),e.displayName]})},e.name)}))})})]});if("ID"===e.name)return(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id("ID",Z.Z.t("general:ID - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.id,disabled:i,onChange:function(e){n.updateUserField("id",e.target.value)}})})]});if("Name"===e.name)return(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.name,disabled:i,onChange:function(e){n.updateUserField("name",e.target.value)}})})]});if("Display name"===e.name)return(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.displayName,onChange:function(e){n.updateUserField("displayName",e.target.value)}})})]});if("Avatar"===e.name)return(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Avatar"),Z.Z.t("general:Avatar - Tooltip"))," :"]}),this.renderImage(this.state.user.avatar,Z.Z.t("user:Upload a photo"),Z.Z.t("user:Set new profile picture"),"avatar",!1)]});if("User type"===e.name){var b=["normal-user","paid-user"],S=this.getUserOrganization();return S&&S.userTypes&&S.userTypes.length>0&&(b=S.userTypes),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:User type"),Z.Z.t("general:User type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.user.type,onChange:function(e){n.updateUserField("type",e)},options:b.map((function(e){return r.Rl(e,e)}))})})]})}return"Password"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password"),Z.Z.t("general:Password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:this.state.user.name===this.state.userName?(0,v.jsx)(Ce,{user:this.state.user,userName:this.state.userName,organization:this.getUserOrganization(),account:this.props.account,disabled:i}):(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("user:You have changed the username, please save your change first before modifying the password"),children:(0,v.jsx)("span",{children:(0,v.jsx)(Ce,{user:this.state.user,userName:this.state.userName,organization:this.getUserOrganization(),account:this.props.account,disabled:!0})})})})]}):"Email"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Email"),Z.Z.t("general:Email - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{style:{paddingRight:"20px"},span:11,children:(0,v.jsx)(ae.Z,{value:this.state.user.email,style:{width:"280Px"},disabled:!r.$J(this.props.account)||i,onChange:function(e){n.updateUserField("email",e.target.value)}})}),(0,v.jsx)(L.Z,{span:r.tq()?22:11,children:this.isSelf()?(0,v.jsx)(Pe,{application:this.state.application,disabled:i,buttonText:Z.Z.t("user:Reset Email..."),destType:"email"}):null})]}):"Phone"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Phone"),Z.Z.t("general:Phone - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{style:{paddingRight:"20px"},span:11,children:(0,v.jsxs)(ae.Z.Group,{compact:!0,style:{width:"280Px"},children:[(0,v.jsx)(Je.l,{style:{width:"30%"},initValue:this.state.user.countryCode,onChange:function(e){n.updateUserField("countryCode",e)},countryCodes:null===(c=this.getUserOrganization())||void 0===c?void 0:c.countryCodes}),(0,v.jsx)(ae.Z,{value:this.state.user.phone,style:{width:"70%"},disabled:!r.$J(this.props.account)||i,onChange:function(e){n.updateUserField("phone",e.target.value)}})]})}),(0,v.jsx)(L.Z,{span:r.tq()?24:11,children:this.isSelf()?(0,v.jsx)(Pe,{application:this.state.application,countryCode:this.getCountryCode(),disabled:i,buttonText:Z.Z.t("user:Reset Phone..."),destType:"phone"}):null})]}):"Country/Region"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Country/Region"),Z.Z.t("user:Country/Region - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Ue.Z,{defaultValue:this.state.user.region,onChange:function(e){n.updateUserField("region",e)}})})]}):"Location"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Location"),Z.Z.t("user:Location - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.location,onChange:function(e){n.updateUserField("location",e.target.value)}})})]}):"Address"===e.name?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Address"),Z.Z.t("user:Address - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[(0,v.jsx)("span",{children:Z.Z.t("user:Address line")+" 1"})," :"]}),(0,v.jsx)(L.Z,{span:20,children:(0,v.jsx)(ae.Z,{value:this.state.user.address?this.state.user.address[0]:"",onChange:function(e){n.updateUserField("address",e.target.value,0)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2}),(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[(0,v.jsx)("span",{children:Z.Z.t("user:Address line")+" 2"})," :"]}),(0,v.jsx)(L.Z,{span:20,children:(0,v.jsx)(ae.Z,{value:this.state.user.address?this.state.user.address[1]:"",onChange:function(e){n.updateUserField("address",e.target.value,1)}})})]})]}):"Affiliation"===e.name?null===this.state.application||null===this.state.user?null:(0,v.jsx)(Ae.Z,{labelSpan:r.tq()?22:2,application:this.state.application,user:this.state.user,onUpdateUserField:function(e,t){return n.updateUserField(e,t)}}):"Title"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Title"),Z.Z.t("user:Title - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.title,onChange:function(e){n.updateUserField("title",e.target.value)}})})]}):"ID card type"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:ID card type"),Z.Z.t("user:ID card type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.idCardType,onChange:function(e){n.updateUserField("idCardType",e.target.value)}})})]}):"ID card"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:ID card"),Z.Z.t("user:ID card - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.idCard,disabled:i,onChange:function(e){n.updateUserField("idCard",e.target.value)}})})]}):"ID card info"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:ID card info"),Z.Z.t("user:ID card info - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:[{name:"ID card front",value:"idCardFront"},{name:"ID card back",value:"idCardBack"},{name:"ID card with person",value:"idCardWithPerson"}].map((function(e){return n.renderImage(null===n.state.user.properties?"":n.state.user.properties[e.value]||"",n.getIdCardType(e.name),n.getIdCardText(e.name),e.value,i)}))})})]}):"Homepage"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Homepage"),Z.Z.t("user:Homepage - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.homepage,onChange:function(e){n.updateUserField("homepage",e.target.value)}})})]}):"Bio"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Bio"),Z.Z.t("user:Bio - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.bio,onChange:function(e){n.updateUserField("bio",e.target.value)}})})]}):"Tag"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Tag"),Z.Z.t("user:Tag - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(null===(p=this.getUserOrganization())||void 0===p||null===(u=p.tags)||void 0===u?void 0:u.length)>0?(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.user.tag,onChange:function(e){n.updateUserField("tag",e)},options:null===(g=this.getUserOrganization())||void 0===g||null===(f=g.tags)||void 0===f?void 0:f.map((function(e){var t=e.split("|"),n=t[0],a="zh"!==r.G3()?t[0]:t[1];return r.Rl(a,n)}))}):(0,v.jsx)(ae.Z,{value:this.state.user.tag,onChange:function(e){n.updateUserField("tag",e.target.value)}})})]}):"Language"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Language"),Z.Z.t("user:Language - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.language,onChange:function(e){n.updateUserField("language",e.target.value)}})})]}):"Gender"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Gender"),Z.Z.t("user:Gender - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.gender,onChange:function(e){n.updateUserField("gender",e.target.value)}})})]}):"Birthday"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Birthday"),Z.Z.t("user:Birthday - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.birthday,onChange:function(e){n.updateUserField("birthday",e.target.value)}})})]}):"Education"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Education"),Z.Z.t("user:Education - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.education,onChange:function(e){n.updateUserField("education",e.target.value)}})})]}):"Balance"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Balance"),Z.Z.t("user:Balance - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.user.balance,onChange:function(e){n.updateUserField("balance",e)}})})]}):"Score"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Score"),Z.Z.t("user:Score - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.user.score,onChange:function(e){n.updateUserField("score",e)}})})]}):"Karma"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Karma"),Z.Z.t("user:Karma - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.user.karma,onChange:function(e){n.updateUserField("karma",e)}})})]}):"Ranking"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Ranking"),Z.Z.t("user:Ranking - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.user.ranking,onChange:function(e){n.updateUserField("ranking",e)}})})]}):"Signup application"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Signup application"),Z.Z.t("general:Signup application - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:i,value:this.state.user.signupApplication,onChange:function(e){n.updateUserField("signupApplication",e)},options:this.state.applications.map((function(e){return r.Rl(e.name,e.name)}))})})]}):"API key"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:API key"),Z.Z.t("general:API key - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:Access key"),Z.Z.t("general:Access key - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.accessKey,disabled:!0})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:Access secret"),Z.Z.t("general:Access secret - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.accessSecret,disabled:!0})})]}),(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(d.ZP,{onClick:function(){return n.addUserKeys()},children:Z.Z.t(C?"general:update":"general:generate")})})})]})]}):"Roles"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px",alignItems:"center"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Roles"),Z.Z.t("general:Roles - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:r.NJ(this.state.user.roles.map((function(e){return e.name})))})]}):"Permissions"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px",alignItems:"center"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Permissions"),Z.Z.t("general:Permissions - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:r.NJ(this.state.user.permissions.map((function(e){return e.name})))})]}):"3rd-party logins"===e.name?this.isSelfOrAdmin()?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:3rd-party logins"),Z.Z.t("user:3rd-party logins - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)("div",{style:{marginBottom:20},children:null===this.state.application||null===this.state.user?null:null===(j=this.state.application)||void 0===j?void 0:j.providers.filter((function(e){return r.z8(e)})).map((function(e){return"OAuth"===e.provider.category||"Web3"===e.provider.category?(0,v.jsx)(ze.Z,{labelSpan:r.tq()?10:3,user:n.state.user,application:n.state.application,providerItem:e,account:n.props.account,onUnlinked:function(){return n.unlinked()}},e.name):(0,v.jsx)(Ne,{labelSpan:r.tq()?10:3,user:n.state.user,application:n.state.application,providerItem:e,onUnlinked:function(){return n.unlinked()}},e.name)}))})})]}):null:"Properties"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Properties"),Z.Z.t("user:Properties - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Ge,{properties:this.state.user.properties,onUpdateTable:function(e){n.updateUserField("properties",e)}})})]}):"Is admin"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Is admin"),Z.Z.t("user:Is admin - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:r.tq()?22:2,children:(0,v.jsx)(re.Z,{disabled:i,checked:this.state.user.isAdmin,onChange:function(e){n.updateUserField("isAdmin",e)}})})]}):"Is forbidden"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Is forbidden"),Z.Z.t("user:Is forbidden - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:r.tq()?22:2,children:(0,v.jsx)(re.Z,{checked:this.state.user.isForbidden,onChange:function(e){n.updateUserField("isForbidden",e)}})})]}):"Is deleted"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Is deleted"),Z.Z.t("user:Is deleted - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:r.tq()?22:2,children:(0,v.jsx)(re.Z,{checked:this.state.user.isDeleted,onChange:function(e){n.updateUserField("isDeleted",e),n.updateUserField("deletedTime",e?Fe()().format():"")}})})]}):"Multi-factor authentication"===e.name?this.isSelfOrAdmin()?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("mfa:Multi-factor authentication"),Z.Z.t("mfa:Multi-factor authentication - Tooltip "))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(h.Z,{size:"small",title:Z.Z.t("mfa:Multi-factor methods"),extra:null!==(T=this.state.multiFactorAuths)&&void 0!==T&&T.some((function(e){return e.enabled}))?(0,v.jsx)(Ke,{text:Z.Z.t("general:Disable"),title:Z.Z.t("general:Sure to disable")+"?",onConfirm:function(){return n.deleteMfa()}}):null,children:(0,v.jsx)(se.Z,{rowKey:"mfaType",itemLayout:"horizontal",dataSource:this.state.multiFactorAuths,renderItem:function(e,t){return(0,v.jsxs)(se.Z.Item,{children:[(0,v.jsxs)(m.Z,{children:[Z.Z.t("general:Type"),": ",e.mfaType,e.secret]}),e.enabled?(0,v.jsxs)(m.Z,{children:[(0,v.jsx)(x.Z,{icon:(0,v.jsx)(Ye.Z,{}),color:"success",children:Z.Z.t("general:Enabled")}),e.isPreferred?(0,v.jsx)(x.Z,{icon:(0,v.jsx)(Ye.Z,{}),color:"blue",style:{marginRight:20},children:Z.Z.t("mfa:preferred")}):(0,v.jsx)(d.ZP,{type:"primary",style:{marginRight:20},onClick:function(){var t={owner:n.state.user.owner,name:n.state.user.name,mfaType:e.mfaType};me.mt(t).then((function(e){"ok"===e.status&&n.setState({multiFactorAuths:e.data})}))},children:Z.Z.t("mfa:Set preferred")}),n.isSelf()?(0,v.jsx)(d.ZP,{type:"default",onClick:function(){n.props.history.push("/mfa/setup?mfaType=".concat(e.mfaType))},children:Z.Z.t("general:Edit")}):null]}):(0,v.jsxs)(m.Z,{children:[e.mfaType!==le.XH&&r.$J(n.props.account)&&!n.isSelf()?(0,v.jsx)(xe,{user:n.state.user,mfaType:e.mfaType,onSuccess:function(){n.getUser()}}):null,n.isSelf()?(0,v.jsx)(d.ZP,{type:"default",onClick:function(){n.props.history.push("/mfa/setup?mfaType=".concat(e.mfaType))},children:Z.Z.t("mfa:Setup")}):null]})]})}})})})]}):null:"WebAuthn credentials"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:WebAuthn credentials"),Z.Z.t("user:WebAuthn credentials"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Oe,{isSelf:this.isSelf(),table:this.state.user.webauthnCredentials,updateTable:function(e){n.updateUserField("webauthnCredentials",e)},refresh:this.getUser.bind(this)})})]}):"Last change password time"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Last change password time"),Z.Z.t("user:Last change password time"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.lastChangePasswordTime,onChange:function(e){n.updateUserField("lastChangePasswordTime",e.target.value)}})})]}):"Managed accounts"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Managed accounts"),Z.Z.t("user:Managed accounts"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(We,{title:Z.Z.t("user:Managed accounts"),table:this.state.user.managedAccounts,onUpdateTable:function(e){n.updateUserField("managedAccounts",e)},applications:this.state.applications})})]}):"Face ID"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Face IDs"),Z.Z.t("user:Face IDs"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(tt,{title:Z.Z.t("user:Face IDs"),table:this.state.user.faceIds,onUpdateTable:function(e){n.updateUserField("faceIds",e)}})})]}):"MFA accounts"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:MFA accounts"),Z.Z.t("user:MFA accounts"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(pt,{title:Z.Z.t("user:MFA accounts"),table:this.state.user.mfaAccounts,accessToken:null===(k=this.props.account)||void 0===k?void 0:k.accessToken,icon:this.state.user.avatar,onUpdateTable:function(e){n.updateUserField("mfaAccounts",e)}})})]}):"Need update password"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Need update password"),Z.Z.t("user:Need update password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:r.tq()?22:2,children:(0,v.jsx)(re.Z,{disabled:!this.state.user.phone&&!this.state.user.email&&!this.state.user.mfaProps,checked:this.state.user.needUpdatePassword,onChange:function(e){n.updateUserField("needUpdatePassword",e)}})})]}):"IP whitelist"===e.name?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:IP whitelist"),Z.Z.t("general:IP whitelist - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.user.ipWhitelist,onChange:function(e){n.updateUserField("ipWhitelist",e.target.value)}})})]}):void 0}},{key:"renderImage",value:function(e,t,n,a,i){return(0,v.jsxs)(L.Z,{span:4,style:{textAlign:"center",margin:"auto",marginLeft:"20px"},children:[e?(0,v.jsx)("div",{style:{marginBottom:"10px"},children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,style:{marginBottom:"10px"},children:(0,v.jsx)(Xe.Z,{src:e,alt:e,height:150})})}):(0,v.jsxs)(L.Z,{style:{height:"78%",border:"1px dotted grey",borderRadius:3,marginBottom:"10px"},children:[(0,v.jsx)("div",{style:{fontSize:30,margin:10},children:"+"}),(0,v.jsx)("div",{style:{verticalAlign:"middle",marginBottom:10},children:"(".concat(Z.Z.t("general:empty"),")")})]}),null===this.props.account?null:(0,v.jsx)(Te,{disabled:i,tag:a,setTitle:n,buttonText:"".concat(t,"..."),title:t,user:this.state.user,organization:this.getUserOrganization()})]},a)}},{key:"renderUser",value:function(){var e,t,n=this;return(0,v.jsx)(h.Z,{size:"small",title:null===this.props.account?Z.Z.t("user:User Profile"):(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("user:New User"):this.isSelf()?Z.Z.t("account:My Account"):Z.Z.t("user:Edit User"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return n.submitUserEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return n.submitUserEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return n.deleteUser()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:(0,v.jsx)(oe.Z,{children:null===(e=this.getUserOrganization())||void 0===e||null===(t=e.accountItems)||void 0===t?void 0:t.map((function(e){if(!e.visible)return null;var t=r.$J(n.props.account);if("Self"===e.viewRule){if(!n.isSelfOrAdmin())return null}else if("Admin"===e.viewRule&&!t)return null;return(0,v.jsx)(y.Fragment,{children:(0,v.jsx)(oe.Z.Item,{name:e.name,validateTrigger:"onChange",rules:[{pattern:e.regex?new RegExp(e.regex,"g"):null,message:Z.Z.t("user:This field value doesn't match the pattern rule")}],style:{margin:0},children:n.renderAccountItem(e)})},e.name)}))})})}},{key:"getIdCardType",value:function(e){return"ID card front"===e?Z.Z.t("user:ID card front"):"ID card back"===e?Z.Z.t("user:ID card back"):"ID card with person"===e?Z.Z.t("user:ID card with person"):"Unknown Id card name: "+e}},{key:"getIdCardText",value:function(e){return"ID card front"===e?Z.Z.t("user:Upload ID card front picture"):"ID card back"===e?Z.Z.t("user:Upload ID card back picture"):"ID card with person"===e?Z.Z.t("user:Upload ID card with person picture"):"Unknown Id card name: "+e}},{key:"submitUserEdit",value:function(e){var t=this,n=r.p$(this.state.user);ue.updateUser(this.state.organizationName,this.state.userName,n).then((function(n){if("ok"===n.status)if(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({organizationName:t.state.user.owner,userName:t.state.user.name}),void 0!==t.props.history)if(e){var a=sessionStorage.getItem("userListUrl");null!==a?t.props.history.push(a):r.$J(t.props.account)?t.props.history.push("/users"):t.props.history.push("/")}else"/account"!==location.pathname&&t.props.history.push("/users/".concat(t.state.user.owner,"/").concat(t.state.user.name));else e&&t.state.returnUrl&&(window.location.href=t.state.returnUrl);else r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateUserField("owner",t.state.organizationName),t.updateUserField("name",t.state.userName)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteUser",value:function(){var e=this;ue.deleteUser(this.state.user).then((function(t){if("ok"===t.status){var n=sessionStorage.getItem("userListUrl");null!==n?e.props.history.push(n):e.props.history.push("/users")}else r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[this.state.loading?(0,v.jsx)(H.Z,{size:"large",style:{marginLeft:"50%",marginTop:"10%"}}):null!==this.state.user?this.renderUser():(0,v.jsx)(c.ZP,{status:"404",title:"404 NOT FOUND",subTitle:Z.Z.t("general:Sorry, the user you visited does not exist or you are not authorized to access this user."),extra:(0,v.jsx)("a",{href:"/",children:(0,v.jsx)(d.ZP,{type:"primary",children:Z.Z.t("general:Back Home")})})}),null===this.state.user||null===this.props.account?null:(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitUserEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitUserEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteUser()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),gt=(0,f.EN)(ht),mt=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){return(0,G.Z)(this,n),t.apply(this,arguments)}return(0,J.Z)(n,[{key:"render",value:function(){return(0,v.jsx)(gt,{organizationName:this.props.account.owner,userName:this.props.account.name,account:this.props.account,location:this.props.location})}}]),n}(y.Component),xt=mt,Zt=n(40765),yt=n(25566),ft=n.n(yt),vt=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i,s;return(0,G.Z)(this,n),(s=t.call(this,e)).handleOrganizationChange=function(){var e;s.setState({organizationName:(null===(e=s.props.match)||void 0===e?void 0:e.params.organizationName)||r.jb(s.props.account)});var t=s.state.pagination;s.fetch({pagination:t})},s.handleTourChange=function(){s.setState({isTourVisible:M.x5()})},s.getColumnSearchProps=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{filterDropdown:function(t){var n=t.setSelectedKeys,a=t.selectedKeys,i=t.confirm,r=t.clearFilters;return(0,v.jsxs)("div",{style:{padding:8},children:[(0,v.jsx)(ae.Z,{ref:function(e){s.searchInput=e},placeholder:"Search ".concat(e),value:a[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return s.handleSearch(a,i,e)},style:{marginBottom:8,display:"block"}}),(0,v.jsxs)(m.Z,{children:[(0,v.jsx)(d.ZP,{type:"primary",onClick:function(){return s.handleSearch(a,i,e)},icon:(0,v.jsx)(Zt.Z,{}),size:"small",style:{width:90},children:"Search"}),(0,v.jsx)(d.ZP,{onClick:function(){return s.handleReset(r)},size:"small",style:{width:90},children:"Reset"}),(0,v.jsx)(d.ZP,{type:"link",size:"small",onClick:function(){i({closeDropdown:!1}),s.setState({searchText:a[0],searchedColumn:e})},children:"Filter"})]})]})},filterIcon:function(e){return(0,v.jsx)(Zt.Z,{style:{color:e?"#1890ff":void 0}})},onFilter:function(t,n){return n[e]?n[e].toString().toLowerCase().includes(t.toLowerCase()):""},filterDropdownProps:{onOpenChange:function(e){e&&setTimeout((function(){return s.searchInput.select()}),100)}},render:function(n,a,i){var r=s.state.searchedColumn===e?(0,v.jsx)(ft(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[s.state.searchText],autoEscape:!0,textToHighlight:n?n.toString():""}):n;return t?t({text:n,record:a,index:i},r):r}}},s.handleSearch=function(e,t,n){s.fetch({searchText:e[0],searchedColumn:n,pagination:s.state.pagination})},s.handleReset=function(e){e();var t=s.state.pagination;s.fetch({pagination:t})},s.handleTableChange=function(e,t,n){s.fetch((0,a.Z)((0,a.Z)({sortField:n.field,sortOrder:n.order,pagination:e},t),{},{searchText:s.state.searchText,searchedColumn:s.state.searchedColumn}))},s.setIsTourVisible=function(){M.o4(!1),s.setState({isTourVisible:!1})},s.getSteps=function(){var e=M.ny(),t=M.It();return t.map((function(n,a){n.target=a?function(){return document.getElementById(n.id)||null}:function(){return document.querySelector(".ant-table")},a===t.length-1&&(n.nextButtonProps={children:M.ts(e)})})),t},s.handleTourComplete=function(){var e=M.ny();""!==e&&(s.props.history.push("/"+e),M.o4(!0))},s.state={classes:e,organizationName:(null===(i=s.props.match)||void 0===i?void 0:i.params.organizationName)||r.jb(s.props.account),data:[],pagination:{current:1,pageSize:10},loading:!1,searchText:"",searchedColumn:"",isAuthorized:!0,isTourVisible:M.x5()},s}return(0,J.Z)(n,[{key:"componentDidMount",value:function(){window.addEventListener("storageOrganizationChanged",this.handleOrganizationChange),window.addEventListener("storageTourChanged",this.handleTourChange),r.VN(this.props.account)||r.nD("All")}},{key:"componentWillUnmount",value:function(){null!==this.state.intervalId&&clearInterval(this.state.intervalId),window.removeEventListener("storageTourChanged",this.handleTourChange),window.removeEventListener("storageOrganizationChanged",this.handleOrganizationChange)}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.state.pagination;this.fetch({pagination:e})}},{key:"render",value:function(){return this.state.isAuthorized?(0,v.jsxs)("div",{children:[this.renderTable(this.state.data),(0,v.jsx)(V.Z,{open:!r.tq()&&this.state.isTourVisible,onClose:this.setIsTourVisible,steps:this.getSteps(),indicatorsRender:function(e,t){return(0,v.jsxs)("span",{children:[e+1," / ",t]})},onFinish:this.handleTourComplete})]}):(0,v.jsx)(c.ZP,{status:"403",title:"403 Unauthorized",subTitle:Z.Z.t("general:Sorry, you do not have permission to access this page or logged in status invalid."),extra:(0,v.jsx)("a",{href:"/",children:(0,v.jsx)(d.ZP,{type:"primary",children:Z.Z.t("general:Back Home")})})})}}]),n}(y.Component),jt=vt,Tt=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.passwordType&&null!==t.passwordType&&(n="passwordType",i=t.passwordType),e.setState({loading:!0}),he.jX("admin",r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newOrganization",value:function(){var e=r.VO();return{owner:"admin",name:"organization_".concat(e),createdTime:Fe()().format(),displayName:"New Organization - ".concat(e),websiteUrl:"https://door.casdoor.com",favicon:"".concat(r.WD,"/img/favicon.png"),passwordType:"plain",PasswordSalt:"",passwordOptions:["AtLeast6"],passwordObfuscatorType:"Plain",passwordObfuscatorKey:"",passwordExpireDays:0,countryCodes:["US"],defaultAvatar:"".concat(r.WD,"/img/casbin.svg"),defaultApplication:"",tags:[],languages:r.nh.map((function(e){return e.key})),masterPassword:"",defaultPassword:"",enableSoftDeletion:!1,isProfilePublic:!0,enableTour:!0,accountItems:[{name:"Organization",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"ID",visible:!0,viewRule:"Public",modifyRule:"Immutable"},{name:"Name",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Display name",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Avatar",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"User type",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Password",visible:!0,viewRule:"Self",modifyRule:"Self"},{name:"Email",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Phone",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Country code",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Country/Region",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Location",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Address",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Affiliation",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Title",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"ID card type",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"ID card",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"ID card info",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Homepage",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Bio",visible:!0,viewRule:"Public",modifyRule:"Self"},{name:"Tag",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Language",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Gender",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Birthday",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Education",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Score",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Karma",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Ranking",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Signup application",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"API key",label:Z.Z.t("general:API key"),modifyRule:"Self"},{name:"Groups",visible:!0,viewRule:"Public",modifyRule:"Admin"},{name:"Roles",visible:!0,viewRule:"Public",modifyRule:"Immutable"},{name:"Permissions",visible:!0,viewRule:"Public",modifyRule:"Immutable"},{name:"3rd-party logins",visible:!0,viewRule:"Self",modifyRule:"Self"},{name:"Properties",visible:!1,viewRule:"Admin",modifyRule:"Admin"},{name:"Is online",visible:!0,viewRule:"Admin",modifyRule:"Admin"},{name:"Is admin",visible:!0,viewRule:"Admin",modifyRule:"Admin"},{name:"Is forbidden",visible:!0,viewRule:"Admin",modifyRule:"Admin"},{name:"Is deleted",visible:!0,viewRule:"Admin",modifyRule:"Admin"},{Name:"Multi-factor authentication",Visible:!0,ViewRule:"Self",ModifyRule:"Self"},{Name:"WebAuthn credentials",Visible:!0,ViewRule:"Self",ModifyRule:"Self"},{Name:"Managed accounts",Visible:!0,ViewRule:"Self",ModifyRule:"Self"},{Name:"MFA accounts",Visible:!0,ViewRule:"Self",ModifyRule:"Self"}]}}},{key:"addOrganization",value:function(){var e=this,t=this.newOrganization();he.Fi(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/organizations/".concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added")),window.dispatchEvent(new Event("storageOrganizationsChanged"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteOrganization",value:function(e){var t=this;he.Mz(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})}),window.dispatchEvent(new Event("storageOrganizationsChanged"))):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"120px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("general:Favicon"),dataIndex:"favicon",key:"favicon",width:"50px",render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:(0,v.jsx)("img",{src:e,alt:e,width:40})})}},(0,a.Z)((0,a.Z)({title:Z.Z.t("organization:Website URL"),dataIndex:"websiteUrl",key:"websiteUrl",width:"200px",sorter:!0},this.getColumnSearchProps("websiteUrl")),{},{render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:e})}}),{title:Z.Z.t("general:Password type"),dataIndex:"passwordType",key:"passwordType",width:"150px",sorter:!0,filterMultiple:!1,filters:[{text:"plain",value:"plain"},{text:"salt",value:"salt"},{text:"md5-salt",value:"md5-salt"}]},(0,a.Z)({title:Z.Z.t("general:Password salt"),dataIndex:"passwordSalt",key:"passwordSalt",width:"150px",sorter:!0},this.getColumnSearchProps("passwordSalt")),{title:Z.Z.t("general:Default avatar"),dataIndex:"defaultAvatar",key:"defaultAvatar",width:"120px",render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:(0,v.jsx)("img",{src:e,alt:e,width:40})})}},{title:Z.Z.t("organization:Soft deletion"),dataIndex:"enableSoftDeletion",key:"enableSoftDeletion",width:"140px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"350px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/trees/".concat(n.name))},children:Z.Z.t("general:Groups")}),(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/organizations/".concat(n.name,"/users"))},children:Z.Z.t("general:Users")}),(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},onClick:function(){return t.props.history.push("/organizations/".concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteOrganization(a)},disabled:"built-in"===n.name})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:"name",size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Organizations"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",disabled:!r.VN(t.props.account),onClick:t.addOrganization.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),kt=Tt,Ct=n(45987),bt=n(65847);function St(e,t){return fetch("".concat(r.nn,"/api/get-ldap?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var wt,Pt,At=n(93018),It=n(15274),Ft=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"newLdap",value:function(){return{id:"",owner:this.props.organizationName,createdTime:"",serverName:"Example LDAP Server",host:"example.com",port:389,username:"cn=admin,dc=example,dc=com",password:"123",baseDn:"ou=People,dc=example,dc=com",autosync:0,lastSync:""}}},{key:"addRow",value:function(e){var t,n=this,a=this.newLdap();(t=a,fetch("".concat(r.nn,"/api/add-ldap"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(t){"ok"===t.status?(r.PV("success",Z.Z.t("general:Successfully added")),void 0===e&&(e=[]),e=r.SA(e,t.data2),n.updateTable(e)):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(t.msg))})).catch((function(e){r.PV("error","Add LDAP server failed: ".concat(e))}))}},{key:"deleteRow",value:function(e,t){var n,a=this;(n=e[t],fetch("".concat(r.nn,"/api/delete-ldap"),{method:"POST",credentials:"include",body:JSON.stringify(n),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),e=r.qK(e,t),a.updateTable(e)):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(n.msg))})).catch((function(e){r.PV("error","Delete LDAP server failed: ".concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("ldap:Server name"),dataIndex:"serverName",key:"serverName",width:"160px",sorter:function(e,t){return e.serverName.localeCompare(t.serverName)},render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/ldaps/".concat(t.id),children:e})}},{title:Z.Z.t("ldap:Server"),dataIndex:"host",key:"host",ellipsis:!0,sorter:function(e,t){return e.host.localeCompare(t.host)},render:function(e,t,n){return"".concat(e,":").concat(t.port)}},{title:Z.Z.t("ldap:Base DN"),dataIndex:"baseDn",key:"baseDn",ellipsis:!0,sorter:function(e,t){return e.baseDn.localeCompare(t.baseDn)}},{title:Z.Z.t("ldap:Auto Sync"),dataIndex:"autoSync",key:"autoSync",width:"120px",sorter:function(e,t){return e.autoSync.localeCompare(t.autoSync)},render:function(e,t,n){return 0===e?(0,v.jsx)("span",{style:{color:"#faad14"},children:"Disable"}):(0,v.jsx)("span",{style:{color:"#52c41a"},children:e+" mins"})}},{title:Z.Z.t("ldap:Last Sync"),dataIndex:"lastSync",key:"lastSync",ellipsis:!0,sorter:function(e,t){return e.lastSync.localeCompare(t.lastSync)},render:function(e,t,n){return e}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"240px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return r.iF("/ldap/sync/".concat(a.owner,"/").concat(a.id))},children:Z.Z.t("general:Sync")}),(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},onClick:function(){return r.iF("/ldap/".concat(a.owner,"/").concat(a.id))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(a.serverName," ?"),onConfirm:function(){return t.deleteRow(e,i)}})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"id",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),zt=ne.Z.Option,Nt=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).getItems=function(){return[{name:"Organization",label:Z.Z.t("general:Organization")},{name:"ID",label:Z.Z.t("general:ID")},{name:"Name",label:Z.Z.t("general:Name")},{name:"Display name",label:Z.Z.t("general:Display name")},{name:"Avatar",label:Z.Z.t("general:Avatar")},{name:"User type",label:Z.Z.t("general:User type")},{name:"Password",label:Z.Z.t("general:Password")},{name:"Email",label:Z.Z.t("general:Email")},{name:"Phone",label:Z.Z.t("general:Phone")},{name:"Country code",label:Z.Z.t("user:Country code")},{name:"Country/Region",label:Z.Z.t("user:Country/Region")},{name:"Location",label:Z.Z.t("user:Location")},{name:"Address",label:Z.Z.t("user:Address")},{name:"Affiliation",label:Z.Z.t("user:Affiliation")},{name:"Title",label:Z.Z.t("user:Title")},{name:"ID card type",label:Z.Z.t("user:ID card type")},{name:"ID card",label:Z.Z.t("user:ID card")},{name:"ID card info",label:Z.Z.t("user:ID card info")},{name:"Homepage",label:Z.Z.t("user:Homepage")},{name:"Bio",label:Z.Z.t("user:Bio")},{name:"Tag",label:Z.Z.t("user:Tag")},{name:"Language",label:Z.Z.t("user:Language")},{name:"Gender",label:Z.Z.t("user:Gender")},{name:"Birthday",label:Z.Z.t("user:Birthday")},{name:"Education",label:Z.Z.t("user:Education")},{name:"Balance",label:Z.Z.t("user:Balance")},{name:"Score",label:Z.Z.t("user:Score")},{name:"Karma",label:Z.Z.t("user:Karma")},{name:"Ranking",label:Z.Z.t("user:Ranking")},{name:"Signup application",label:Z.Z.t("general:Signup application")},{name:"API key",label:Z.Z.t("general:API key")},{name:"Groups",label:Z.Z.t("general:Groups")},{name:"Roles",label:Z.Z.t("general:Roles")},{name:"Permissions",label:Z.Z.t("general:Permissions")},{name:"3rd-party logins",label:Z.Z.t("user:3rd-party logins")},{name:"Properties",label:Z.Z.t("user:Properties")},{name:"Is online",label:Z.Z.t("user:Is online")},{name:"Is admin",label:Z.Z.t("user:Is admin")},{name:"Is forbidden",label:Z.Z.t("user:Is forbidden")},{name:"Is deleted",label:Z.Z.t("user:Is deleted")},{name:"Need update password",label:Z.Z.t("user:Need update password")},{name:"IP whitelist",label:Z.Z.t("general:IP whitelist")},{name:"Multi-factor authentication",label:Z.Z.t("user:Multi-factor authentication")},{name:"WebAuthn credentials",label:Z.Z.t("user:WebAuthn credentials")},{name:"Managed accounts",label:Z.Z.t("user:Managed accounts")},{name:"Face ID",label:Z.Z.t("user:Face ID")},{name:"MFA accounts",label:Z.Z.t("user:MFA accounts")}]},a.state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:r.dj(e,"Please select an account item"),visible:!0,viewRule:"Public",modifyRule:"Self"};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",render:function(n,a,i){var s=t.getItems();return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},options:r.fJ(s,e,"name").map((function(e){return r.Rl(e.label,e.name)})),value:n,onChange:function(n){t.updateField(e,i,"name",n)}})}},{title:Z.Z.t("organization:Visible"),dataIndex:"visible",key:"visible",width:"120px",render:function(n,a,i){return(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"visible",n)}})}},{title:Z.Z.t("signup:Regex"),dataIndex:"regex",key:"regex",width:"200px",render:function(n,a,i){return["Display name","Password","Email","Phone","Location","Title","Homepage","Bio","Gender","Birthday","Education","ID card","ID card type"].includes(a.name)?(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"regex",n.target.value)}}):null}},{title:Z.Z.t("organization:View rule"),dataIndex:"viewRule",key:"viewRule",width:"155px",render:function(n,a,i){if(!a.visible)return null;return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"viewRule",n)},children:[{id:"Public",name:"Public"},{id:"Self",name:"Self"},{id:"Admin",name:"Admin"}].map((function(e,t){return(0,v.jsx)(zt,{value:e.id,children:e.name},t)}))})}},{title:Z.Z.t("organization:Modify rule"),dataIndex:"modifyRule",key:"modifyRule",width:"155px",render:function(n,a,i){return a.visible?(r="Admin"===a.viewRule||"Is admin"===a.name?[{id:"Admin",name:"Admin"},{id:"Immutable",name:"Immutable"}]:[{id:"Self",name:"Self"},{id:"Admin",name:"Admin"},{id:"Immutable",name:"Immutable"}],(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"modifyRule",n)},children:r.map((function(e,t){return(0,v.jsx)(zt,{value:e.id,children:e.name},t)}))})):null;var r}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"name",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),Ut=n(11868),Et=n(17715),Rt=n(15508),Lt=n(30168),Ot=n(30686),Vt=n(90825),qt=Ut.Z.useToken,Dt={default:"".concat(r.WD,"/img/theme_default.svg"),dark:"".concat(r.WD,"/img/theme_dark.svg"),lark:"".concat(r.WD,"/img/theme_lark.svg"),comic:"".concat(r.WD,"/img/theme_comic.svg")},Mt={default:"Default",dark:"Dark",lark:"Document",comic:"Blossom"},Bt=function(){var e=qt().token;return{themeCard:(0,Ot.iv)(wt||(wt=(0,Lt.Z)(["\n      border-radius: ","px;\n      cursor: pointer;\n      transition: all ",';\n      overflow: hidden;\n      display: inline-block;\n\n      & > input[type="radio"] {\n        width: 0;\n        height: 0;\n        opacity: 0;\n      }\n\n      img {\n        vertical-align: top;\n        box-shadow: 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08),\n          0 9px 28px 8px rgba(0, 0, 0, 0.05);\n      }\n\n      &:focus-within,\n      &:hover {\n        transform: scale(1.04);\n      }\n    '])),e.borderRadius,e.motionDurationSlow),themeCardActive:(0,Ot.iv)(Pt||(Pt=(0,Lt.Z)(["\n      box-shadow: 0 0 0 1px ",",\n        0 0 0 ","px ",";\n        \n      &:hover:not(:focus-within) {\n        transform: scale(1);\n      }\n    "])),e.colorBgContainer,2*e.controlOutlineWidth+1,e.colorPrimary)}};function Wt(e){var t=e.value,n=e.onChange,a=qt().token,i=Bt();return(0,Vt.tZ)(m.Z,{size:a.paddingLG,children:Object.keys(Dt).map((function(e){var a=Dt[e];return(0,Vt.BX)(m.Z,{direction:"vertical",align:"center",children:[(0,Vt.BX)("label",{css:[i.themeCard,t===e&&i.themeCardActive],onClick:function(){null===n||void 0===n||n(e)},children:[(0,Vt.tZ)("input",{type:"radio",name:"theme"}),(0,Vt.tZ)("img",{src:a,alt:e})]}),(0,Vt.tZ)("span",{children:Z.Z.t("theme:".concat(Mt[e]))})]},e)}))})}var Ht,Gt,Jt=n(40090),Qt=n(65305),Kt="#ED4192",_t="#00B96B",$t=[{color:"#1677FF"},{color:"#5734d3"},{color:"#9E339F"},{color:Kt},{color:"#E0282E"},{color:"#F4801A"},{color:"#F2BD27"},{color:_t}].map((function(e){return e.color})),Yt=Ut.Z.useToken,Xt=function(){var e=Yt().token;return{color:(0,Ot.iv)(Ht||(Ht=(0,Lt.Z)(["\n      width: ","px;\n      height: ","px;\n      border-radius: 100%;\n      cursor: pointer;\n      transition: all ",';\n      display: inline-block;\n\n      & > input[type="radio"] {\n        width: 0;\n        height: 0;\n        opacity: 0;\n      }\n    '])),e.controlHeightLG/2,e.controlHeightLG/2,e.motionDurationFast),colorActive:(0,Ot.iv)(Gt||(Gt=(0,Lt.Z)(["\n      box-shadow: 0 0 0 1px ",",\n        0 0 0 ","px ",";\n    "])),e.colorBgContainer,2*e.controlOutlineWidth+1,e.colorPrimary)}},en=function(e){var t=e.color,n=e.onChange,a=(0,y.useState)(t),r=(0,i.Z)(a,2),s=r[0],o=r[1];return(0,y.useEffect)((function(){var e=setTimeout((function(){null===n||void 0===n||n(s)}),200);return function(){return clearTimeout(e)}}),[s]),(0,y.useEffect)((function(){o(t)}),[t]),(0,Vt.tZ)(Qt.Z,{color:s,onChange:o})};function tn(e){var t=e.value,n=e.onChange,a=Xt(),i=(0,y.useMemo)((function(){var e=new Jt.C(t).toRgbString(),n=!1,a=$t.map((function(t){var a=new Jt.C(t).toRgbString()===e;return n=n||a,{color:t,active:a,picker:!1}}));return[].concat((0,Ve.Z)(a),[{color:"conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",picker:!0,active:!n}])}),[t]);return(0,Vt.BX)(m.Z,{size:"large",children:[(0,Vt.tZ)(ae.Z,{value:t,onChange:function(e){null===n||void 0===n||n(e.target.value)},style:{width:120}}),(0,Vt.tZ)(m.Z,{size:"middle",children:i.map((function(e){var i=e.color,r=e.active,s=e.picker,o=(0,Vt.tZ)("label",{css:[a.color,r&&a.colorActive],style:{background:i},onClick:function(){s||null===n||void 0===n||n(i)},children:(0,Vt.tZ)("input",{type:"radio",name:s?"picker":"color",tabIndex:s?-1:0})},i);return s&&(o=(0,Vt.tZ)(at.Z,{overlayInnerStyle:{padding:0},content:(0,Vt.tZ)(en,{color:t||"",onChange:function(e){return null===n||void 0===n?void 0:n(e)}}),trigger:"click",showArrow:!1,children:o},i)),o}))})]})}var nn=n(97151);function an(e){var t=e.value,n=e.onChange;return(0,v.jsxs)(m.Z,{size:"large",children:[(0,v.jsx)(ie.Z,{value:t,onChange:n,style:{width:120},min:0,formatter:function(e){return"".concat(e,"px")},parser:function(e){return e?parseFloat(e):e}}),(0,v.jsx)(nn.Z,{tooltip:{open:!1},style:{width:128},min:0,value:t,max:20,onChange:n})]})}var rn=n(30284),sn=["isCompact","themeType"],on={default:{},dark:{borderRadius:2},lark:{colorPrimary:_t,borderRadius:4},comic:{colorPrimary:Kt,borderRadius:16}},ln=function(){};function cn(e){var t,n,r=null!==(t=e.themeData)&&void 0!==t?t:At.Cm,s=null!==(n=e.onThemeChange)&&void 0!==n?n:ln,o=r.isCompact,l=r.themeType,c=(0,Ct.Z)(r,sn),d="dark"!==l,p=oe.Z.useForm(),u=(0,i.Z)(p,1)[0],g=y.useMemo((function(){var e=[d?Ut.Z.defaultAlgorithm:Ut.Z.darkAlgorithm];return!0===o&&e.push(Ut.Z.compactAlgorithm),e}),[d,o]);return(0,y.useEffect)((function(){s(null,r),u.setFieldsValue(r)}),[]),(0,y.useLayoutEffect)((function(){var e=Object.assign(Object.assign(Object.assign({},At.Cm),{themeType:l}),on[l]);s(null,e),u.setFieldsValue(e)}),[l]),(0,v.jsx)(Et.ZP,{theme:{token:(0,a.Z)({},c),hashed:!0,algorithm:g},children:(0,v.jsx)(Rt.Z,{style:{width:"800px",backgroundColor:"white"},children:(0,v.jsx)(rn.VY,{children:(0,v.jsx)(h.Z,{title:Z.Z.t("theme:Theme"),children:(0,v.jsxs)(oe.Z,{form:u,initialValues:r,onValuesChange:s,labelCol:{span:4},wrapperCol:{span:20},style:{width:"800px"},children:[(0,v.jsx)(oe.Z.Item,{label:Z.Z.t("theme:Theme"),name:"themeType",children:(0,v.jsx)(Wt,{})}),(0,v.jsx)(oe.Z.Item,{label:Z.Z.t("theme:Primary color"),name:"colorPrimary",children:(0,v.jsx)(tn,{})}),(0,v.jsx)(oe.Z.Item,{label:Z.Z.t("theme:Border radius"),name:"borderRadius",children:(0,v.jsx)(an,{})}),(0,v.jsx)(oe.Z.Item,{label:Z.Z.t("theme:Is compact"),valuePropName:"checked",name:"isCompact",children:(0,v.jsx)(re.Z,{})})]})})})})})}var dn=ne.Z.Option,pn=[{name:"Phone",value:le.bX},{name:"Email",value:le.rW},{name:"App",value:le.XH}],un=[{value:r.XE,label:Z.Z.t("organization:Optional")},{value:r.CE,label:Z.Z.t("organization:Prompt")},{value:r.BZ,label:Z.Z.t("organization:Required")}],hn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:r.dj(e,"Please select a MFA method"),rule:"Optional"};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",render:function(n,a,i){return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"name",n)},children:r.fJ(pn,e,"name").map((function(e,t){return(0,v.jsx)(dn,{value:e.value,children:e.name},t)}))})}},{title:Z.Z.t("application:Rule"),dataIndex:"rule",key:"rule",width:"100px",render:function(n,a,i){return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,defaultValue:"Optional",options:un.map((function(e){return r.Rl(e.label,e.value)})),onChange:function(n){var a=0;e.forEach((function(e){e.rule===r.BZ&&a++})),n===r.BZ&&a>=1?r.PV("error","Only 1 MFA methods can be required"):t.updateField(e,i,"rule",n)}})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"name",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{disabled:e.length>=pn.length,style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),gn=n(28539),mn=function(e){var t=e.disable,n=e.checkedKeys,a=e.defaultExpandedKeys,i=e.onCheck,r=[{title:Z.Z.t("organization:All"),key:"all",children:[{title:Z.Z.t("general:Home"),key:"/home-top",children:[{title:Z.Z.t("general:Dashboard"),key:"/"},{title:Z.Z.t("general:Shortcuts"),key:"/shortcuts"},{title:Z.Z.t("general:Apps"),key:"/apps"}]},{title:Z.Z.t("general:User Management"),key:"/orgs-top",children:[{title:Z.Z.t("general:Organizations"),key:"/organizations"},{title:Z.Z.t("general:Groups"),key:"/groups"},{title:Z.Z.t("general:Users"),key:"/users"},{title:Z.Z.t("general:Invitations"),key:"/invitations"}]},{title:Z.Z.t("general:Identity"),key:"/applications-top",children:[{title:Z.Z.t("general:Applications"),key:"/applications"},{title:Z.Z.t("general:Providers"),key:"/providers"},{title:Z.Z.t("general:Resources"),key:"/resources"},{title:Z.Z.t("general:Certs"),key:"/certs"}]},{title:Z.Z.t("general:Authorization"),key:"/roles-top",children:[{title:Z.Z.t("general:Applications"),key:"/roles"},{title:Z.Z.t("general:Permissions"),key:"/permissions"},{title:Z.Z.t("general:Models"),key:"/models"},{title:Z.Z.t("general:Adapters"),key:"/adapters"},{title:Z.Z.t("general:Enforcers"),key:"/enforcers"}]},{title:Z.Z.t("general:Logging & Auditing"),key:"/sessions-top",children:[{title:Z.Z.t("general:Sessions"),key:"/sessions"},{title:Z.Z.t("general:Records"),key:"/records"},{title:Z.Z.t("general:Tokens"),key:"/tokens"},{title:Z.Z.t("general:Verifications"),key:"/verifications"}]},{title:Z.Z.t("general:Business & Payments"),key:"/business-top",children:[{title:Z.Z.t("general:Products"),key:"/products"},{title:Z.Z.t("general:Payments"),key:"/payments"},{title:Z.Z.t("general:Plans"),key:"/plans"},{title:Z.Z.t("general:Pricings"),key:"/pricings"},{title:Z.Z.t("general:Subscriptions"),key:"/subscriptions"},{title:Z.Z.t("general:Transactions"),key:"/transactions"}]},{title:Z.Z.t("general:Admin"),key:"/admin-top",children:[{title:Z.Z.t("general:System Info"),key:"/sysinfo"},{title:Z.Z.t("general:Syncers"),key:"/syncers"},{title:Z.Z.t("general:Webhooks"),key:"/webhooks"},{title:Z.Z.t("general:Swagger"),key:"/swagger"}]}]}];return(0,v.jsx)(gn.Z,{disabled:t,checkable:!0,checkedKeys:n,defaultExpandedKeys:a,onCheck:i,treeData:r})},xn=["_"],Zn=ne.Z.Option,yn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:e.match.params.organizationName,organization:null,applications:[],ldaps:null,mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getOrganization(),this.getApplications(),this.getLdaps()}},{key:"getOrganization",value:function(){var e=this;he.Xu("admin",this.state.organizationName).then((function(t){if("ok"===t.status){var n=t.data;if(null===n)return void e.props.history.push("/404");n.enableDarkLogo=!!n.logoDark,e.setState({organization:n})}else r.PV("error",t.msg)}))}},{key:"getApplications",value:function(){var e=this;W.rW("admin",this.state.organizationName).then((function(t){"error"!==t.status?e.setState({applications:t.data||[]}):r.PV("error",t.msg)}))}},{key:"getLdaps",value:function(){var e,t=this;(e=this.state.organizationName,fetch("".concat(r.nn,"/api/get-ldaps?owner=").concat(e),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){var n=[];"ok"===e.status&&null!==e.data&&(n=e.data),t.setState({ldaps:n})}))}},{key:"parseOrganizationField",value:function(e,t){return t}},{key:"updateOrganizationField",value:function(e,t){t=this.parseOrganizationField(e,t);var n=this.state.organization;n[e]=t,this.setState({organization:n})}},{key:"updatePasswordObfuscator",value:function(e,t){var n=this.state.organization;""===n.passwordObfuscatorType&&(n.passwordObfuscatorType="Plain"),"type"===e?(n.passwordObfuscatorType=t,n.passwordObfuscatorKey=It.u6(t)):"key"===e&&(n.passwordObfuscatorKey=t),this.setState({organization:n})}},{key:"renderOrganization",value:function(){var e,t,n,i,s,o,l,c,p,u,g=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("organization:New Organization"):Z.Z.t("organization:Edit Organization"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return g.submitOrganizationEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return g.submitOrganizationEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return g.deleteOrganization()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.name,disabled:"built-in"===this.state.organization.name,onChange:function(e){g.updateOrganizationField("name",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.displayName,onChange:function(e){g.updateOrganizationField("displayName",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Enable dark logo"),Z.Z.t("general:Enable dark logo - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(re.Z,{checked:this.state.organization.enableDarkLogo,onChange:function(e){g.updateOrganizationField("enableDarkLogo",e),e||g.updateOrganizationField("logoDark","")}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Logo"),Z.Z.t("general:Logo - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.organization.logo,onChange:function(e){g.updateOrganizationField("logo",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.organization.logo,children:(0,v.jsx)("img",{src:this.state.organization.logo?this.state.organization.logo:r.R7([""]),alt:this.state.organization.logo,height:90,style:{background:"white",marginBottom:"20px"}})})})]})]})]}),this.state.organization.enableDarkLogo?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Logo dark"),Z.Z.t("general:Logo dark - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.organization.logoDark,onChange:function(e){g.updateOrganizationField("logoDark",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.organization.logoDark,children:(0,v.jsx)("img",{src:this.state.organization.logoDark?this.state.organization.logoDark:r.R7(["dark"]),alt:this.state.organization.logoDark,height:90,style:{background:"#141414",marginBottom:"20px"}})})})]})]})]}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Favicon"),Z.Z.t("general:Favicon - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.organization.favicon,onChange:function(e){g.updateOrganizationField("favicon",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.organization.favicon,children:(0,v.jsx)("img",{src:this.state.organization.favicon,alt:this.state.organization.favicon,height:90,style:{marginBottom:"20px"}})})})]})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("organization:Website URL"),Z.Z.t("organization:Website URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.organization.websiteUrl,onChange:function(e){g.updateOrganizationField("websiteUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password type"),Z.Z.t("general:Password type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.organization.passwordType,onChange:function(e){g.updateOrganizationField("passwordType",e)},options:["plain","salt","sha512-salt","md5-salt","bcrypt","pbkdf2-salt","argon2id"].map((function(e){return r.Rl(e,e)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password salt"),Z.Z.t("general:Password salt - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.passwordSalt,onChange:function(e){g.updateOrganizationField("passwordSalt",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password complexity options"),Z.Z.t("general:Password complexity options - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},mode:"multiple",value:this.state.organization.passwordOptions,onChange:function(e){g.updateOrganizationField("passwordOptions",e)},options:[{value:"AtLeast6",name:Z.Z.t("user:The password must have at least 6 characters")},{value:"AtLeast8",name:Z.Z.t("user:The password must have at least 8 characters")},{value:"Aa123",name:Z.Z.t("user:The password must contain at least one uppercase letter, one lowercase letter and one digit")},{value:"SpecialChar",name:Z.Z.t("user:The password must contain at least one special character")},{value:"NoRepeat",name:Z.Z.t("user:The password must not contain any repeated characters")}].map((function(e){return r.Rl(e.name,e.value)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password obfuscator"),Z.Z.t("general:Password obfuscator - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.organization.passwordObfuscatorType,onChange:function(e){g.updatePasswordObfuscator("type",e)},children:[{id:"Plain",name:"Plain"},{id:"AES",name:"AES"},{id:"DES",name:"DES"}].map((function(e,t){return(0,v.jsx)(Zn,{value:e.id,children:e.name},t)}))})})]}),"Plain"===this.state.organization.passwordObfuscatorType||""===this.state.organization.passwordObfuscatorType?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password obf key"),Z.Z.t("general:Password obf key - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.passwordObfuscatorKey,onChange:function(e){g.updatePasswordObfuscator("key",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("organization:Password expire days"),Z.Z.t("organization:Password expire days - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:4,children:(0,v.jsx)(ie.Z,{value:this.state.organization.passwordExpireDays,onChange:function(e){g.updateOrganizationField("passwordExpireDays",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Supported country codes"),Z.Z.t("general:Supported country codes - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsxs)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:null!==(e=this.state.organization.countryCodes)&&void 0!==e?e:[],onChange:function(e){g.updateOrganizationField("countryCodes",e)},filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.text)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},children:[r.bP({name:Z.Z.t("organization:All"),code:"All",phone:0}),r.KZ().map((function(e){return r.bP(e)}))]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Languages"),Z.Z.t("general:Languages - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},options:r.nh.map((function(e){return r.Rl(e.label,e.key)})),value:null!==(t=this.state.organization.languages)&&void 0!==t?t:[],onChange:function(e){g.updateOrganizationField("languages",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Default avatar"),Z.Z.t("general:Default avatar - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.organization.defaultAvatar,onChange:function(e){g.updateOrganizationField("defaultAvatar",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.organization.defaultAvatar,children:(0,v.jsx)("img",{src:this.state.organization.defaultAvatar,alt:this.state.organization.defaultAvatar,height:90,style:{marginBottom:"20px"}})})})]})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Default application"),Z.Z.t("general:Default application - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.organization.defaultApplication,onChange:function(e){g.updateOrganizationField("defaultApplication",e)},options:null===(n=this.state.applications)||void 0===n?void 0:n.map((function(e){return r.Rl(r.Zh(e.name),e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("organization:User types"),Z.Z.t("organization:User types - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",style:{width:"100%"},value:this.state.organization.userTypes,onChange:function(e){g.updateOrganizationField("userTypes",e)},children:null===(i=this.state.organization.userTypes)||void 0===i?void 0:i.map((function(e,t){return(0,v.jsx)(Zn,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("organization:Tags"),Z.Z.t("organization:Tags - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",style:{width:"100%"},value:this.state.organization.tags,onChange:function(e){g.updateOrganizationField("tags",e)},children:null===(s=this.state.organization.tags)||void 0===s?void 0:s.map((function(e,t){return(0,v.jsx)(Zn,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Master password"),Z.Z.t("general:Master password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.masterPassword,onChange:function(e){g.updateOrganizationField("masterPassword",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Default password"),Z.Z.t("general:Default password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.defaultPassword,onChange:function(e){g.updateOrganizationField("defaultPassword",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Master verification code"),Z.Z.t("general:Master verification code - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.masterVerificationCode,onChange:function(e){g.updateOrganizationField("masterVerificationCode",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:IP whitelist"),Z.Z.t("general:IP whitelist - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.organization.ipWhitelist,onChange:function(e){g.updateOrganizationField("ipWhitelist",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("organization:Init score"),Z.Z.t("organization:Init score - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:4,children:(0,v.jsx)(ie.Z,{value:this.state.organization.initScore,onChange:function(e){g.updateOrganizationField("initScore",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("organization:Soft deletion"),Z.Z.t("organization:Soft deletion - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.organization.enableSoftDeletion,onChange:function(e){g.updateOrganizationField("enableSoftDeletion",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("organization:Is profile public"),Z.Z.t("organization:Is profile public - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.organization.isProfilePublic,onChange:function(e){g.updateOrganizationField("isProfilePublic",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("organization:Use Email as username"),Z.Z.t("organization:Use Email as username - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.organization.useEmailAsUsername,onChange:function(e){g.updateOrganizationField("useEmailAsUsername",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Enable tour"),Z.Z.t("general:Enable tour - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.organization.enableTour,onChange:function(e){g.updateOrganizationField("enableTour",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Navbar items"),Z.Z.t("general:Navbar items - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(mn,{disabled:!r.VN(this.props.account),checkedKeys:null!==(o=this.state.organization.navItems)&&void 0!==o?o:["all"],defaultExpandedKeys:["all"],onCheck:function(e,t){g.updateOrganizationField("navItems",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("organization:Account items"),Z.Z.t("organization:Account items - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Nt,{title:Z.Z.t("organization:Account items"),table:this.state.organization.accountItems,onUpdateTable:function(e){g.updateOrganizationField("accountItems",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:MFA items"),Z.Z.t("general:MFA items - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(hn,{title:Z.Z.t("general:MFA items"),table:null!==(l=this.state.organization.mfaItems)&&void 0!==l?l:[],onUpdateTable:function(e){g.updateOrganizationField("mfaItems",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("theme:Theme"),Z.Z.t("theme:Theme - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,style:{marginTop:"5px"},children:[(0,v.jsx)(R.Z,{children:(0,v.jsxs)(bt.ZP.Group,{buttonStyle:"solid",value:null!==(c=null===(p=this.state.organization.themeData)||void 0===p?void 0:p.isEnabled)&&void 0!==c&&c,onChange:function(e){var t,n=null!==(t=g.state.organization.themeData)&&void 0!==t?t:(0,a.Z)((0,a.Z)({},At.Cm),{},{isEnabled:!1}),i=(n._,(0,Ct.Z)(n,xn));g.updateOrganizationField("themeData",(0,a.Z)((0,a.Z)({},i),{},{isEnabled:e.target.value}))},children:[(0,v.jsx)(bt.ZP.Button,{value:!1,children:Z.Z.t("organization:Follow global theme")}),(0,v.jsx)(bt.ZP.Button,{value:!0,children:Z.Z.t("theme:Customize theme")})]})}),null!==(u=this.state.organization.themeData)&&void 0!==u&&u.isEnabled?(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(cn,{themeData:this.state.organization.themeData,onThemeChange:function(e,t){var n,i=(null!==(n=g.state.organization.themeData)&&void 0!==n?n:(0,a.Z)((0,a.Z)({},At.Cm),{},{isEnabled:!1})).isEnabled;g.updateOrganizationField("themeData",(0,a.Z)((0,a.Z)({},t),{},{isEnabled:i}))}})}):null]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:LDAPs"),Z.Z.t("general:LDAPs - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Ft,{title:Z.Z.t("general:LDAPs"),table:this.state.ldaps,organizationName:this.state.organizationName,onUpdateTable:function(e){g.setState({ldaps:e})}})})]})]})}},{key:"submitOrganizationEdit",value:function(e){var t,n=this,a=r.p$(this.state.organization);a.accountItems=null===(t=a.accountItems)||void 0===t?void 0:t.filter((function(e){return"Please select an account item"!==e.name}));var i=It.Sb(a.passwordObfuscatorType,a.passwordObfuscatorKey);i.length>0?r.PV("error",i):he.FV(this.state.organization.owner,this.state.organizationName,a).then((function(t){"ok"===t.status?(r.PV("success",Z.Z.t("general:Successfully saved")),n.props.account.organization.name===n.state.organizationName&&n.props.onChangeTheme(r.ZJ(n.state.organization)),n.setState({organizationName:n.state.organization.name}),window.dispatchEvent(new Event("storageOrganizationsChanged")),e?n.props.history.push("/organizations"):n.props.history.push("/organizations/".concat(n.state.organization.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(t.msg)),n.updateOrganizationField("name",n.state.organizationName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteOrganization",value:function(){var e=this;he.Mz(this.state.organization).then((function(t){"ok"===t.status?(e.props.history.push("/organizations"),window.dispatchEvent(new Event("storageOrganizationsChanged"))):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.organization?this.renderOrganization():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitOrganizationEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitOrganizationEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteOrganization()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),fn=yn,vn=n(11752),jn=n(61120),Tn=n(31093),kn=n(22231),Cn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i;return(0,G.Z)(this,n),(i=t.call(this,e)).fetch=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,s=t.searchText,o=t.sortField,l=t.sortOrder;i.setState({loading:!0}),"/users"===(null===(e=i.props.match)||void 0===e?void 0:e.path)?(r.Qy(i.props.account)?ue.getGlobalUsers(t.pagination.current,t.pagination.pageSize,n,s,o,l):ue.getUsers(r.jb(i.props.account),t.pagination.current,t.pagination.pageSize,n,s,o,l)).then((function(e){i.setState({loading:!1}),"ok"===e.status?i.setState({data:e.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:e.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(e)?i.setState({isAuthorized:!1}):r.PV("error",e.msg)})):(i.props.groupName?ue.getUsers(i.state.organizationName,t.pagination.current,t.pagination.pageSize,n,s,o,l,i.props.groupName):ue.getUsers(i.state.organizationName,t.pagination.current,t.pagination.pageSize,n,s,o,l)).then((function(e){i.setState({loading:!1}),"ok"===e.status?i.setState({data:e.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:e.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(e)?i.setState({isAuthorized:!1}):r.PV("error",e.msg)}))},i.state=(0,a.Z)((0,a.Z)({},i.state),{},{organization:null}),i}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){(0,vn.Z)((0,jn.Z)(n.prototype),"UNSAFE_componentWillMount",this).call(this),this.getOrganization(this.state.organizationName)}},{key:"componentDidUpdate",value:function(e,t){var n,a;this.props.match.path===e.match.path&&this.props.organizationName===e.organizationName||this.setState({organizationName:null!==(n=this.props.organizationName)&&void 0!==n?n:null===(a=this.props.match)||void 0===a?void 0:a.params.organizationName});this.state.organizationName!==t.organizationName&&this.getOrganization(this.state.organizationName),e.groupName===this.props.groupName&&this.state.organizationName===t.organizationName||this.fetch({pagination:this.state.pagination,searchText:this.state.searchText,searchedColumn:this.state.searchedColumn})}},{key:"newUser",value:function(){var e,t,n=r.VO(),a=r.Qy(this.props.account)||this.props.groupName?this.state.organizationName:r.jb(this.props.account);return{owner:a,name:"user_".concat(n),createdTime:Fe()().format(),type:"normal-user",password:"123",passwordSalt:"",displayName:"New User - ".concat(n),avatar:null!==(e=this.state.organization.defaultAvatar)&&void 0!==e?e:"".concat(r.WD,"/img/casbin.svg"),email:"".concat(n,"@example.com"),phone:r.xT(),countryCode:(null===(t=this.state.organization.countryCodes)||void 0===t?void 0:t.length)>0?this.state.organization.countryCodes[0]:"",address:[],groups:this.props.groupName?["".concat(a,"/").concat(this.props.groupName)]:[],affiliation:"Example Inc.",tag:"staff",region:"",isAdmin:"built-in"===a,IsForbidden:!1,score:this.state.organization.initScore,isDeleted:!1,properties:{},signupApplication:this.state.organization.defaultApplication}}},{key:"addUser",value:function(){var e=this,t=this.newUser();ue.addUser(t).then((function(n){"ok"===n.status?(sessionStorage.setItem("userListUrl",window.location.pathname),e.props.history.push({pathname:"/users/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteUser",value:function(e){var t=this;ue.deleteUser(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"removeUserFromGroup",value:function(e){var t=this,n=this.state.data[e],a=this.props.groupName;ue.removeUserFromGroup({groupName:a,owner:n.owner,name:n.name}).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully removed")),t.setState({data:r.qK(t.state.data,e),pagination:{total:t.state.pagination.total-1}})):r.PV("error","".concat(Z.Z.t("general:Failed to remove"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"uploadFile",value:function(e){var t=e.file,n=t.status,a=t.response;if("done"===n)if("ok"===a.status){r.PV("success","Users uploaded successfully, refreshing the page");var i=this.state.pagination;this.fetch({pagination:i})}else r.PV("error","Users failed to upload: ".concat(a.msg));else"error"===n&&r.PV("error","File failed to upload")}},{key:"getOrganization",value:function(e){var t=this;he.Xu("admin",e).then((function(e){"ok"===e.status?t.setState({organization:e.data}):r.PV("error","Failed to get organization: ".concat(e.msg))}))}},{key:"renderUpload",value:function(){var e=this,t={name:"file",accept:".xlsx",method:"post",action:"".concat(r.nn,"/api/upload-users"),withCredentials:!0,onChange:function(t){e.uploadFile(t)}};return(0,v.jsx)(Tn.Z,(0,a.Z)((0,a.Z)({},t),{},{children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(kn.Z,{}),id:"upload-button",type:"primary",size:"small",children:Z.Z.t("user:Upload (.xlsx)")})}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:r.tq()?"100px":"120px",fixed:"left",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Application"),dataIndex:"signupApplication",key:"signupApplication",width:r.tq()?"100px":"120px",fixed:"left",sorter:!0},this.getColumnSearchProps("signupApplication")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:r.tq()?"80px":"110px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("general:Avatar"),dataIndex:"avatar",key:"avatar",width:"80px",render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:(0,v.jsx)(Xe.Z,{referrerPolicy:"no-referrer",src:e,alt:e,size:50})})}},(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Email"),dataIndex:"email",key:"email",width:"160px",sorter:!0},this.getColumnSearchProps("email")),{},{render:function(e,t,n){return(0,v.jsx)("a",{href:"mailto:".concat(e),children:e})}}),(0,a.Z)({title:Z.Z.t("general:Phone"),dataIndex:"phone",key:"phone",width:"120px",sorter:!0},this.getColumnSearchProps("phone")),(0,a.Z)({title:Z.Z.t("user:Affiliation"),dataIndex:"affiliation",key:"affiliation",width:"140px",sorter:!0},this.getColumnSearchProps("affiliation")),(0,a.Z)((0,a.Z)({title:Z.Z.t("user:Country/Region"),dataIndex:"region",key:"region",width:"140px",sorter:!0},this.getColumnSearchProps("region")),{},{render:function(e,t,n){return r.Hj().getName(t.region,r.G3(),{select:"official"})}}),(0,a.Z)({title:Z.Z.t("general:User type"),dataIndex:"type",key:"type",width:"120px",sorter:!0},this.getColumnSearchProps("type")),(0,a.Z)((0,a.Z)({title:Z.Z.t("user:Tag"),dataIndex:"tag",key:"tag",width:"110px",sorter:!0},this.getColumnSearchProps("tag")),{},{render:function(e,n,a){var i,s,o,l;if(0===(null===(i=t.state.organization)||void 0===i||null===(s=i.tags)||void 0===s?void 0:s.length))return e;var c={};return null===(o=t.state.organization)||void 0===o||null===(l=o.tags)||void 0===l||l.map((function(e,t){var n=e.split("|"),a="zh"!==r.G3()?n[0]:n[1];c[n[0]]=a})),c[e]}}),{title:Z.Z.t("user:Is admin"),dataIndex:"isAdmin",key:"isAdmin",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("user:Is forbidden"),dataIndex:"isForbidden",key:"isForbidden",width:"110px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("user:Is deleted"),dataIndex:"isDeleted",key:"isDeleted",width:"110px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"190px",fixed:r.tq()?"false":"right",render:function(e,n,a){var i=void 0!==t.props.groupName,r=n.owner===t.props.account.owner&&n.name===t.props.account.name||"built-in"===n.owner&&"admin"===n.name;return(0,v.jsxs)(m.Z,{children:[(0,v.jsx)(d.ZP,{size:i?"small":"middle",type:"primary",onClick:function(){sessionStorage.setItem("userListUrl",window.location.pathname),t.props.history.push("/users/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),i?(0,v.jsx)(Ke,{text:Z.Z.t("general:remove"),title:Z.Z.t("general:Sure to remove")+": ".concat(n.name," ?"),onConfirm:function(){return t.removeUserFromGroup(a)},disabled:r,size:"small"}):null,(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteUser(a)},disabled:r,size:i?"small":"default"})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Users"),"\xa0\xa0\xa0\xa0",(0,v.jsxs)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:t.addUser.bind(t),children:[Z.Z.t("general:Add")," "]}),t.renderUpload()]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),bn=Cn,Sn=n(37762),wn=n(82138),Pn=n(12019),An=n(8105),In=n(21198),Fn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a,i,s;return(0,G.Z)(this,n),(s=t.call(this,e)).setTreeExpandedKeys=function(){var e=[];!function t(n){var a,i=(0,Sn.Z)(n);try{for(i.s();!(a=i.n()).done;){var r=a.value;e.push(r.key),r.children&&t(r.children)}}catch(s){i.e(s)}finally{i.f()}}(s.state.treeData),s.setState({expandedKeys:e})},s.state={classes:e,owner:r.VN(s.props.account)?"":s.props.account.owner,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,groupName:null===(a=s.props.match)||void 0===a?void 0:a.params.groupName,treeData:[],selectedKeys:[null===(i=s.props.match)||void 0===i?void 0:i.params.groupName]},s}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getTreeData()}},{key:"componentDidUpdate",value:function(e,t,n){this.state.organizationName!==t.organizationName&&this.getTreeData(),t.treeData!==this.state.treeData&&this.setTreeExpandedKeys()}},{key:"getTreeData",value:function(){var e=this;ce(this.state.organizationName,!0).then((function(t){"ok"===t.status?e.setState({treeData:t.data}):r.PV("error",t.msg)}))}},{key:"setTreeTitle",value:function(e){var t=this,n=Array.isArray(e.children)&&e.children.length>0,a=this.state.groupName===e.key;return{key:e.key,title:(0,v.jsxs)(m.Z,{children:["Physical"===e.type?(0,v.jsx)(_e.Z,{}):(0,v.jsx)($e.Z,{}),(0,v.jsx)("span",{children:e.title}),a&&(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(wn.Z,{style:{visibility:"visible",color:"inherit",transition:"color 0.3s"},onMouseEnter:function(e){e.currentTarget.style.color="rgba(89,54,213,0.6)"},onMouseLeave:function(e){e.currentTarget.style.color="inherit"},onMouseDown:function(e){e.currentTarget.style.color="rgba(89,54,213,0.4)"},onMouseUp:function(e){e.currentTarget.style.color="rgba(89,54,213,0.6)"},onClick:function(e){e.stopPropagation(),sessionStorage.setItem("groupTreeUrl",window.location.pathname),t.addGroup()}}),(0,v.jsx)(Pn.Z,{style:{visibility:"visible",color:"inherit",transition:"color 0.3s"},onMouseEnter:function(e){e.currentTarget.style.color="rgba(89,54,213,0.6)"},onMouseLeave:function(e){e.currentTarget.style.color="inherit"},onMouseDown:function(e){e.currentTarget.style.color="rgba(89,54,213,0.4)"},onMouseUp:function(e){e.currentTarget.style.color="rgba(89,54,213,0.6)"},onClick:function(n){n.stopPropagation(),sessionStorage.setItem("groupTreeUrl",window.location.pathname),t.props.history.push("/groups/".concat(t.state.organizationName,"/").concat(e.key))}}),!n&&(0,v.jsx)(Me.Z,{style:{visibility:"visible",color:"inherit",transition:"color 0.3s"},onMouseEnter:function(e){e.currentTarget.style.color="rgba(89,54,213,0.6)"},onMouseLeave:function(e){e.currentTarget.style.color="inherit"},onMouseDown:function(e){e.currentTarget.style.color="rgba(89,54,213,0.4)"},onMouseUp:function(e){e.currentTarget.style.color="rgba(89,54,213,0.6)"},onClick:function(n){n.stopPropagation(),pe({owner:e.owner,name:e.key}).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.getTreeData()):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}})]})]}),children:n?e.children.map((function(e){return t.setTreeTitle(e)})):[]}}},{key:"renderTree",value:function(){var e=this;if(0===this.state.treeData.length)return(0,v.jsx)(An.Z,{});var t=this.state.treeData.map((function(t){return e.setTreeTitle(t)}));return(0,v.jsx)(gn.Z,{blockNode:!0,defaultSelectedKeys:[this.state.groupName],defaultExpandAll:!0,selectedKeys:this.state.selectedKeys,expandedKeys:this.state.expandedKeys,onSelect:function(t,n){e.setState({selectedKeys:t,groupName:n.node.key}),e.props.history.push("/trees/".concat(e.state.organizationName,"/").concat(n.node.key))},onExpand:function(t){e.setState({expandedKeys:t})},showIcon:!0,treeData:t})}},{key:"renderOrganizationSelect",value:function(){var e=this;if(r.VN(this.props.account))return(0,v.jsx)(In.Z,{initValue:this.state.organizationName,style:{width:"100%"},onChange:function(t){e.setState({organizationName:t,groupName:""}),e.props.history.push("/trees/".concat(t))}})}},{key:"newGroup",value:function(e){var t=r.VO();return{owner:this.state.organizationName,name:"group_".concat(t),createdTime:Fe()().format(),updatedTime:Fe()().format(),displayName:"New Group - ".concat(t),type:"Virtual",parentId:e?this.state.organizationName:this.state.groupName,isTopGroup:e,isEnabled:!0}}},{key:"addGroup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.newGroup(t);de(n).then((function(t){"ok"===t.status?(sessionStorage.setItem("groupTreeUrl",window.location.pathname),e.props.history.push({pathname:"/groups/".concat(n.owner,"/").concat(n.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsx)("div",{style:{flex:1,backgroundColor:"white",padding:"5px 5px 2px 5px"},children:(0,v.jsxs)(R.Z,{children:[(0,v.jsxs)(L.Z,{span:5,children:[(0,v.jsx)(R.Z,{children:(0,v.jsx)(L.Z,{span:24,style:{textAlign:"center"},children:this.renderOrganizationSelect()})}),(0,v.jsx)(R.Z,{children:(0,v.jsxs)(L.Z,{span:24,style:{marginTop:"10px"},children:[(0,v.jsx)(d.ZP,{size:"small",onClick:function(){e.setState({selectedKeys:[],groupName:void 0}),e.props.history.push("/trees/".concat(e.state.organizationName))},children:Z.Z.t("group:Show all")}),(0,v.jsx)(d.ZP,{size:"small",type:"primary",style:{marginLeft:"10px"},onClick:function(){return e.addGroup(!0)},children:Z.Z.t("general:Add")})]})}),(0,v.jsx)(R.Z,{style:{marginTop:10},children:(0,v.jsx)(L.Z,{span:24,style:{textAlign:"left"},children:this.renderTree()})})]}),(0,v.jsx)(L.Z,{span:19,children:(0,v.jsx)(bn,(0,a.Z)({organizationName:this.state.organizationName,groupName:this.state.groupName},this.props))})]})})}}]),n}(y.Component),zn=Fn,Nn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i;return(0,G.Z)(this,n),(i=t.call(this,e)).fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.searchedColumn,n=e.searchText,s=e.sortField,o=e.sortOrder;void 0!==e.category&&null!==e.category?(t="category",n=e.category):void 0!==e.type&&null!==e.type&&(t="type",n=e.type),i.setState({loading:!0}),ce(r.Qy(i.props.account)?"":r.jb(i.props.account),!1,e.pagination.current,e.pagination.pageSize,t,n,s,o).then((function(t){i.setState({loading:!1}),"ok"===t.status?i.setState({data:t.data,pagination:(0,a.Z)((0,a.Z)({},e.pagination),{},{total:t.data2}),searchText:e.searchText,searchedColumn:e.searchedColumn}):r.Ai(t)&&i.setState({isAuthorized:!1})})).catch((function(e){i.setState({loading:!1}),r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))},i.state=(0,a.Z)((0,a.Z)({},i.state),{},{owner:r.VN(i.props.account)?"":i.props.account.owner,groups:[]}),i}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){(0,vn.Z)((0,jn.Z)(n.prototype),"UNSAFE_componentWillMount",this).call(this)}},{key:"newGroup",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"group_".concat(e),createdTime:Fe()().format(),updatedTime:Fe()().format(),displayName:"New Group - ".concat(e),type:"Virtual",parentId:this.props.account.owner,isTopGroup:!0,isEnabled:!0}}},{key:"addGroup",value:function(){var e=this,t=this.newGroup();de(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/groups/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteGroup",value:function(e){var t=this;pe(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/groups/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"140px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"180px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("general:Updated time"),dataIndex:"updatedTime",key:"updatedTime",width:"180px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("general:Type"),dataIndex:"type",key:"type",width:"140px",sorter:!0,filterMultiple:!1,filters:[{text:Z.Z.t("group:Virtual"),value:"Virtual"},{text:Z.Z.t("group:Physical"),value:"Physical"}],render:function(e,t,n){return Z.Z.t("group:"+e)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("group:Parent group"),dataIndex:"parentId",key:"parentId",width:"220px",sorter:!0},this.getColumnSearchProps("parentId")),{},{render:function(e,t,n){return t.isTopGroup?(0,v.jsx)(T.rU,{to:"/organizations/".concat(t.parentId),children:t.parentId}):(0,v.jsx)(T.rU,{to:"/groups/".concat(t.owner,"/").concat(t.parentId),children:null===t||void 0===t?void 0:t.parentName})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Users"),dataIndex:"users",key:"users",sorter:!0},this.getColumnSearchProps("users")),{},{render:function(e,t,n){return r.NJ(e,"users")}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"180px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/groups/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),n.haveChildren?(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("group:You need to delete all subgroups first. You can view the subgroups in the left group tree of the [Organizations] -> [Groups] page"),children:(0,v.jsx)(d.ZP,{disabled:!0,type:"primary",danger:!0,children:Z.Z.t("general:Delete")})}):(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteGroup(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Groups"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addGroup.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Un=Nn,En=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,groupName:e.match.params.groupName,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,group:null,users:[],groups:[],organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getGroup(),this.getGroups(this.state.organizationName),this.getOrganizations()}},{key:"getGroup",value:function(){var e,t,n=this;(e=this.state.organizationName,t=this.state.groupName,fetch("".concat(r.nn,"/api/get-group?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){"ok"===e.status&&n.setState({group:e.data})}))}},{key:"getGroups",value:function(e){var t=this;ce(e).then((function(e){"ok"===e.status&&t.setState({groups:e.data})}))}},{key:"getOrganizations",value:function(){var e=this;he.dk("admin").then((function(t){"ok"===t.status&&e.setState({organizations:t.data||[]})}))}},{key:"parseGroupField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateGroupField",value:function(e,t){t=this.parseGroupField(e,t);var n=this.state.group;n[e]=t,this.setState({group:n})}},{key:"getParentIdOptions",value:function(){var e=this,t=this.state.groups.filter((function(t){return t.name!==e.state.group.name})),n=this.state.organizations.find((function(t){return t.name===e.state.group.owner}));return void 0!==n&&t.push({name:n.name,displayName:n.displayName}),t.map((function(e){return{label:e.displayName,value:e.name}}))}},{key:"renderGroup",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("group:New Group"):Z.Z.t("group:Edit Group"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitGroupEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitGroupEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteGroup()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.group.owner,onChange:function(t){e.updateGroupField("owner",t),e.getGroups(t)},options:this.state.organizations.map((function(e){return r.Rl(e.displayName,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.group.name,onChange:function(t){e.updateGroupField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.group.displayName,onChange:function(t){e.updateGroupField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Type"),Z.Z.t("general:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{style:{width:"100%"},options:[{label:Z.Z.t("group:Virtual"),value:"Virtual"},{label:Z.Z.t("group:Physical"),value:"Physical"}].map((function(e){return{label:e.label,value:e.value}})),value:this.state.group.type,onChange:function(t){e.updateGroupField("type",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("group:Parent group"),Z.Z.t("group:Parent group - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{style:{width:"100%"},options:this.getParentIdOptions(),value:this.state.group.parentId,onChange:function(t){e.updateGroupField("parentId",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Users"),Z.Z.t("general:Users - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:22,children:r.NJ(this.state.group.users,"users")})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.group.isEnabled,onChange:function(t){e.updateGroupField("isEnabled",t)}})})]})]})}},{key:"submitGroupEdit",value:function(e){var t=this,n=r.p$(this.state.group);n.isTopGroup=this.state.organizations.some((function(e){return e.name===n.parentId})),function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-group?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(this.state.organizationName,this.state.groupName,n).then((function(n){if("ok"===n.status)if(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({groupName:t.state.group.name}),e){var a=sessionStorage.getItem("groupTreeUrl");null!==a?(sessionStorage.removeItem("groupTreeUrl"),t.props.history.push(a)):t.props.history.push("/groups")}else t.props.history.push("/groups/".concat(t.state.group.owner,"/").concat(t.state.group.name));else r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateGroupField("name",t.state.groupName)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteGroup",value:function(){var e=this;pe(this.state.group).then((function(t){if("ok"===t.status){var n=sessionStorage.getItem("groupTreeUrl");null!==n?(sessionStorage.removeItem("groupTreeUrl"),e.props.history.push(n)):e.props.history.push("/groups")}else r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.group?this.renderGroup():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitGroupEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitGroupEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteGroup()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),Rn=n(43773),Ln=n(60020),On=n(19338),Vn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),On.pe(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newInvitation",value:function(){var e=r.VO(),t=r.jb(this.props.account),n=Math.random().toString(36).slice(-10);return{owner:t,name:"invitation_".concat(e),createdTime:Fe()().format(),updatedTime:Fe()().format(),displayName:"New Invitation - ".concat(e),code:n,defaultCode:n,quota:1,usedCount:0,application:"All",username:"",email:"",phone:"",signupGroup:"",state:"Active"}}},{key:"addInvitation",value:function(){var e=this,t=this.newInvitation();On.xw(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/invitations/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteInvitation",value:function(e){var t=this;On.ZH(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"140px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/invitations/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"150px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Updated time"),dataIndex:"updatedTime",key:"updatedTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"170px",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)({title:Z.Z.t("invitation:Code"),dataIndex:"code",key:"code",width:"160px",sorter:!0},this.getColumnSearchProps("code")),(0,a.Z)({title:Z.Z.t("invitation:Quota"),dataIndex:"quota",key:"quota",width:"120px",sorter:!0},this.getColumnSearchProps("quota")),(0,a.Z)({title:Z.Z.t("invitation:Used count"),dataIndex:"usedCount",key:"usedCount",width:"130px",sorter:!0},this.getColumnSearchProps("usedCount")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Application"),dataIndex:"application",key:"application",width:"170px",sorter:!0},this.getColumnSearchProps("application")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Email"),dataIndex:"email",key:"email",width:"160px",sorter:!0},this.getColumnSearchProps("email")),{},{render:function(e,t,n){return(0,v.jsx)("a",{href:"mailto:".concat(e),children:e})}}),(0,a.Z)({title:Z.Z.t("general:Phone"),dataIndex:"phone",key:"phone",width:"120px",sorter:!0},this.getColumnSearchProps("phone")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:State"),dataIndex:"state",key:"state",width:"120px",sorter:!0},this.getColumnSearchProps("state")),{},{render:function(e,t,n){switch(e){case"Active":return r.h1("success",Z.Z.t("subscription:Active"),(0,v.jsx)(Rn.Z,{spin:!0}));case"Suspended":return r.h1("default",Z.Z.t("subscription:Suspended"),(0,v.jsx)(Ln.Z,{}));default:return null}}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"180px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/invitations/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteInvitation(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Invitations"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addInvitation.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),qn=Vn,Dn=ne.Z.Option,Mn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,invitationName:e.match.params.invitationName,invitation:null,organizations:[],applications:[],groups:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getInvitation(),this.getOrganizations(),this.getApplicationsByOrganization(this.state.organizationName),this.getGroupsByOrganization(this.state.organizationName)}},{key:"getInvitation",value:function(){var e=this;On.KO(this.state.organizationName,this.state.invitationName).then((function(t){null!==t.data?e.setState({invitation:t.data}):e.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getApplicationsByOrganization",value:function(e){var t=this;W.rW("admin",e).then((function(e){t.setState({applications:e.data||[]})}))}},{key:"getGroupsByOrganization",value:function(e){var t=this;ce(e).then((function(e){"ok"===e.status&&t.setState({groups:e.data})}))}},{key:"parseInvitationField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateInvitationField",value:function(e,t){t=this.parseInvitationField(e,t);var n=this.state.invitation;n[e]=t,this.setState({invitation:n})}},{key:"copySignupLink",value:function(){var e,t;if("built-in"===this.state.invitation.owner)t="app-built-in";else{var n=r.rq(this.state.organizations,"name",this.state.invitation.owner);if(!(t=n.defaultApplication))return void r.PV("error",Z.Z.t("invitation:You need to specify a default application for ")+n.name)}ot()("".concat(window.location.origin,"/signup/").concat(t,"?invitationCode=").concat(null===(e=this.state.invitation)||void 0===e?void 0:e.defaultCode)),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))}},{key:"renderInvitation",value:function(){var e=this,t="auto_created_invitation_for_plan"===this.state.invitation.tag;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("invitation:New Invitation"):Z.Z.t("invitation:Edit Invitation"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitInvitationEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitInvitationEdit(!0)},children:Z.Z.t("general:Save & Exit")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(t){return e.copySignupLink()},children:Z.Z.t("application:Copy signup page URL")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteInvitation()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account)||t,value:this.state.invitation.owner,onChange:function(t){e.updateInvitationField("owner",t),e.getApplicationsByOrganization(t),e.getGroupsByOrganization(t)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(Dn,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.name,disabled:t,onChange:function(t){e.updateInvitationField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.displayName,onChange:function(t){e.updateInvitationField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("invitation:Code"),Z.Z.t("invitation:Code - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.code,onChange:function(t){/[^a-zA-Z0-9]/.test(t.target.value)||e.updateInvitationField("defaultCode",t.target.value),e.updateInvitationField("code",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("invitation:Default code"),Z.Z.t("invitation:Default code - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.defaultCode,onChange:function(t){e.updateInvitationField("defaultCode",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("invitation:Quota"),Z.Z.t("invitation:Quota - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{min:0,value:this.state.invitation.quota,onChange:function(t){e.updateInvitationField("quota",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("invitation:Used count"),Z.Z.t("invitation:Used count - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{min:0,max:this.state.invitation.quota,value:this.state.invitation.usedCount,onChange:function(t){e.updateInvitationField("usedCount",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Application"),Z.Z.t("general:Application - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.invitation.application,onChange:function(t){e.updateInvitationField("application",t)},options:[{label:Z.Z.t("general:All"),value:"All"}].concat((0,Ve.Z)(this.state.applications.map((function(e){return r.Rl(e.name,e.name)}))))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Signup group"),Z.Z.t("provider:Signup group - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.invitation.signupGroup,onChange:function(t){e.updateInvitationField("signupGroup",t)},children:[(0,v.jsx)(Dn,{value:"",children:Z.Z.t("general:Default")},""),this.state.groups.map((function(e,t){return(0,v.jsx)(Dn,{value:"".concat(e.owner,"/").concat(e.name),children:e.name},t)}))]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("signup:Username"),Z.Z.t("signup:Username - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.username,onChange:function(t){e.updateInvitationField("username",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Email"),Z.Z.t("general:Email - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.email,onChange:function(t){e.updateInvitationField("email",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Phone"),Z.Z.t("general:Phone - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.invitation.phone,onChange:function(t){e.updateInvitationField("phone",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:State"),Z.Z.t("general:State - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.invitation.state,onChange:function(t){e.updateInvitationField("state",t)},options:[{value:"Active",name:Z.Z.t("subscription:Active")},{value:"Suspended",name:Z.Z.t("subscription:Suspended")}].map((function(e){return r.Rl(e.name,e.value)}))})})]})]})}},{key:"submitInvitationEdit",value:function(e){var t=this,n=r.p$(this.state.invitation);On._V(this.state.organizationName,this.state.invitationName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({invitationName:t.state.invitation.name}),e?t.props.history.push("/invitations"):t.props.history.push("/invitations/".concat(t.state.invitation.owner,"/").concat(t.state.invitation.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateInvitationField("name",t.state.invitationName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteInvitation",value:function(){var e=this;On.ZH(this.state.invitation).then((function(t){"ok"===t.status?e.props.history.push("/invitations"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.invitation?this.renderInvitation():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitInvitationEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitInvitationEdit(!0)},children:Z.Z.t("general:Save & Exit")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(t){return e.copySignupLink()},children:Z.Z.t("application:Copy signup page URL")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteInvitation()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),Bn=n(4942),Wn=n(67082),Hn=n(26418),Gn=n(71994),Jn=function(e){var t={},n=e.height,i=e.width;e.fillHeight&&(n="100%",t=(0,a.Z)((0,a.Z)({},t),{},{height:"100%"})),e.fillWidth&&(i="100%",t=(0,a.Z)((0,a.Z)({},t),{},{width:"100%"})),["width","maxWidth","minWidth","height","maxHeight","minHeight"].forEach((function(n){["number","string"].includes(typeof e[n])&&(t=(0,a.Z)((0,a.Z)({},t),{},(0,Bn.Z)({},n,e[n])))})),e.style&&(t=(0,a.Z)((0,a.Z)({},t),e.style));var r=[];switch(e.lang){case"javascript":case"js":r=[Gn.RI.javascript()];break;case"html":r=[Gn.RI.html()];break;case"css":r=[Gn.RI.css()];break;case"xml":r=[Gn.RI.xml()];break;case"json":r=[Gn.RI.json()]}return(0,v.jsx)(Wn.ZP,(0,a.Z)((0,a.Z)({value:e.value},e),{},{width:i,height:n,style:t,readOnly:e.readOnly,theme:e.dark?Hn.m4:"light",extensions:r,onChange:e.onChange}))},Qn=".signup-email{}\n.signup-email-input{}\n.signup-email-code{}\n.signup-email-code-input{}\n",Kn=".signup-phone{}\n.signup-phone-input{}\n.phone-code{}\n.signup-phone-code-input{}",_n={Username:".signup-username {}\n.signup-username-input {}","Display name":".signup-first-name {}\n.signup-first-name-input{}\n.signup-last-name{}\n.signup-last-name-input{}\n.signup-name{}\n.signup-name-input{}",Affiliation:".signup-affiliation{}\n.signup-affiliation-input{}","Country/Region":".signup-country-region{}\n.signup-region-select{}","ID card":".signup-idcard{}\n.signup-idcard-input{}",Password:".signup-password{}\n.signup-password-input{}","Confirm password":".signup-confirm{}",Email:Qn,Phone:Kn,"Email or Phone":Qn+Kn,"Phone or Email":Qn+Kn,"Invitation code":".signup-invitation-code{}\n.signup-invitation-code-input{}",Agreement:".login-agreement{}","Signup button":".signup-button{}\n.signup-link{}",Providers:".provider-img {\n width: 30px;\n margin: 5px;\n }\n .provider-big-img {\n margin-bottom: 10px;\n }\n "},$n=ne.Z.Option,Yn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:r.dj(e,"Please select a signup item"),visible:!0,required:!0,options:[],rule:"None",customCss:""};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",render:function(n,a,i){var s=[{name:"Username",displayName:Z.Z.t("signup:Username")},{name:"ID",displayName:Z.Z.t("general:ID")},{name:"Display name",displayName:Z.Z.t("general:Display name")},{name:"Affiliation",displayName:Z.Z.t("user:Affiliation")},{name:"Gender",displayName:Z.Z.t("user:Gender")},{name:"Bio",displayName:Z.Z.t("user:Bio")},{name:"Tag",displayName:Z.Z.t("user:Tag")},{name:"Education",displayName:Z.Z.t("user:Education")},{name:"Country/Region",displayName:Z.Z.t("user:Country/Region")},{name:"ID card",displayName:Z.Z.t("user:ID card")},{name:"Password",displayName:Z.Z.t("general:Password")},{name:"Confirm password",displayName:Z.Z.t("signup:Confirm")},{name:"Email",displayName:Z.Z.t("general:Email")},{name:"Phone",displayName:Z.Z.t("general:Phone")},{name:"Email or Phone",displayName:Z.Z.t("general:Email or Phone")},{name:"Phone or Email",displayName:Z.Z.t("general:Phone or Email")},{name:"Invitation code",displayName:Z.Z.t("application:Invitation code")},{name:"Agreement",displayName:Z.Z.t("signup:Agreement")},{name:"Signup button",displayName:Z.Z.t("signup:Signup button")},{name:"Providers",displayName:Z.Z.t("general:Providers")},{name:"Text 1",displayName:Z.Z.t("signup:Text 1")},{name:"Text 2",displayName:Z.Z.t("signup:Text 2")},{name:"Text 3",displayName:Z.Z.t("signup:Text 3")},{name:"Text 4",displayName:Z.Z.t("signup:Text 4")},{name:"Text 5",displayName:Z.Z.t("signup:Text 5")}];return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:function(e){var t=s.filter((function(t){return t.name===e}));return 0===t.length?"":t[0].displayName}(n),onChange:function(n){t.updateField(e,i,"name",n),t.updateField(e,i,"customCss",_n[n])},children:r.fJ(s,e,"name").map((function(e,t){return(0,v.jsx)($n,{value:e.name,children:e.displayName},t)}))})}},{title:Z.Z.t("organization:Visible"),dataIndex:"visible",key:"visible",width:"80px",render:function(n,a,i){return"ID"===a.name?null:(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"visible",n),n?t.updateField(e,i,"required",!0):t.updateField(e,i,"required",!1)}})}},{title:Z.Z.t("provider:Required"),dataIndex:"required",key:"required",width:"80px",render:function(n,a,i){return!a.visible||["Signup button","Providers"].includes(a.name)?null:(0,v.jsx)(re.Z,{checked:n,disabled:"Password"===a.name,onChange:function(n){t.updateField(e,i,"required",n)}})}},{title:Z.Z.t("provider:Prompted"),dataIndex:"prompted",key:"prompted",width:"80px",render:function(n,a,i){return["ID","Signup button","Providers"].includes(a.name)||a.visible&&"Country/Region"!==a.name?null:(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"prompted",n)}})}},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"160px",render:function(n,a,i){var s=[{id:"Input",name:Z.Z.t("application:Input")},{id:"Single Choice",name:Z.Z.t("application:Single Choice")},{id:"Multiple Choices",name:Z.Z.t("application:Multiple Choices")}];return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"type",n)},options:s.map((function(e){return r.Rl(e.name,e.id)}))})}},{title:Z.Z.t("signup:Label"),dataIndex:"label",key:"label",width:"150px",render:function(n,a,i){return a.name.startsWith("Text ")?(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:n,lang:"html",fillHeight:!0,dark:!0,onChange:function(n){t.updateField(e,i,"label",n)}})}),title:Z.Z.t("signup:Label HTML"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:n,style:{marginBottom:"10px"},onChange:function(n){t.updateField(e,i,"label",n.target.value)}})}):(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"label",n.target.value)}})}},{title:Z.Z.t("application:Custom CSS"),dataIndex:"customCss",key:"customCss",width:"180px",render:function(n,a,i){return(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:n||_n[a.name],lang:"css",fillHeight:!0,dark:!0,onChange:function(n){t.updateField(e,i,"customCss",n||_n[a.name])}})}),title:Z.Z.t("application:CSS style"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:n||_n[a.name],onChange:function(n){t.updateField(e,i,"customCss",n.target.value?n.target.value:_n[a.name])}})})}},{title:Z.Z.t("signup:Placeholder"),dataIndex:"placeholder",key:"placeholder",width:"110px",render:function(n,a,i){return a.name.startsWith("Text ")?null:(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"placeholder",n.target.value)}})}},{title:Z.Z.t("signup:Options"),dataIndex:"options",key:"options",width:"180px",render:function(n,a,i){return"Single Choice"!==a.type&&"Multiple Choices"!==a.type?null:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"options",n)},options:null===n||void 0===n?void 0:n.map((function(e){return r.Rl(e,e)}))})}},{title:Z.Z.t("signup:Regex"),dataIndex:"regex",key:"regex",width:"180px",render:function(n,a,i){return a.name.startsWith("Text ")||["Password","Confirm password","Signup button","Provider"].includes(a.name)?null:(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"regex",n.target.value)}})}},{title:Z.Z.t("application:Rule"),dataIndex:"rule",key:"rule",width:"155px",render:function(n,a,i){var s=[];return"ID"===a.name?s=[{id:"Random",name:Z.Z.t("application:Random")},{id:"Incremental",name:Z.Z.t("application:Incremental")}]:"Display name"===a.name?s=[{id:"None",name:Z.Z.t("general:None")},{id:"Real name",name:Z.Z.t("application:Real name")},{id:"First, last",name:Z.Z.t("application:First, last")}]:"Email"===a.name||"Phone"===a.name?s=[{id:"Normal",name:Z.Z.t("application:Normal")},{id:"No verification",name:Z.Z.t("application:No verification")}]:"Agreement"===a.name?s=[{id:"None",name:Z.Z.t("application:Only signup")},{id:"Signin",name:Z.Z.t("application:Signin")},{id:"Signin (Default True)",name:Z.Z.t("application:Signin (Default True)")}]:"Providers"===a.name&&(s=[{id:"big",name:Z.Z.t("application:Big icon")},{id:"small",name:Z.Z.t("application:Small icon")}]),0===s.length?null:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"rule",n)},options:s.map((function(e){return r.Rl(e.name,e.id)}))})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{disabled:"Signup button"===a.name,icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"name",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),Xn=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i;return(0,G.Z)(this,n),(i=t.call(this,e)).fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.searchedColumn,n=e.searchText,s=e.sortField,o=e.sortOrder;i.setState({loading:!0}),(r.Qy(i.props.account)?W.RV("admin",e.pagination.current,e.pagination.pageSize,t,n,s,o):W.rW("admin",r.jb(i.props.account),e.pagination.current,e.pagination.pageSize,t,n,s,o)).then((function(t){i.setState({loading:!1}),"ok"===t.status?i.setState({data:t.data,pagination:(0,a.Z)((0,a.Z)({},e.pagination),{},{total:t.data2}),searchText:e.searchText,searchedColumn:e.searchedColumn}):r.Ai(t)?i.setState({isAuthorized:!1}):r.PV("error",t.msg)}))},i}return(0,J.Z)(n,[{key:"newApplication",value:function(){var e=r.VO(),t=r.jb(this.props.account);return{owner:"admin",name:"application_".concat(e),organization:t,createdTime:Fe()().format(),displayName:"New Application - ".concat(e),logo:"".concat(r.WD,"/img/casdoor-logo_1185x256.png"),enablePassword:!0,enableSignUp:!0,enableSigninSession:!1,enableCodeSignin:!1,enableSamlCompress:!1,providers:[{name:"provider_captcha_default",canSignUp:!1,canSignIn:!1,canUnlink:!1,prompted:!1,signupGroup:"",rule:""}],SigninMethods:[{name:"Password",displayName:"Password",rule:"All"},{name:"Verification code",displayName:"Verification code",rule:"All"},{name:"WebAuthn",displayName:"WebAuthn",rule:"None"},{name:"Face ID",displayName:"Face ID",rule:"None"}],signupItems:[{name:"ID",visible:!1,required:!0,rule:"Random"},{name:"Username",visible:!0,required:!0,rule:"None"},{name:"Display name",visible:!0,required:!0,rule:"None"},{name:"Password",visible:!0,required:!0,rule:"None"},{name:"Confirm password",visible:!0,required:!0,rule:"None"},{name:"Email",visible:!0,required:!0,rule:"Normal"},{name:"Phone",visible:!0,required:!0,rule:"None"},{name:"Agreement",visible:!0,required:!0,rule:"None"},{name:"Signup button",visible:!0,required:!0,rule:"None"},{name:"Providers",visible:!0,required:!0,rule:"None",customCss:_n.Providers}],grantTypes:["authorization_code","password","client_credentials","token","id_token","refresh_token"],cert:"cert-built-in",redirectUris:["http://localhost:9000/callback"],tokenFormat:"JWT",tokenFields:[],expireInHours:168,refreshExpireInHours:168,formOffset:2}}},{key:"addApplication",value:function(){var e=this,t=this.newApplication();W.E9(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/applications/".concat(t.organization,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteApplication",value:function(e){var t=this;W.rw(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.organization,"/").concat(e),children:r.Zh(t)})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),{title:"Logo",dataIndex:"logo",key:"logo",width:"200px",render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:(0,v.jsx)("img",{src:e,alt:e,width:150})})}},(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"organization",key:"organization",width:"150px",sorter:!0},this.getColumnSearchProps("organization")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Providers"),dataIndex:"providers",key:"providers"},this.getColumnSearchProps("providers")),{},{render:function(e,n,a){var i=e;if(null===i||0===i.length)return"(".concat(Z.Z.t("general:empty"),")");var s=Math.floor((i.length+1)/2),o=function(e){return(0,v.jsx)(se.Z,{size:"small",locale:{emptyText:" "},dataSource:e,renderItem:function(e,a){return(0,v.jsx)(se.Z.Item,{children:(0,v.jsxs)("div",{style:{display:"inline"},children:[(0,v.jsx)(l.Z,{placement:"topLeft",title:"Edit",children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},icon:(0,v.jsx)(Pn.Z,{}),size:"small",onClick:function(){return r.d8(t,"/providers/".concat(n.organization,"/").concat(e.name))}})}),(0,v.jsx)(T.rU,{to:"/providers/".concat(n.organization,"/").concat(e.name),children:e.name})]})})}})};return(0,v.jsx)("div",{children:(0,v.jsxs)(R.Z,{children:[(0,v.jsx)(L.Z,{span:12,children:o(i.slice(0,s))}),(0,v.jsx)(L.Z,{span:12,children:o(i.slice(s))})]})})}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/applications/".concat(n.organization,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteApplication(a)},disabled:"app-built-in"===n.name})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Applications"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addApplication.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),ea=Xn,ta=n(66407);function na(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-certs?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function aa(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-cert"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var ia=n(12920),ra=n(4993),sa=n(70761),oa=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n){e[t]=n,this.updateTable(e)}},{key:"addRow",value:function(e){void 0===e&&(e=[]),e=r.SA(e,""),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this;if(null===e)return null;var n=[{title:Z.Z.t("application:Redirect URL"),dataIndex:"id",key:"id",render:function(n,a,i){return(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:n,onChange:function(n){t.updateField(e,i,n.target.value)}})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{rowKey:"index",columns:n,dataSource:e.map((function(e,t){return{id:e,index:t}})),size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),la=n(20293),ca=ne.Z.Option,da=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"getUserOrganization",value:function(){var e;return null===(e=this.props.application)||void 0===e?void 0:e.organizationObj}},{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:r.dj(e,"Please select a provider"),canSignUp:!0,canSignIn:!0,canUnlink:!0,prompted:!1,signupGroup:"",rule:"None"};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",render:function(n,a,i){return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"name",n);var a=r.rq(t.props.providers,"name",n);t.updateField(e,i,"provider",a),"Email"!==a.category&&"SMS"!==a.category||t.updateField(e,i,"rule","All")},children:r.fJ(t.props.providers,e,"name").map((function(e,t){return(0,v.jsx)(ca,{value:e.name,children:e.name},t)}))})}},{title:Z.Z.t("provider:Category"),dataIndex:"category",key:"category",width:"100px",render:function(e,n,a){var i=r.rq(t.props.providers,"name",n.name);return null===i||void 0===i?void 0:i.category}},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"80px",render:function(e,n,a){var i=r.rq(t.props.providers,"name",n.name);return la.Il(i)}},{title:Z.Z.t("user:Country/Region"),dataIndex:"countryCodes",key:"countryCodes",width:"140px",render:function(n,a,i){var r,s;return"SMS"!==(null===(r=a.provider)||void 0===r?void 0:r.category)?null:(0,v.jsx)(Je.l,{style:{width:"100%"},hasDefault:!0,mode:"multiple",initValue:n||["All"],onChange:function(n){t.updateField(e,i,"countryCodes",n)},countryCodes:null===(s=t.getUserOrganization())||void 0===s?void 0:s.countryCodes})}},{title:Z.Z.t("provider:Can signup"),dataIndex:"canSignUp",key:"canSignUp",width:"120px",render:function(n,a,i){var r;return["OAuth","Web3"].includes(null===(r=a.provider)||void 0===r?void 0:r.category)?(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"canSignUp",n)}}):null}},{title:Z.Z.t("provider:Can signin"),dataIndex:"canSignIn",key:"canSignIn",width:"120px",render:function(n,a,i){var r;return["OAuth","Web3"].includes(null===(r=a.provider)||void 0===r?void 0:r.category)?(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"canSignIn",n)}}):null}},{title:Z.Z.t("provider:Can unlink"),dataIndex:"canUnlink",key:"canUnlink",width:"120px",render:function(n,a,i){var r;return["OAuth","Web3"].includes(null===(r=a.provider)||void 0===r?void 0:r.category)?(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"canUnlink",n)}}):null}},{title:Z.Z.t("provider:Prompted"),dataIndex:"prompted",key:"prompted",width:"120px",render:function(n,a,i){var r;return["OAuth","Web3"].includes(null===(r=a.provider)||void 0===r?void 0:r.category)?(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"prompted",n)}}):null}},{title:Z.Z.t("provider:Signup group"),dataIndex:"signupGroup",key:"signupGroup",width:"120px",render:function(n,a,i){var r;return["OAuth","Web3"].includes(null===(r=a.provider)||void 0===r?void 0:r.category)?(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"signupGroup",n.target.value)}}):null}},{title:Z.Z.t("application:Rule"),dataIndex:"rule",key:"rule",width:"160px",render:function(n,a,i){var r,s,o,l;return"Google"===(null===(r=a.provider)||void 0===r?void 0:r.type)?("None"===n&&(n="Default"),(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,defaultValue:"Default",onChange:function(n){t.updateField(e,i,"rule",n)},children:[(0,v.jsx)(ca,{value:"Default",children:Z.Z.t("general:Default")},"Default"),(0,v.jsx)(ca,{value:"OneTap",children:"One Tap"},"OneTap")]})):"Captcha"===(null===(s=a.provider)||void 0===s?void 0:s.category)?(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,defaultValue:"None",onChange:function(n){t.updateField(e,i,"rule",n)},children:[(0,v.jsx)(ca,{value:"None",children:Z.Z.t("general:None")},"None"),(0,v.jsx)(ca,{value:"Dynamic",children:Z.Z.t("application:Dynamic")},"Dynamic"),(0,v.jsx)(ca,{value:"Always",children:Z.Z.t("application:Always")},"Always")]}):"SMS"===(null===(o=a.provider)||void 0===o?void 0:o.category)||"Email"===(null===(l=a.provider)||void 0===l?void 0:l.category)?("None"===n&&(n="All"),(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,defaultValue:"All",onChange:function(n){t.updateField(e,i,"rule",n)},children:[(0,v.jsx)(ca,{value:"all",children:"All"},"all"),(0,v.jsx)(ca,{value:"signup",children:"Signup"},"signup"),(0,v.jsx)(ca,{value:"login",children:"Login"},"login"),(0,v.jsx)(ca,{value:"forget",children:"Forget Password"},"forget"),(0,v.jsx)(ca,{value:"reset",children:"Reset Password"},"reset"),(0,v.jsx)(ca,{value:"mfaSetup",children:"Set MFA"},"mfaSetup"),(0,v.jsx)(ca,{value:"mfaAuth",children:"MFA Auth"},"mfaAuth")]})):null}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return this.props.application.enableSignUp||(n=n.filter((function(e){return"canSignUp"!==e.key}))),(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"name",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),pa=ne.Z.Option,ua=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:r.dj(e,"Please select a signin method"),displayName:"",rule:"None"};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t,n){t=r.qK(t,n),this.updateTable(t)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{name:"Password",displayName:Z.Z.t("general:Password")},{name:"Verification code",displayName:Z.Z.t("login:Verification code")},{name:"WebAuthn",displayName:Z.Z.t("login:WebAuthn")},{name:"LDAP",displayName:Z.Z.t("login:LDAP")},{name:"Face ID",displayName:Z.Z.t("login:Face ID")}],a=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",render:function(a,i,s){return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:function(e){var t=n.filter((function(t){return t.name===e}));return 0===t.length?"":t[0].displayName}(a),onChange:function(n){t.updateField(e,s,"name",n),t.updateField(e,s,"displayName",n),"Verification code"===n||"Password"===n?t.updateField(e,s,"rule","All"):t.updateField(e,s,"rule","None")},children:r.fJ(n,e,"name").map((function(e,t){return(0,v.jsx)(pa,{value:e.name,children:e.displayName},t)}))})}},{title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"300px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"displayName",n.target.value)}})}},{title:Z.Z.t("application:Rule"),dataIndex:"rule",key:"rule",width:"155px",render:function(n,a,i){var s=[];return"Verification code"===a.name?s=[{id:"All",name:Z.Z.t("general:All")},{id:"Email only",name:Z.Z.t("general:Email only")},{id:"Phone only",name:Z.Z.t("general:Phone only")}]:"Password"===a.name&&(s=[{id:"All",name:Z.Z.t("general:All")},{id:"Non-LDAP",name:Z.Z.t("general:Non-LDAP")},{id:"Hide password",name:Z.Z.t("general:Hide password")}]),0===s.length?null:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"rule",n)},options:s.map((function(e){return r.Rl(e.name,e.id)}))})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(a,i,r){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===r,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,r)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:r===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,r)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{disabled:e.length<=1,icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(n,e,r)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"name",columns:a,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",disabled:0===r.fJ(n,e,"name").length,onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),ha=ne.Z.Option,ga=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){void 0!==e&&null!==e||(e=[]),e=r.SA(e,{Name:"",nameFormat:"",value:""}),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"name",n.target.value)}})}},{title:Z.Z.t("general:Name format"),dataIndex:"nameFormat",key:"nameFormat",width:"200px",render:function(n,a,i){return(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,defaultValue:"urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified",onChange:function(n){t.updateField(e,i,"nameFormat",n)},children:[(0,v.jsx)(ha,{value:"urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified",children:"Unspecified"},"Unspecified"),(0,v.jsx)(ha,{value:"urn:oasis:names:tc:SAML:2.0:attrname-format:basic",children:"Basic"},"Basic"),(0,v.jsx)(ha,{value:"urn:oasis:names:tc:SAML:2.0:attrname-format:uri",children:"UriReference"},"UriReference"),(0,v.jsx)(ha,{value:"urn:oasis:names:tc:SAML:2.0:attrname-format:X500",children:"x500AttributeName"},"x500AttributeName")]})}},{title:Z.Z.t("webhook:Value"),dataIndex:"value",key:"value",width:"200px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"value",n.target.value)}})}},{title:Z.Z.t("general:Action"),dataIndex:"action",key:"action",width:"20px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{title:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})})},columns:n,dataSource:e,rowKey:"key",size:"middle",bordered:!0})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),ma=n(3660),xa=ne.Z.Option,Za={"Back button":".back-button {\n      top: 65px;\n      left: 15px;\n      position: absolute;\n}\n.back-inner-button{}",Languages:".login-languages {\n    top: 55px;\n    right: 5px;\n    position: absolute;\n}",Logo:".login-logo-box {}","Signin methods":".signin-methods {}",Username:".login-username {}\n.login-username-input{}",Password:".login-password {}\n.login-password-input{}",Agreement:".login-agreement {}","Forgot password?":".login-forget-password {\n    display: inline-flex;\n    justify-content: space-between;\n    width: 320px;\n    margin-bottom: 25px;\n}","Login button":".login-button-box {\n    margin-bottom: 5px;\n}\n.login-button {\n    width: 100%;\n}","Signup link":".login-signup-link {\n    margin-bottom: 24px;\n    display: flex;\n    justify-content: end;\n}",Providers:".provider-img {\n      width: 30px;\n      margin: 5px;\n}\n.provider-big-img {\n      margin-bottom: 10px;\n}"},ya=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:r.dj(e,"Please select a signin item"),visible:!0,required:!0,rule:"None"};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"addCustomRow",value:function(e){var t="Text "+Date.now().toString(),n={name:r.dj(e,t),visible:!0,isCustom:!0};void 0===e&&(e=[]),e=r.SA(e,n),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t,n=this;e=null!==(t=e)&&void 0!==t?t:[];var a=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",render:function(t,a,i){if(a.isCustom)return(0,v.jsx)(ae.Z,{style:{width:"100%"},value:t,onPressEnter:function(t){n.updateField(e,i,"name",t.target.value)},disabled:!0});var s=[{name:"Signin methods",displayName:Z.Z.t("application:Signin methods")},{name:"Logo",displayName:Z.Z.t("general:Logo")},{name:"Back button",displayName:Z.Z.t("login:Back button")},{name:"Languages",displayName:Z.Z.t("general:Languages")},{name:"Username",displayName:Z.Z.t("signup:Username")},{name:"Password",displayName:Z.Z.t("general:Password")},{name:"Providers",displayName:Z.Z.t("general:Providers")},{name:"Agreement",displayName:Z.Z.t("signup:Agreement")},{name:"Forgot password?",displayName:Z.Z.t("login:Forgot password?")},{name:"Login button",displayName:Z.Z.t("login:Signin button")},{name:"Signup link",displayName:Z.Z.t("general:Signup link")}];return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:function(e){var t=s.filter((function(t){return t.name===e}));return 0===t.length?"":t[0].displayName}(t),onChange:function(t){n.updateField(e,i,"name",t),n.updateField(e,i,"customCss",Za[t])},children:r.fJ(s,e,"name").map((function(e,t){return(0,v.jsx)(xa,{value:e.name,children:e.displayName},t)}))})}},{title:Z.Z.t("organization:Visible"),dataIndex:"visible",key:"visible",width:"120px",render:function(t,a,i){return"ID"===a.name?null:(0,v.jsx)(re.Z,{checked:t,onChange:function(t){n.updateField(e,i,"visible",t),t?n.updateField(e,i,"required",!0):n.updateField(e,i,"required",!1)}})}},{title:Z.Z.t("signup:Label"),dataIndex:"label",key:"label",width:"200px",render:function(t,a,i){return a.name.startsWith("Text ")||null!==a&&void 0!==a&&a.isCustom?(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:t,lang:"html",fillHeight:!0,dark:!0,onChange:function(t){n.updateField(e,i,"label",t)}})}),title:Z.Z.t("signup:Label HTML"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:t,style:{marginBottom:"10px"},onChange:function(t){n.updateField(e,i,"label",t.target.value)}})}):["Username","Password","Signup link","Forgot password?","Login button"].includes(a.name)?(0,v.jsx)(ae.Z,{value:t,style:{marginBottom:"10px"},onChange:function(t){n.updateField(e,i,"label",t.target.value)}}):null}},{title:Z.Z.t("application:Custom CSS"),dataIndex:"customCss",key:"customCss",width:"200px",render:function(t,a,i){return a.name.startsWith("Text ")||null!==a&&void 0!==a&&a.isCustom?null:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:null===t||void 0===t?void 0:t.replaceAll("<style>","").replaceAll("</style>",""),lang:"css",fillHeight:!0,dark:!0,onChange:function(t){n.updateField(e,i,"customCss",t)}})}),title:Z.Z.t("application:CSS style"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:null===t||void 0===t?void 0:t.replaceAll("<style>","").replaceAll("</style>",""),onChange:function(t){n.updateField(e,i,"customCss",t.target.value)}})})}},{title:Z.Z.t("signup:Placeholder"),dataIndex:"placeholder",key:"placeholder",width:"200px",render:function(t,a,i){return"Username"!==a.name&&"Password"!==a.name?null:(0,v.jsx)(ae.Z,{value:t,onChange:function(t){n.updateField(e,i,"placeholder",t.target.value)}})}},{title:Z.Z.t("application:Rule"),dataIndex:"rule",key:"rule",width:"155px",render:function(t,a,i){var s=[];return"Providers"===a.name&&(s=[{id:"big",name:Z.Z.t("application:Big icon")},{id:"small",name:Z.Z.t("application:Small icon")}]),0===s.length?null:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:t,onChange:function(t){n.updateField(e,i,"rule",t)},options:s.map((function(e){return r.Rl(e.name,e.id)}))})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(t,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return n.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return n.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return n.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},rowKey:"name",columns:a,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)(m.Z,{children:[n.props.title,(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return n.addRow(e)},children:Z.Z.t("general:Add")}),(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return n.addCustomRow(e)},children:Z.Z.t("general:Add custom item")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),fa=["_"],va=ne.Z.Option,ja="<style>\n  .login-panel {\n    padding: 40px 70px 0 70px;\n    border-radius: 10px;\n    background-color: #ffffff;\n    box-shadow: 0 0 30px 20px rgba(0, 0, 0, 0.20);\n  }\n  .login-panel-dark {\n    padding: 40px 70px 0 70px;\n    border-radius: 10px;\n    background-color: #333333;\n    box-shadow: 0 0 30px 20px rgba(255, 255, 255, 0.20);\n  }\n</style>",Ta=r.tq()?22:11,ka=r.tq()?"110%":"90%",Ca=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,owner:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,applicationName:e.match.params.applicationName,application:null,organizations:[],certs:[],providers:[],uploading:!1,mode:void 0!==e.location.mode?e.location.mode:"edit",samlAttributes:[],samlMetadata:null,isAuthorized:!0},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getApplication(),this.getOrganizations(),this.getGroups()}},{key:"getApplication",value:function(){var e=this;W.i6("admin",this.state.applicationName).then((function(t){if(null!==t.data)if("error"!==t.status){var n=t.data;null!==n.grantTypes&&void 0!==n.grantTypes&&0!==n.grantTypes.length||(n.grantTypes=["authorization_code"]),null!==n.tags&&void 0!==n.tags||(n.tags=[]),e.setState({application:n}),e.getProviders(n),e.getCerts(n),e.getSamlMetadata(n.enableSamlPostBinding)}else r.PV("error",t.msg);else e.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){"error"===t.status?e.setState({isAuthorized:!1}):e.setState({organizations:t.data||[]})}))}},{key:"getGroups",value:function(){var e=this;ce(this.state.organizationName).then((function(t){"ok"===t.status&&e.setState({groups:t.data})}))}},{key:"getCerts",value:function(e){var t=this,n=e.organization;e.isShared&&(n=this.props.owner),na(n).then((function(e){t.setState({certs:e.data||[]})}))}},{key:"getProviders",value:function(e){var t=this,n=e.organization;e.isShared&&(n=this.props.account.owner),ia.J9(n).then((function(e){"ok"===e.status?t.setState({providers:e.data}):r.PV("error",e.msg)}))}},{key:"getSamlMetadata",value:function(e){var t=this;W.JS("admin",this.state.applicationName,e).then((function(e){t.setState({samlMetadata:e})}))}},{key:"parseApplicationField",value:function(e,t){return["offset"].includes(e)&&(t=r.Js(t)),t}},{key:"updateApplicationField",value:function(e,t){t=this.parseApplicationField(e,t);var n=this.state.application;n[e]=t,this.setState({application:n})}},{key:"handleUpload",value:function(e){var t=this;if("text/html"===e.file.type){this.setState({uploading:!0});var n="termsOfUse/".concat(this.state.application.owner,"/").concat(this.state.application.name,".html");je(this.props.account.owner,this.props.account.name,"termsOfUse","ApplicationEditPage",n,e.file).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("application:File uploaded successfully")),t.updateApplicationField("termsOfUse",e.data)):r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(e.msg))})).finally((function(){t.setState({uploading:!1})}))}else r.PV("error",Z.Z.t("application:Please select a HTML file"))}},{key:"renderApplication",value:function(){var e,t,n,i,s,o,l,c,p,u,g=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("application:New Application"):Z.Z.t("application:Edit Application"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return g.submitApplicationEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return g.submitApplicationEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return g.deleteApplication()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.application.name,disabled:"app-built-in"===this.state.application.name,onChange:function(e){g.updateApplicationField("name",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.application.displayName,onChange:function(e){g.updateApplicationField("displayName",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Is shared"),Z.Z.t("general:Is shared - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(re.Z,{disabled:r.VN(),checked:this.state.application.isShared,onChange:function(e){g.updateApplicationField("isShared",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Logo"),Z.Z.t("general:Logo - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,style:r.tq()?{maxWidth:"100%"}:{},children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.logo,onChange:function(e){g.updateApplicationField("logo",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.application.logo,children:(0,v.jsx)("img",{src:this.state.application.logo,alt:this.state.application.logo,height:90,style:{marginBottom:"20px"}})})})]})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Home"),Z.Z.t("general:Home - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.homepageUrl,onChange:function(e){g.updateApplicationField("homepageUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.application.description,onChange:function(e){g.updateApplicationField("description",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.application.organization,onChange:function(e){g.updateApplicationField("organization",e)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(va,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("organization:Tags"),Z.Z.t("application:Tags - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",style:{width:"100%"},value:this.state.application.tags,onChange:function(e){g.updateApplicationField("tags",e)},children:null===(e=this.state.application.tags)||void 0===e?void 0:e.map((function(e,t){return(0,v.jsx)(va,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Client ID"),Z.Z.t("provider:Client ID - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.application.clientId,onChange:function(e){g.updateApplicationField("clientId",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Client secret"),Z.Z.t("provider:Client secret - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.application.clientSecret,onChange:function(e){g.updateApplicationField("clientSecret",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Cert"),Z.Z.t("general:Cert - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.application.cert,onChange:function(e){g.updateApplicationField("cert",e)},children:this.state.certs.map((function(e,t){return(0,v.jsx)(va,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Redirect URLs"),Z.Z.t("application:Redirect URLs - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(oa,{title:Z.Z.t("application:Redirect URLs"),table:this.state.application.redirectUris,onUpdateTable:function(e){g.updateApplicationField("redirectUris",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Token format"),Z.Z.t("application:Token format - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.application.tokenFormat,onChange:function(e){g.updateApplicationField("tokenFormat",e)},options:["JWT","JWT-Empty","JWT-Custom","JWT-Standard"].map((function(e){return r.Rl(e,e)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Token signing method"),Z.Z.t("application:Token signing method - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:""===this.state.application.tokenSigningMethod?"RS256":this.state.application.tokenSigningMethod,onChange:function(e){g.updateApplicationField("tokenSigningMethod",e)},options:["RS256","RS512","ES256","ES512","ES384"].map((function(e){return r.Rl(e,e)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Token fields"),Z.Z.t("application:Token fields - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:"JWT-Custom"!==this.state.application.tokenFormat,mode:"tags",showSearch:!0,style:{width:"100%"},value:this.state.application.tokenFields,onChange:function(e){g.updateApplicationField("tokenFields",e)},children:r.iE().map((function(e,t){return(0,v.jsx)(va,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Token expire"),Z.Z.t("application:Token expire - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{style:{width:"150px"},value:this.state.application.expireInHours,min:1,step:1,precision:0,addonAfter:"Hours",onChange:function(e){g.updateApplicationField("expireInHours",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Refresh token expire"),Z.Z.t("application:Refresh token expire - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{style:{width:"150px"},value:this.state.application.refreshExpireInHours,min:1,step:1,precision:0,addonAfter:"Hours",onChange:function(e){g.updateApplicationField("refreshExpireInHours",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Failed signin limit"),Z.Z.t("application:Failed signin limit - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{style:{width:"150px"},value:this.state.application.failedSigninLimit,min:1,step:1,precision:0,addonAfter:"Times",onChange:function(e){g.updateApplicationField("failedSigninLimit",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Failed signin frozen time"),Z.Z.t("application:Failed signin frozen time - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{style:{width:"150px"},value:this.state.application.failedSigninFrozenTime,min:1,step:1,precision:0,addonAfter:"Minutes",onChange:function(e){g.updateApplicationField("failedSigninFrozenTime",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("ldap:Default group"),Z.Z.t("ldap:Default group - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:null!==(t=this.state.application.defaultGroup)&&void 0!==t?t:[],onChange:function(e){g.updateApplicationField("defaultGroup",e)},children:[(0,v.jsx)(va,{value:"",children:(0,v.jsx)(m.Z,{children:Z.Z.t("general:Default")})},""),null===(n=this.state.groups)||void 0===n?void 0:n.map((function(e){return(0,v.jsx)(va,{value:"".concat(e.owner,"/").concat(e.name),children:(0,v.jsxs)(m.Z,{children:["Physical"===e.type?(0,v.jsx)(_e.Z,{}):(0,v.jsx)($e.Z,{}),e.displayName]})},e.name)}))]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Enable signup"),Z.Z.t("application:Enable signup - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableSignUp,onChange:function(e){g.updateApplicationField("enableSignUp",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Signin session"),Z.Z.t("application:Enable signin session - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableSigninSession,onChange:function(e){e||g.updateApplicationField("enableAutoSignin",!1),g.updateApplicationField("enableSigninSession",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Auto signin"),Z.Z.t("application:Auto signin - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableAutoSignin,onChange:function(e){g.state.application.enableSigninSession||!e?g.updateApplicationField("enableAutoSignin",e):r.PV("error",Z.Z.t('application:Please enable "Signin session" first before enabling "Auto signin"'))}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Enable Email linking"),Z.Z.t("application:Enable Email linking - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableLinkWithEmail,onChange:function(e){g.updateApplicationField("enableLinkWithEmail",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Signin methods"),Z.Z.t("application:Signin methods - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ua,{title:Z.Z.t("application:Signin methods"),table:this.state.application.signinMethods,onUpdateTable:function(e){g.updateApplicationField("signinMethods",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Org choice mode"),Z.Z.t("application:Org choice mode - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},options:[{label:Z.Z.t("general:None"),value:"None"},{label:Z.Z.t("application:Select"),value:"Select"},{label:Z.Z.t("application:Input"),value:"Input"}].map((function(e){return r.Rl(e.label,e.value)})),value:null!==(i=this.state.application.orgChoiceMode)&&void 0!==i?i:[],onChange:function(e){g.updateApplicationField("orgChoiceMode",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Signup URL"),Z.Z.t("general:Signup URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.signupUrl,onChange:function(e){g.updateApplicationField("signupUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Signin URL"),Z.Z.t("general:Signin URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.signinUrl,onChange:function(e){g.updateApplicationField("signinUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Forget URL"),Z.Z.t("general:Forget URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.forgetUrl,onChange:function(e){g.updateApplicationField("forgetUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Affiliation URL"),Z.Z.t("general:Affiliation URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.affiliationUrl,onChange:function(e){g.updateApplicationField("affiliationUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:IP whitelist"),Z.Z.t("general:IP whitelist - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{placeholder:null===(s=this.state.application.organizationObj)||void 0===s?void 0:s.ipWhitelist,value:this.state.application.ipWhitelist,onChange:function(e){g.updateApplicationField("ipWhitelist",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("signup:Terms of Use"),Z.Z.t("signup:Terms of Use - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.termsOfUse,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("termsOfUse",e.target.value)}}),(0,v.jsx)(Tn.Z,{maxCount:1,accept:".html",showUploadList:!1,beforeUpload:function(e){return!1},onChange:function(e){g.handleUpload(e)},children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(kn.Z,{}),loading:this.state.uploading,children:Z.Z.t("general:Click to Upload")})})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Signup HTML"),Z.Z.t("provider:Signup HTML - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:this.state.application.signupHtml,lang:"html",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("signupHtml",e)}})}),title:Z.Z.t("provider:Signup HTML - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.signupHtml,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("signupHtml",e.target.value)}})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Signin HTML"),Z.Z.t("provider:Signin HTML - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:this.state.application.signinHtml,lang:"html",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("signinHtml",e)}})}),title:Z.Z.t("provider:Signin HTML - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.signinHtml,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("signinHtml",e.target.value)}})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Grant types"),Z.Z.t("application:Grant types - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.application.grantTypes,onChange:function(e){g.updateApplicationField("grantTypes",e)},children:[{id:"authorization_code",name:"Authorization Code"},{id:"password",name:"Password"},{id:"client_credentials",name:"Client Credentials"},{id:"token",name:"Token"},{id:"id_token",name:"ID Token"},{id:"refresh_token",name:"Refresh Token"}].map((function(e,t){return(0,v.jsx)(va,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:SAML reply URL"),Z.Z.t("application:Redirect URL (Assertion Consumer Service POST Binding URL) - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.samlReplyUrl,onChange:function(e){g.updateApplicationField("samlReplyUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Enable SAML compression"),Z.Z.t("application:Enable SAML compression - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableSamlCompress,onChange:function(e){g.updateApplicationField("enableSamlCompress",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Enable SAML C14N10"),Z.Z.t("application:Enable SAML C14N10 - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableSamlC14n10,onChange:function(e){g.updateApplicationField("enableSamlC14n10",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Use Email as NameID"),Z.Z.t("application:Use Email as NameID - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.useEmailAsSamlNameId,onChange:function(e){g.updateApplicationField("useEmailAsSamlNameId",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("application:Enable SAML POST binding"),Z.Z.t("application:Enable SAML POST binding - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.application.enableSamlPostBinding,onChange:function(e){g.updateApplicationField("enableSamlPostBinding",e),g.getSamlMetadata(e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:SAML attributes"),Z.Z.t("general:SAML attributes - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ga,{title:Z.Z.t("general:SAML attributes"),table:this.state.application.samlAttributes,application:this.state.application,onUpdateTable:function(e){g.updateApplicationField("samlAttributes",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:SAML metadata"),Z.Z.t("application:SAML metadata - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsx)(Jn,{value:null!==(o=null===(l=this.state.samlMetadata)||void 0===l?void 0:l.toString())&&void 0!==o?o:"",lang:"xml",readOnly:!0}),(0,v.jsx)("br",{}),(0,v.jsx)(d.ZP,{style:{marginBottom:"10px"},type:"primary",shape:"round",icon:(0,v.jsx)(ta.Z,{}),onClick:function(){ot()("".concat(window.location.origin,"/api/saml/metadata?application=admin/").concat(encodeURIComponent(g.state.applicationName),"&enablePostBinding=").concat(g.state.application.enableSamlPostBinding)),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("application:Copy SAML metadata URL")})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Providers"),Z.Z.t("general:Providers - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(da,{title:Z.Z.t("general:Providers"),table:this.state.application.providers,providers:this.state.providers,application:this.state.application,onUpdateTable:function(e){g.updateApplicationField("providers",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Preview"),Z.Z.t("general:Preview - Tooltip"))," :"]}),this.renderSignupSigninPreview()]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Background URL"),Z.Z.t("application:Background URL - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,style:r.tq()?{maxWidth:"100%"}:{},children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.formBackgroundUrl,onChange:function(e){g.updateApplicationField("formBackgroundUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.application.formBackgroundUrl,children:(0,v.jsx)("img",{src:this.state.application.formBackgroundUrl,alt:this.state.application.formBackgroundUrl,height:90,style:{marginBottom:"20px"}})})})]})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Background URL Mobile"),Z.Z.t("application:Background URL Mobile - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,style:r.tq()?{maxWidth:"100%"}:{},children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.application.formBackgroundUrlMobile,onChange:function(e){g.updateApplicationField("formBackgroundUrlMobile",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.application.formBackgroundUrlMobile,children:(0,v.jsx)("img",{src:this.state.application.formBackgroundUrlMobile,alt:this.state.application.formBackgroundUrlMobile,height:90,style:{marginBottom:"20px"}})})})]})]})]}),(0,v.jsxs)(R.Z,{children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Custom CSS"),Z.Z.t("application:Custom CSS - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:""===this.state.application.formCss?ja:this.state.application.formCss,lang:"css",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("formCss",e)}})}),title:Z.Z.t("application:Custom CSS - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.formCss,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("formCss",e.target.value)}})})})]}),(0,v.jsxs)(R.Z,{children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Custom CSS Mobile"),Z.Z.t("application:Custom CSS Mobile - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:""===this.state.application.formCssMobile?ja:this.state.application.formCssMobile,lang:"css",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("formCssMobile",e)}})}),title:Z.Z.t("application:Custom CSS Mobile - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.formCssMobile,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("formCssMobile",e.target.value)}})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Form position"),Z.Z.t("application:Form position - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsxs)(bt.ZP.Group,{buttonStyle:"solid",onChange:function(e){g.updateApplicationField("formOffset",e.target.value)},value:this.state.application.formOffset,children:[(0,v.jsx)(bt.ZP.Button,{value:1,children:Z.Z.t("application:Left")}),(0,v.jsx)(bt.ZP.Button,{value:2,children:Z.Z.t("application:Center")}),(0,v.jsx)(bt.ZP.Button,{value:3,children:Z.Z.t("application:Right")}),(0,v.jsx)(bt.ZP.Button,{value:4,children:Z.Z.t("application:Enable side panel")})]})}),4===this.state.application.formOffset?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:3,children:[r.id(Z.Z.t("application:Side panel HTML"),Z.Z.t("application:Side panel HTML - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:""===this.state.application.formSideHtml?'<style>\n  .left-model{\n    text-align: center;\n    padding: 30px;\n    background-color: #8ca0ed;\n    position: absolute;\n    transform: none;\n    width: 100%;\n    height: 100%;\n  }\n  .side-logo{\n    display: flex;\n    align-items: center;\n  }\n  .side-logo span {\n    font-family: Montserrat, sans-serif;\n    font-weight: 900;\n    font-size: 2.4rem;\n    line-height: 1.3;\n    margin-left: 16px;\n    color: #404040;\n  }\n  .img{\n    max-width: none;\n    margin: 41px 0 13px;\n  }\n</style>\n<div class="left-model">\n  <span class="side-logo"> <img src="https://cdn.casbin.org/img/casdoor-logo_1185x256.png" alt="Casdoor" style="width: 120px"> \n    <span>SSO</span> \n  </span>\n  <div class="img">\n    <img src="https://cdn.casbin.org/img/casbin.svg" alt="Casdoor"/>\n  </div>\n</div>\n':this.state.application.formSideHtml,lang:"html",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("formSideHtml",e)}})}),title:Z.Z.t("application:Side panel HTML - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.formSideHtml,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("formSideHtml",e.target.value)}})})})]}):null]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("theme:Theme"),Z.Z.t("theme:Theme - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,style:{marginTop:"5px"},children:[(0,v.jsx)(R.Z,{children:(0,v.jsxs)(bt.ZP.Group,{buttonStyle:"solid",value:null!==(c=null===(p=this.state.application.themeData)||void 0===p?void 0:p.isEnabled)&&void 0!==c&&c,onChange:function(e){var t,n=null!==(t=g.state.application.themeData)&&void 0!==t?t:(0,a.Z)((0,a.Z)({},At.Cm),{},{isEnabled:!1}),i=(n._,(0,Ct.Z)(n,fa));g.updateApplicationField("themeData",(0,a.Z)((0,a.Z)({},i),{},{isEnabled:e.target.value}))},children:[(0,v.jsx)(bt.ZP.Button,{value:!1,children:Z.Z.t("application:Follow organization theme")}),(0,v.jsx)(bt.ZP.Button,{value:!0,children:Z.Z.t("theme:Customize theme")})]})}),null!==(u=this.state.application.themeData)&&void 0!==u&&u.isEnabled?(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(cn,{themeData:this.state.application.themeData,onThemeChange:function(e,t){var n,i=(null!==(n=g.state.application.themeData)&&void 0!==n?n:(0,a.Z)((0,a.Z)({},At.Cm),{},{isEnabled:!1})).isEnabled;g.updateApplicationField("themeData",(0,a.Z)((0,a.Z)({},t),{},{isEnabled:i}))}})}):null]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Header HTML"),Z.Z.t("application:Header HTML - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:this.state.application.headerHtml,lang:"html",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("headerHtml",e)}})}),title:Z.Z.t("application:Header HTML - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.headerHtml,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("headerHtml",e.target.value)}})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Footer HTML"),Z.Z.t("application:Footer HTML - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(at.Z,{placement:"right",content:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:this.state.application.footerHtml,lang:"html",fillHeight:!0,dark:!0,onChange:function(e){g.updateApplicationField("footerHtml",e)}})}),title:Z.Z.t("application:Footer HTML - Edit"),trigger:"click",children:(0,v.jsx)(ae.Z,{value:this.state.application.footerHtml,style:{marginBottom:"10px"},onChange:function(e){g.updateApplicationField("footerHtml",e.target.value)}})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2}),(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},onClick:function(){return g.updateApplicationField("footerHtml",r.n6())},children:Z.Z.t("provider:Reset to Default HTML")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},onClick:function(){return g.updateApplicationField("footerHtml",r.MW())},children:Z.Z.t("application:Reset to Empty")})]}),(0,v.jsx)(y.Fragment,{children:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Signin items"),Z.Z.t("application:Signin items - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ya,{title:Z.Z.t("application:Signin items"),table:this.state.application.signinItems,themeAlgorithm:this.state.themeAlgorithm,onUpdateTable:function(e){g.updateApplicationField("signinItems",e)}})})]})}),this.state.application.enableSignUp?(0,v.jsx)(y.Fragment,{children:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Signup items"),Z.Z.t("application:Signup items - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Yn,{title:Z.Z.t("application:Signup items"),table:this.state.application.signupItems,onUpdateTable:function(e){g.updateApplicationField("signupItems",e)}})})]})}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Preview"),Z.Z.t("general:Preview - Tooltip"))," :"]}),this.renderPromptPreview()]})]})}},{key:"renderSignupSigninPreview",value:function(){var e,t,n,i,s,o,l=null!==(e=this.state.application.themeData)&&void 0!==e?e:At.Cm,c="/signup/".concat(this.state.application.name);o=(null===(t=this.state.application.redirectUris)||void 0===t?void 0:t.length)>0?this.state.application.redirectUris[0]:"\"ERROR: You must specify at least one Redirect URL in 'Redirect URLs'\"";var p=this.state.application.clientId;this.state.application.isShared&&(p+="-org-".concat(this.props.account.owner));var u="/login/oauth/authorize?client_id=".concat(p,"&response_type=code&redirect_uri=").concat(o,"&scope=read&state=casdoor"),h={position:"absolute",top:"0px",left:"0px",zIndex:10,height:"97%",width:"100%",background:"rgba(0,0,0,0.4)"};return r.e_(this.state.application)||(c=u.replace("/login/oauth/authorize","/signup/oauth/authorize")),(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(L.Z,{span:Ta,children:[(0,v.jsx)(d.ZP,{style:{marginBottom:"10px"},type:"primary",shape:"round",icon:(0,v.jsx)(ta.Z,{}),onClick:function(){ot()("".concat(window.location.origin).concat(c)),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("application:Copy signup page URL")}),(0,v.jsx)("br",{}),(0,v.jsx)(Et.ZP,{theme:{token:{colorPrimary:l.colorPrimary,colorInfo:l.colorPrimary,borderRadius:l.borderRadius}},children:(0,v.jsxs)("div",{style:{position:"relative",width:ka,border:"1px solid rgb(217,217,217)",boxShadow:"10px 10px 5px #888888",overflow:"auto"},children:[r.e_(this.state.application)?(0,v.jsx)("div",{className:"loginBackground",style:{backgroundImage:"url(".concat(null===(n=this.state.application)||void 0===n?void 0:n.formBackgroundUrl,")"),overflow:"auto"},children:(0,v.jsx)(ra.Z,{application:this.state.application,preview:"auto"})}):(0,v.jsx)("div",{className:"loginBackground",style:{backgroundImage:"url(".concat(null===(i=this.state.application)||void 0===i?void 0:i.formBackgroundUrl,")"),overflow:"auto"},children:(0,v.jsx)(sa.Z,{type:"login",mode:"signup",application:this.state.application,preview:"auto"})}),(0,v.jsx)("div",{style:(0,a.Z)({overflow:"auto"},h)})]})})]}),(0,v.jsxs)(L.Z,{span:Ta,children:[(0,v.jsx)(d.ZP,{style:{marginBottom:"10px",marginTop:r.tq()?"15px":"0"},type:"primary",shape:"round",icon:(0,v.jsx)(ta.Z,{}),onClick:function(){ot()("".concat(window.location.origin).concat(u)),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("application:Copy signin page URL")}),(0,v.jsx)("br",{}),(0,v.jsx)(Et.ZP,{theme:{token:{colorPrimary:l.colorPrimary,colorInfo:l.colorPrimary,borderRadius:l.borderRadius}},children:(0,v.jsxs)("div",{style:{position:"relative",width:ka,border:"1px solid rgb(217,217,217)",boxShadow:"10px 10px 5px #888888",overflow:"auto"},children:[(0,v.jsx)("div",{className:"loginBackground",style:{backgroundImage:"url(".concat(null===(s=this.state.application)||void 0===s?void 0:s.formBackgroundUrl,")"),overflow:"auto"},children:(0,v.jsx)(sa.Z,{type:"login",mode:"signin",application:this.state.application,preview:"auto"})}),(0,v.jsx)("div",{style:(0,a.Z)({overflow:"auto"},h)})]})})]})]})}},{key:"renderPromptPreview",value:function(){var e,t=null!==(e=this.state.application.themeData)&&void 0!==e?e:At.Cm,n="/prompt/".concat(this.state.application.name);return(0,v.jsxs)(L.Z,{span:Ta,children:[(0,v.jsx)(d.ZP,{style:{marginBottom:"10px"},type:"primary",shape:"round",icon:(0,v.jsx)(ta.Z,{}),onClick:function(){ot()("".concat(window.location.origin).concat(n)),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("application:Copy prompt page URL")}),(0,v.jsx)("br",{}),(0,v.jsx)(Et.ZP,{theme:{token:{colorPrimary:t.colorPrimary,colorInfo:t.colorPrimary,borderRadius:t.borderRadius}},children:(0,v.jsxs)("div",{style:{position:"relative",width:ka,border:"1px solid rgb(217,217,217)",boxShadow:"10px 10px 5px #888888",flexDirection:"column",flex:"auto"},children:[(0,v.jsx)(ma.Z,{application:this.state.application,account:this.props.account}),(0,v.jsx)("div",{style:{position:"absolute",top:"0px",left:"0px",zIndex:10,height:"100%",width:"100%",background:"rgba(0,0,0,0.4)"}})]})})]})}},{key:"submitApplicationEdit",value:function(e){var t,n,a=this,i=r.p$(this.state.application);i.providers=null===(t=i.providers)||void 0===t?void 0:t.filter((function(e){return a.state.providers.map((function(e){return e.name})).includes(e.name)})),i.signinMethods=null===(n=i.signinMethods)||void 0===n?void 0:n.filter((function(e){return["Password","Verification code","WebAuthn","LDAP","Face ID"].includes(e.name)})),W.li("admin",this.state.applicationName,i).then((function(t){"ok"===t.status?(r.PV("success",Z.Z.t("general:Successfully saved")),a.setState({applicationName:a.state.application.name}),e?a.props.history.push("/applications"):a.props.history.push("/applications/".concat(a.state.application.organization,"/").concat(a.state.application.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(t.msg)),a.updateApplicationField("name",a.state.applicationName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteApplication",value:function(){var e=this;W.rw(this.state.application).then((function(t){"ok"===t.status?e.props.history.push("/applications"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return this.state.isAuthorized?(0,v.jsxs)("div",{children:[null!==this.state.application?this.renderApplication():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitApplicationEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitApplicationEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteApplication()},children:Z.Z.t("general:Cancel")}):null]})]}):(0,v.jsx)(c.ZP,{status:"403",title:"403 Unauthorized",subTitle:Z.Z.t("general:Sorry, you do not have permission to access this page or logged in status invalid."),extra:(0,v.jsx)("a",{href:"/",children:(0,v.jsx)(d.ZP,{type:"primary",children:Z.Z.t("general:Back Home")})})})}}]),n}(y.Component),ba=Ca,Sa=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i;return(0,G.Z)(this,n),(i=t.call(this,e)).fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.searchedColumn,n=e.searchText,s=e.sortField,o=e.sortOrder;void 0!==e.category&&null!==e.category?(t="category",n=e.category):void 0!==e.type&&null!==e.type&&(t="type",n=e.type),i.setState({loading:!0}),(r.Qy(i.props.account)?ia.G(e.pagination.current,e.pagination.pageSize,t,n,s,o):ia.J9(r.jb(i.props.account),e.pagination.current,e.pagination.pageSize,t,n,s,o)).then((function(t){i.setState({loading:!1}),"ok"===t.status?i.setState({data:t.data,pagination:(0,a.Z)((0,a.Z)({},e.pagination),{},{total:t.data2}),searchText:e.searchText,searchedColumn:e.searchedColumn}):r.Ai(t)?i.setState({isAuthorized:!1}):r.PV("error",t.msg)}))},i}return(0,J.Z)(n,[{key:"componentDidMount",value:function(){(0,vn.Z)((0,jn.Z)(n.prototype),"componentDidMount",this).call(this),this.setState({owner:r.VN(this.props.account)?"admin":this.props.account.owner})}},{key:"newProvider",value:function(){var e=r.VO();return{owner:r.Qy(this.props.account)?this.state.owner:r.jb(this.props.account),name:"provider_".concat(e),createdTime:Fe()().format(),displayName:"New Provider - ".concat(e),category:"OAuth",type:"GitHub",method:"Normal",clientId:"",clientSecret:"",enableSignUp:!0,host:"",port:0,providerUrl:"https://github.com/organizations/xxx/settings/applications/1234567"}}},{key:"addProvider",value:function(){var e=this,t=this.newProvider();ia.Az(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/providers/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteProvider",value:function(e){var t=this;ia.dm(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"120px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/providers/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"150px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return"admin"!==e?e:Z.Z.t("provider:admin (Shared)")}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"180px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("provider:Category"),dataIndex:"category",key:"category",filterMultiple:!1,filters:[{text:"Captcha",value:"Captcha"},{text:"Email",value:"Email"},{text:"Notification",value:"Notification"},{text:"OAuth",value:"OAuth"},{text:"Payment",value:"Payment"},{text:"SAML",value:"SAML"},{text:"SMS",value:"SMS"},{text:"Storage",value:"Storage"},{text:"Web3",value:"Web3"}],width:"110px",sorter:!0},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"110px",align:"center",filterMultiple:!1,filters:[{text:"Captcha",value:"Captcha",children:r.oz("Captcha").map((function(e){return{text:e.id,value:e.name}}))},{text:"Email",value:"Email",children:r.oz("Email").map((function(e){return{text:e.id,value:e.name}}))},{text:"Notification",value:"Notification",children:r.oz("Notification").map((function(e){return{text:e.id,value:e.name}}))},{text:"OAuth",value:"OAuth",children:r.oz("OAuth").map((function(e){return{text:e.id,value:e.name}}))},{text:"Payment",value:"Payment",children:r.oz("Payment").map((function(e){return{text:e.id,value:e.name}}))},{text:"SAML",value:"SAML",children:r.oz("SAML").map((function(e){return{text:e.id,value:e.name}}))},{text:"SMS",value:"SMS",children:r.oz("SMS").map((function(e){return{text:e.id,value:e.name}}))},{text:"Storage",value:"Storage",children:r.oz("Storage").map((function(e){return{text:e.id,value:e.name}}))},{text:"Web3",value:"Web3",children:r.oz("Web3").map((function(e){return{text:e.id,value:e.name}}))}],sorter:!0,render:function(e,t,n){return la.Il(t)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("provider:Client ID"),dataIndex:"clientId",key:"clientId",width:"100px",sorter:!0},this.getColumnSearchProps("clientId")),{},{render:function(e,t,n){return r.xu(e)}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("provider:Provider URL"),dataIndex:"providerUrl",key:"providerUrl",width:"150px",sorter:!0},this.getColumnSearchProps("providerUrl")),{},{render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:r.xu(e)})}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{disabled:!r.VN(t.props.account)&&n.owner!==t.props.account.owner,style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/providers/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteProvider(a)},disabled:!r.VN(t.props.account)&&n.owner!==t.props.account.owner})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Providers"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{id:"add-button",type:"primary",size:"small",onClick:t.addProvider.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),wa=Sa,Pa=n(31283),Aa=n(89131);function Ia(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={title:e.title,content:e.content,sender:e.displayName,receivers:""===t?["TestSmtpServer"]:[t],provider:e.name,providerObject:e};return fetch("".concat(r.nn,"/api/send-email"),{method:"POST",credentials:"include",body:JSON.stringify(n)}).then((function(e){return e.json()}))}function Fa(e){(function(e,t){var n={content:e};return fetch("".concat(r.nn,"/api/send-notification?provider=").concat(t),{method:"POST",credentials:"include",body:JSON.stringify(n)}).then((function(e){return e.json()}))})(e.content,e.name).then((function(e){"ok"===e.status?r.PV("success",Z.Z.t("general:Successfully sent")):r.PV("error",e.msg)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}function za(e,t){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={content:"123456",receivers:[t]};return fetch("".concat(r.nn,"/api/send-sms?provider=")+e.name,{method:"POST",credentials:"include",body:JSON.stringify(n)}).then((function(e){return e.json()}))})(e,t).then((function(e){"ok"===e.status?r.PV("success",Z.Z.t("general:Successfully sent")):r.PV("error",e.msg)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}var Na=n(77908),Ua=function(e){var t=e.owner,n=e.name,a=e.provider,r=e.captchaType,s=e.subType,o=e.clientId,l=e.clientSecret,c=e.clientId2,p=e.clientSecret2,u=e.providerUrl,h=y.useState(!1),g=(0,i.Z)(h,2),m=g[0],x=g[1];return(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(d.ZP,{style:{fontSize:14},type:"primary",onClick:function(){a.name=n,a.clientId=o,a.type=r,a.providerUrl=u,"***"!==l?(a.clientSecret=l,x(!0)):x(!0)},disabled:function(){if("Default"!==r){if(!o||!l)return!0;if("Aliyun Captcha"===r&&(!s||!c||!p))return!0}return!1}(),children:Z.Z.t("general:Preview")}),(0,v.jsx)(Na.M,{owner:t,name:n,visible:m,onOk:function(e,a,i){ue.verifyCaptcha(t,n,e,a,i).then((function(){x(!1)}))},onCancel:function(){x(!1)},isCurrentProvider:!0})]})},Ea=n(97578),Ra=ne.Z.Option,La=ae.Z.TextArea,Oa={id:"id",username:"username",displayName:"displayName",email:"email",avatarUrl:"avatarUrl"},Va=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,providerName:e.match.params.providerName,owner:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,provider:null,certs:[],organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getOrganizations(),this.getProvider(),this.getCerts(this.state.owner)}},{key:"getProvider",value:function(){var e=this;ia.VH(this.state.owner,this.state.providerName).then((function(t){if(null!==t.data)if("ok"===t.status){var n=t.data;n.userMapping=n.userMapping||Oa,e.setState({provider:n})}else r.PV("error",t.msg);else e.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;r.VN(this.props.account)&&he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getCerts",value:function(e){var t=this;na(e).then((function(e){"ok"===e.status&&t.setState({certs:e.data||[]})}))}},{key:"parseProviderField",value:function(e,t){return["port"].includes(e)&&(t=r.Js(t)),t}},{key:"updateProviderField",value:function(e,t){t=this.parseProviderField(e,t);var n=this.state.provider;"owner"===e&&n.owner!==t&&(n.cert="",this.getCerts(t)),n[e]=t,"WeChat"===n.type&&(n.clientId||(n.signName="media",n.disableSsl=!0),n.clientId2||(n.signName="open",n.disableSsl=!1),n.disableSsl||(n.signName="open")),this.setState({provider:n})}},{key:"updateUserMappingField",value:function(e,t){var n=this.state.provider;""===t&&["id","username","displayName"].includes(e)?r.PV("error",Z.Z.t("provider:This field is required")):(n.userMapping[e]=t,this.setState({provider:n}))}},{key:"renderUserMappingInput",value:function(){var e=this;return(0,v.jsxs)(y.Fragment,{children:[r.id(Z.Z.t("general:ID"),Z.Z.t("general:ID - Tooltip"))," :",(0,v.jsx)(ae.Z,{value:this.state.provider.userMapping.id,onChange:function(t){e.updateUserMappingField("id",t.target.value)}}),r.id(Z.Z.t("signup:Username"),Z.Z.t("signup:Username - Tooltip"))," :",(0,v.jsx)(ae.Z,{value:this.state.provider.userMapping.username,onChange:function(t){e.updateUserMappingField("username",t.target.value)}}),r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :",(0,v.jsx)(ae.Z,{value:this.state.provider.userMapping.displayName,onChange:function(t){e.updateUserMappingField("displayName",t.target.value)}}),r.id(Z.Z.t("general:Email"),Z.Z.t("general:Email - Tooltip"))," :",(0,v.jsx)(ae.Z,{value:this.state.provider.userMapping.email,onChange:function(t){e.updateUserMappingField("email",t.target.value)}}),r.id(Z.Z.t("general:Avatar"),Z.Z.t("general:Avatar - Tooltip"))," :",(0,v.jsx)(ae.Z,{value:this.state.provider.userMapping.avatarUrl,onChange:function(t){e.updateUserMappingField("avatarUrl",t.target.value)}})]})}},{key:"getClientIdLabel",value:function(e){switch(e.category){case"OAuth":return"Apple"===e.type?r.id(Z.Z.t("provider:Service ID identifier"),Z.Z.t("provider:Service ID identifier - Tooltip")):r.id(Z.Z.t("provider:Client ID"),Z.Z.t("provider:Client ID - Tooltip"));case"Email":return r.id(Z.Z.t("signup:Username"),Z.Z.t("signup:Username - Tooltip"));case"SMS":return"Volc Engine SMS"===e.type||"Amazon SNS"===e.type||"Baidu Cloud SMS"===e.type?r.id(Z.Z.t("provider:Access key"),Z.Z.t("provider:Access key - Tooltip")):"Huawei Cloud SMS"===e.type?r.id(Z.Z.t("provider:App key"),Z.Z.t("provider:App key - Tooltip")):"UCloud SMS"===e.type?r.id(Z.Z.t("provider:Public key"),Z.Z.t("provider:Public key - Tooltip")):"Msg91 SMS"===e.type||"Infobip SMS"===e.type||"OSON SMS"===e.type?r.id(Z.Z.t("provider:Sender Id"),Z.Z.t("provider:Sender Id - Tooltip")):r.id(Z.Z.t("provider:Client ID"),Z.Z.t("provider:Client ID - Tooltip"));case"Captcha":return"Aliyun Captcha"===e.type?r.id(Z.Z.t("provider:Access key"),Z.Z.t("provider:Access key - Tooltip")):r.id(Z.Z.t("provider:Site key"),Z.Z.t("provider:Site key - Tooltip"));case"Notification":return"DingTalk"===e.type?r.id(Z.Z.t("provider:Access key"),Z.Z.t("provider:Access key - Tooltip")):r.id(Z.Z.t("provider:Client ID"),Z.Z.t("provider:Client ID - Tooltip"));default:return r.id(Z.Z.t("provider:Client ID"),Z.Z.t("provider:Client ID - Tooltip"))}}},{key:"getClientSecretLabel",value:function(e){switch(e.category){case"OAuth":return"Apple"===e.type?r.id(Z.Z.t("provider:Team ID"),Z.Z.t("provider:Team ID - Tooltip")):r.id(Z.Z.t("provider:Client secret"),Z.Z.t("provider:Client secret - Tooltip"));case"Storage":return"Google Cloud Storage"===e.type?r.id(Z.Z.t("provider:Service account JSON"),Z.Z.t("provider:Service account JSON - Tooltip")):r.id(Z.Z.t("provider:Client secret"),Z.Z.t("provider:Client secret - Tooltip"));case"Email":return"Azure ACS"===e.type||"SendGrid"===e.type?r.id(Z.Z.t("provider:Secret key"),Z.Z.t("provider:Secret key - Tooltip")):r.id(Z.Z.t("general:Password"),Z.Z.t("general:Password - Tooltip"));case"SMS":return"Volc Engine SMS"===e.type||"Amazon SNS"===e.type||"Baidu Cloud SMS"===e.type||"OSON SMS"===e.type?r.id(Z.Z.t("provider:Secret access key"),Z.Z.t("provider:Secret access key - Tooltip")):"Huawei Cloud SMS"===e.type?r.id(Z.Z.t("provider:App secret"),Z.Z.t("provider:AppSecret - Tooltip")):"UCloud SMS"===e.type?r.id(Z.Z.t("provider:Private Key"),Z.Z.t("provider:Private Key - Tooltip")):"Msg91 SMS"===e.type?r.id(Z.Z.t("provider:Auth Key"),Z.Z.t("provider:Auth Key - Tooltip")):"Infobip SMS"===e.type?r.id(Z.Z.t("provider:Api Key"),Z.Z.t("provider:Api Key - Tooltip")):r.id(Z.Z.t("provider:Client secret"),Z.Z.t("provider:Client secret - Tooltip"));case"Captcha":return"Aliyun Captcha"===e.type?r.id(Z.Z.t("provider:Secret access key"),Z.Z.t("provider:Secret access key - Tooltip")):r.id(Z.Z.t("provider:Secret key"),Z.Z.t("provider:Secret key - Tooltip"));case"Notification":return"Line"===e.type||"Telegram"===e.type||"Bark"===e.type||"DingTalk"===e.type||"Discord"===e.type||"Slack"===e.type||"Pushover"===e.type||"Pushbullet"===e.type?r.id(Z.Z.t("provider:Secret key"),Z.Z.t("provider:Secret key - Tooltip")):"Lark"===e.type||"Microsoft Teams"===e.type?r.id(Z.Z.t("provider:Endpoint"),Z.Z.t("provider:Endpoint - Tooltip")):r.id(Z.Z.t("provider:Client secret"),Z.Z.t("provider:Client secret - Tooltip"));default:return r.id(Z.Z.t("provider:Client secret"),Z.Z.t("provider:Client secret - Tooltip"))}}},{key:"getClientId2Label",value:function(e){switch(e.category){case"OAuth":return"Apple"===e.type?r.id(Z.Z.t("provider:Key ID"),Z.Z.t("provider:Key ID - Tooltip")):r.id(Z.Z.t("provider:Client ID 2"),Z.Z.t("provider:Client ID 2 - Tooltip"));case"Email":return r.id(Z.Z.t("provider:From address"),Z.Z.t("provider:From address - Tooltip"));default:return"Aliyun Captcha"===e.type?r.id(Z.Z.t("provider:Scene"),Z.Z.t("provider:Scene - Tooltip")):"WeChat Pay"===e.type?r.id(Z.Z.t("provider:App ID"),Z.Z.t("provider:App ID - Tooltip")):"CUCloud"===e.type?r.id(Z.Z.t("provider:Account ID"),Z.Z.t("provider:Account ID - Tooltip")):r.id(Z.Z.t("provider:Client ID 2"),Z.Z.t("provider:Client ID 2 - Tooltip"))}}},{key:"getClientSecret2Label",value:function(e){switch(e.category){case"OAuth":return"Apple"===e.type?r.id(Z.Z.t("provider:Key text"),Z.Z.t("provider:Key text - Tooltip")):r.id(Z.Z.t("provider:Client secret 2"),Z.Z.t("provider:Client secret 2 - Tooltip"));case"Email":return r.id(Z.Z.t("provider:From name"),Z.Z.t("provider:From name - Tooltip"));default:return"Aliyun Captcha"===e.type?r.id(Z.Z.t("provider:App key"),Z.Z.t("provider:App key - Tooltip")):r.id(Z.Z.t("provider:Client secret 2"),Z.Z.t("provider:Client secret 2 - Tooltip"))}}},{key:"getProviderSubTypeOptions",value:function(e){return"WeCom"===e||"Infoflow"===e?[{id:"Internal",name:Z.Z.t("provider:Internal")},{id:"Third-party",name:Z.Z.t("provider:Third-party")}]:"Aliyun Captcha"===e?[{id:"nc",name:Z.Z.t("provider:Sliding Validation")},{id:"ic",name:Z.Z.t("provider:Intelligent Validation")}]:[]}},{key:"getAppIdRow",value:function(e){var t=this,n="",a="";return"OAuth"===e.category?"WeCom"===e.type&&"Internal"===e.subType||"Infoflow"===e.type?(n=Z.Z.t("provider:Agent ID"),a=Z.Z.t("provider:Agent ID - Tooltip")):"AzureADB2C"===e.type&&(n=Z.Z.t("provider:User flow"),a=Z.Z.t("provider:User flow - Tooltip")):"SMS"===e.category?"Twilio SMS"===e.type||"Azure ACS"===e.type?(n=Z.Z.t("provider:Sender number"),a=Z.Z.t("provider:Sender number - Tooltip")):"Tencent Cloud SMS"===e.type?(n=Z.Z.t("provider:App ID"),a=Z.Z.t("provider:App ID - Tooltip")):"Volc Engine SMS"===e.type?(n=Z.Z.t("provider:SMS account"),a=Z.Z.t("provider:SMS account - Tooltip")):"Huawei Cloud SMS"===e.type?(n=Z.Z.t("provider:Channel No."),a=Z.Z.t("provider:Channel No. - Tooltip")):"Amazon SNS"===e.type?(n=Z.Z.t("provider:Region"),a=Z.Z.t("provider:Region - Tooltip")):"Baidu Cloud SMS"===e.type?(n=Z.Z.t("provider:Endpoint"),a=Z.Z.t("provider:Endpoint - Tooltip")):"Infobip SMS"===e.type?(n=Z.Z.t("provider:Base URL"),a=Z.Z.t("provider:Base URL - Tooltip")):"UCloud SMS"===e.type&&(n=Z.Z.t("provider:Project Id"),a=Z.Z.t("provider:Project Id - Tooltip")):"Email"===e.category?"SUBMAIL"===e.type&&(n=Z.Z.t("provider:App ID"),a=Z.Z.t("provider:App ID - Tooltip")):"Notification"===e.category&&("Viber"===e.type?(n=Z.Z.t("provider:Domain"),a=Z.Z.t("provider:Domain - Tooltip")):"Line"===e.type||"Matrix"===e.type||"Rocket Chat"===e.type?(n=Z.Z.t("provider:App Key"),a=Z.Z.t("provider:App Key - Tooltip")):"CUCloud"===e.type&&(n=Z.Z.t("provider:Topic name"),a=Z.Z.t("provider:Topic name - Tooltip"))),""===n&&""===a?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(n,a)," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:e.appId,onChange:function(e){t.updateProviderField("appId",e.target.value)}})})]})}},{key:"getReceiverRow",value:function(e){var t=this,n="",a="";return"Telegram"===e.type||"Pushover"===e.type||"Pushbullet"===e.type||"Slack"===e.type||"Discord"===e.type||"Line"===e.type||"Twitter"===e.type||"Reddit"===e.type||"Rocket Chat"===e.type||"Viber"===e.type?(n=Z.Z.t("provider:Chat ID"),a=Z.Z.t("provider:Chat ID - Tooltip")):"Custom HTTP"!==e.type&&"Webpush"!==e.type&&"Matrix"!==e.type||(n=Z.Z.t("provider:Endpoint"),a=Z.Z.t("provider:Endpoint - Tooltip")),""===n&&""===a?(0,v.jsx)(y.Fragment,{children:(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id("Test Notification","Test Notification")," :"]})}):(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(n,a)," :"]}),(0,v.jsx)(L.Z,{span:6,children:(0,v.jsx)(ae.Z,{value:e.receiver,onChange:function(e){t.updateProviderField("receiver",e.target.value)}})})]})}},{key:"loadSamlConfiguration",value:function(){var e=new DOMParser,t=this.state.provider.metadata.replace("\n",""),n=e.parseFromString(t,"text/xml"),a=n.querySelector("X509Certificate").childNodes[0].nodeValue.replace(" ",""),i=n.querySelector("SingleSignOnService").getAttribute("Location"),r=n.querySelector("EntityDescriptor").getAttribute("entityID");this.updateProviderField("idP",a),this.updateProviderField("endpoint",i),this.updateProviderField("issuerUrl",r)}},{key:"fetchSamlMetadata",value:function(){var e=this;this.setState({metadataLoading:!0}),fetch(this.state.requestUrl,{method:"GET"}).then((function(e){return e.ok?e.text():Promise.reject("error")})).then((function(t){e.updateProviderField("metadata",t),e.parseSamlMetadata(),r.PV("success",Z.Z.t("general:Successfully added"))})).catch((function(e){r.PV("error",e.message)})).finally((function(){e.setState({metadataLoading:!1})}))}},{key:"parseSamlMetadata",value:function(){try{this.loadSamlConfiguration(),r.PV("success",Z.Z.t("provider:Parse metadata successfully"))}catch(e){r.PV("error",Z.Z.t("provider:Can not parse metadata"))}}},{key:"renderProvider",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("provider:New Provider"):Z.Z.t("provider:Edit Provider"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitProviderEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitProviderEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteProvider()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.name,onChange:function(t){e.updateProviderField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.displayName,onChange:function(t){e.updateProviderField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.provider.owner,onChange:function(t){e.updateProviderField("owner",t)},children:[r.VN(this.props.account)?(0,v.jsx)(Ra,{value:"admin",children:Z.Z.t("provider:admin (Shared)")},"admin"):null,this.state.organizations.map((function(e,t){return(0,v.jsx)(Ra,{value:e.name,children:e.name},t)}))]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Category"),Z.Z.t("provider:Category - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.category,onChange:function(t){e.updateProviderField("category",t),"OAuth"===t?e.updateProviderField("type","Google"):"Email"===t?(e.updateProviderField("type","Default"),e.updateProviderField("host","smtp.example.com"),e.updateProviderField("port",465),e.updateProviderField("disableSsl",!1),e.updateProviderField("title","Casdoor Verification Code"),e.updateProviderField("content",r.BQ()),e.updateProviderField("receiver",e.props.account.email)):"SMS"===t?e.updateProviderField("type","Twilio SMS"):"Storage"===t?e.updateProviderField("type","AWS S3"):"SAML"===t?e.updateProviderField("type","Keycloak"):"Payment"===t?e.updateProviderField("type","PayPal"):"Captcha"===t?e.updateProviderField("type","Default"):"Web3"===t?e.updateProviderField("type","MetaMask"):"Notification"===t&&e.updateProviderField("type","Telegram")},children:[{id:"Captcha",name:"Captcha"},{id:"Email",name:"Email"},{id:"Notification",name:"Notification"},{id:"OAuth",name:"OAuth"},{id:"Payment",name:"Payment"},{id:"SAML",name:"SAML"},{id:"SMS",name:"SMS"},{id:"Storage",name:"Storage"},{id:"Web3",name:"Web3"}].sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e,t){return(0,v.jsx)(Ra,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Type"),Z.Z.t("provider:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},showSearch:!0,value:this.state.provider.type,onChange:function(t){e.updateProviderField("type",t),"Local File System"===t?e.updateProviderField("domain",r.nd()):"Custom"===t&&"OAuth"===e.state.provider.category?(e.updateProviderField("customAuthUrl","https://door.casdoor.com/login/oauth/authorize"),e.updateProviderField("scopes","openid profile email"),e.updateProviderField("customTokenUrl","https://door.casdoor.com/api/login/oauth/access_token"),e.updateProviderField("customUserInfoUrl","https://door.casdoor.com/api/userinfo")):"Custom HTTP SMS"===t?(e.updateProviderField("endpoint","https://example.com/send-custom-http-sms"),e.updateProviderField("method","GET"),e.updateProviderField("title","code")):"Custom HTTP Email"===t?(e.updateProviderField("endpoint","https://example.com/send-custom-http-email"),e.updateProviderField("method","POST")):"Custom HTTP"===t&&(e.updateProviderField("method","GET"),e.updateProviderField("title",""))},children:r.oz(this.state.provider.category).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(t,n){return(0,v.jsxs)(Ra,{value:t.id,children:[(0,v.jsx)("img",{width:20,height:20,style:{marginBottom:"3px",marginRight:"10px"},src:r.Oi({category:e.state.provider.category,type:t.id}),alt:t.id}),t.name]},n)}))})})]}),"WeCom"!==this.state.provider.type&&"Infoflow"!==this.state.provider.type&&"Aliyun Captcha"!==this.state.provider.type?null:(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("provider:Sub type"),Z.Z.t("provider:Sub type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.subType,onChange:function(t){e.updateProviderField("subType",t)},children:this.getProviderSubTypeOptions(this.state.provider.type).map((function(e,t){return(0,v.jsx)(Ra,{value:e.id,children:e.name},t)}))})})]}),"WeCom"!==this.state.provider.type?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("general:Method"),Z.Z.t("provider:Method - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.method,onChange:function(t){e.updateProviderField("method",t)},children:[{id:"Normal",name:Z.Z.t("provider:Normal")},{id:"Silent",name:Z.Z.t("provider:Silent")}].map((function(e,t){return(0,v.jsx)(Ra,{value:e.id,children:e.name},t)}))})})]})]}),"OAuth"===this.state.provider.category?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Email regex"),Z.Z.t("provider:Email regex - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(La,{rows:4,value:this.state.provider.emailRegex,onChange:function(t){e.updateProviderField("emailRegex",t.target.value)}})})]}):null,"Custom"===this.state.provider.type?(0,v.jsxs)(y.Fragment,{children:["OAuth"===this.state.provider.category?(0,v.jsxs)(L.Z,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("provider:Auth URL"),Z.Z.t("provider:Auth URL - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.customAuthUrl,onChange:function(t){e.updateProviderField("customAuthUrl",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("provider:Token URL"),Z.Z.t("provider:Token URL - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.customTokenUrl,onChange:function(t){e.updateProviderField("customTokenUrl",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("provider:Scope"),Z.Z.t("provider:Scope - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.scopes,onChange:function(t){e.updateProviderField("scopes",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("provider:UserInfo URL"),Z.Z.t("provider:UserInfo URL - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.customUserInfoUrl,onChange:function(t){e.updateProviderField("customUserInfoUrl",t.target.value)}})})]})]}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:User mapping"),Z.Z.t("provider:User mapping - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:this.renderUserMappingInput()})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Favicon"),Z.Z.t("general:Favicon - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.customLogo,onChange:function(t){e.updateProviderField("customLogo",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.provider.customLogo,children:(0,v.jsx)("img",{src:this.state.provider.customLogo,alt:this.state.provider.customLogo,height:90,style:{marginBottom:"20px"}})})})]})]})]})]}):null,"Captcha"===this.state.provider.category&&"Default"===this.state.provider.type||"Web3"===this.state.provider.category||"Storage"===this.state.provider.category&&"Local File System"===this.state.provider.type||"SMS"===this.state.provider.category&&"Custom HTTP SMS"===this.state.provider.type||"Notification"===this.state.provider.category&&("Google Chat"===this.state.provider.type||"Custom HTTP"===this.state.provider.type)||"Balance"===this.state.provider.type?null:(0,v.jsxs)(y.Fragment,{children:["Storage"===this.state.provider.category&&"Google Cloud Storage"===this.state.provider.type||"Email"===this.state.provider.category&&("Azure ACS"===this.state.provider.type||"SendGrid"===this.state.provider.type)||"Notification"===this.state.provider.category&&("Line"===this.state.provider.type||"Telegram"===this.state.provider.type||"Bark"===this.state.provider.type||"Discord"===this.state.provider.type||"Slack"===this.state.provider.type||"Pushbullet"===this.state.provider.type||"Pushover"===this.state.provider.type||"Lark"===this.state.provider.type||"Microsoft Teams"===this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[this.getClientIdLabel(this.state.provider)," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.clientId,onChange:function(t){e.updateProviderField("clientId",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[this.getClientSecretLabel(this.state.provider)," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.clientSecret,onChange:function(t){e.updateProviderField("clientSecret",t.target.value)}})})]})]}),"Email"!==this.state.provider.category&&"WeChat"!==this.state.provider.type&&"Apple"!==this.state.provider.type&&"Aliyun Captcha"!==this.state.provider.type&&"WeChat Pay"!==this.state.provider.type&&"Twitter"!==this.state.provider.type&&"Reddit"!==this.state.provider.type&&"CUCloud"!==this.state.provider.type?null:(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[this.getClientId2Label(this.state.provider)," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.clientId2,onChange:function(t){e.updateProviderField("clientId2",t.target.value)}})})]}),"WeChat Pay"===this.state.provider.type||"CUCloud"===this.state.provider.type||"Email"===this.state.provider.category&&"Azure ACS"===this.state.provider.type?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[this.getClientSecret2Label(this.state.provider)," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.clientSecret2,onChange:function(t){e.updateProviderField("clientSecret2",t.target.value)}})})]})]}),"WeChat"!==this.state.provider.type?null:(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Use WeChat Media Platform in PC"),Z.Z.t("provider:Use WeChat Media Platform in PC - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{disabled:!this.state.provider.clientId,checked:this.state.provider.disableSsl,onChange:function(t){e.updateProviderField("disableSsl",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("token:Access token"),Z.Z.t("token:Access token - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.content,disabled:!this.state.provider.disableSsl||!this.state.provider.clientId2,onChange:function(t){e.updateProviderField("content",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Follow-up action"),Z.Z.t("provider:Follow-up action - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{children:(0,v.jsxs)(bt.ZP.Group,{value:this.state.provider.signName,disabled:!this.state.provider.disableSsl||!this.state.provider.clientId||!this.state.provider.clientId2,buttonStyle:"solid",onChange:function(t){e.updateProviderField("signName",t.target.value)},children:[(0,v.jsx)(bt.ZP.Button,{value:"open",children:Z.Z.t("provider:Use WeChat Open Platform to login")}),(0,v.jsx)(bt.ZP.Button,{value:"media",children:Z.Z.t("provider:Use WeChat Media Platform to login")})]})})]})]}),"Google"!==this.state.provider.type?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Get phone number"),Z.Z.t("provider:Get phone number - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{disabled:!this.state.provider.clientId,checked:this.state.provider.disableSsl,onChange:function(t){e.updateProviderField("disableSsl",t)}})})]}),"ADFS"!==this.state.provider.type&&"AzureAD"!==this.state.provider.type&&"AzureADB2C"!==this.state.provider.type&&"Casdoor"!==this.state.provider.type&&"Storage"!==this.state.category&&"Okta"!==this.state.provider.type?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("provider:Domain"),Z.Z.t("provider:Domain - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.domain,onChange:function(t){e.updateProviderField("domain",t.target.value)}})})]}),"Storage"===this.state.provider.category||["Custom HTTP SMS","Custom HTTP Email","SendGrid","CUCloud"].includes(this.state.provider.type)?(0,v.jsxs)("div",{children:[["Local File System","CUCloud"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("provider:Endpoint"),Z.Z.t("provider:Region endpoint for Internet"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.endpoint,onChange:function(t){e.updateProviderField("endpoint",t.target.value)}})})]}),["Custom HTTP SMS","SendGrid","Local File System","MinIO","Tencent Cloud COS","Google Cloud Storage","Qiniu Cloud Kodo","Synology","Casdoor","CUCloud"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("provider:Endpoint (Intranet)"),Z.Z.t("provider:Region endpoint for Intranet"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.intranetEndpoint,onChange:function(t){e.updateProviderField("intranetEndpoint",t.target.value)}})})]}),["Custom HTTP SMS","SendGrid","Local File System","CUCloud"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[["Casdoor"].includes(this.state.provider.type)?r.id(Z.Z.t("general:Provider"),Z.Z.t("provider:Provider - Tooltip")):r.id(Z.Z.t("provider:Bucket"),Z.Z.t("provider:Bucket - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.bucket,onChange:function(t){e.updateProviderField("bucket",t.target.value)}})})]}),["Custom HTTP SMS","SendGrid","CUCloud"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("provider:Path prefix"),Z.Z.t("provider:Path prefix - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.pathPrefix,onChange:function(t){e.updateProviderField("pathPrefix",t.target.value)}})})]}),["Custom HTTP SMS","SendGrid","Synology","Casdoor","CUCloud"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("provider:Domain"),Z.Z.t("provider:Domain - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.domain,disabled:"Local File System"===this.state.provider.type,onChange:function(t){e.updateProviderField("domain",t.target.value)}})})]}),["Casdoor"].includes(this.state.provider.type)?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.content,onChange:function(t){e.updateProviderField("content",t.target.value)}})})]}):null,["AWS S3","Tencent Cloud COS","Qiniu Cloud Kodo","Casdoor","CUCloud OSS","MinIO","CUCloud"].includes(this.state.provider.type)?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[["Casdoor"].includes(this.state.provider.type)?r.id(Z.Z.t("general:Application"),Z.Z.t("general:Application - Tooltip")):r.id(Z.Z.t("provider:Region ID"),Z.Z.t("provider:Region ID - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.regionId,onChange:function(t){e.updateProviderField("regionId",t.target.value)}})})]}):null]}):null,this.getAppIdRow(this.state.provider),"Notification"===this.state.provider.category?(0,v.jsxs)(y.Fragment,{children:[["Custom HTTP"].includes(this.state.provider.type)?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("general:Method"),Z.Z.t("provider:Method - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.method,onChange:function(t){e.updateProviderField("method",t)},children:[{id:"GET",name:"GET"},{id:"POST",name:"POST"}].map((function(e,t){return(0,v.jsx)(Ra,{value:e.id,children:e.name},t)}))})})]}):null,["Custom HTTP","CUCloud"].includes(this.state.provider.type)?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Parameter"),Z.Z.t("provider:Parameter - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.title,onChange:function(t){e.updateProviderField("title",t.target.value)}})})]}):null,["Google Chat","CUCloud"].includes(this.state.provider.type)?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Metadata"),Z.Z.t("provider:Metadata - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(La,{rows:4,value:this.state.provider.metadata,onChange:function(t){e.updateProviderField("metadata",t.target.value)}})})]}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Content"),Z.Z.t("provider:Content - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(La,{autoSize:{minRows:3,maxRows:100},value:this.state.provider.content,onChange:function(t){e.updateProviderField("content",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[this.getReceiverRow(this.state.provider),(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},type:"primary",onClick:function(){return Fa(e.state.provider,e.state.provider.receiver)},children:Z.Z.t("provider:Send Testing Notification")})]})]}):"Email"===this.state.provider.category?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Host"),Z.Z.t("provider:Host - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.host,onChange:function(t){e.updateProviderField("host",t.target.value)}})})]}),["Azure ACS","SendGrid"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Port"),Z.Z.t("provider:Port - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.provider.port,onChange:function(t){e.updateProviderField("port",t)}})})]}),["Azure ACS","SendGrid"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Disable SSL"),Z.Z.t("provider:Disable SSL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.provider.disableSsl,onChange:function(t){e.updateProviderField("disableSsl",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Email title"),Z.Z.t("provider:Email title - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.title,onChange:function(t){e.updateProviderField("title",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Email content"),Z.Z.t("provider:Email content - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},onClick:function(){return e.updateProviderField("content","You have requested a verification code at Casdoor. Here is your code: %s, please enter in 5 minutes.")},children:Z.Z.t("provider:Reset to Default Text")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},type:"primary",onClick:function(){return e.updateProviderField("content",r.BQ())},children:Z.Z.t("provider:Reset to Default HTML")})]}),(0,v.jsxs)(R.Z,{children:[(0,v.jsx)(L.Z,{span:r.tq()?22:11,children:(0,v.jsx)("div",{style:{height:"300px",margin:"10px"},children:(0,v.jsx)(Jn,{value:this.state.provider.content,fillHeight:!0,dark:!0,lang:"html",onChange:function(t){e.updateProviderField("content",t)}})})}),(0,v.jsx)(L.Z,{span:1}),(0,v.jsx)(L.Z,{span:r.tq()?22:11,children:(0,v.jsx)("div",{style:{margin:"10px"},children:(0,v.jsx)("div",{dangerouslySetInnerHTML:{__html:this.state.provider.content.replace("%s","123456").replace("%{user.friendlyName}",r.RR(this.props.account))}})})})]})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Test Email"),Z.Z.t("provider:Test Email - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:4,children:(0,v.jsx)(ae.Z,{value:this.state.provider.receiver,placeholder:Z.Z.t("user:Input your email"),onChange:function(t){e.updateProviderField("receiver",t.target.value)}})}),["Azure ACS","SendGrid"].includes(this.state.provider.type)?null:(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},onClick:function(){Ia(e.state.provider).then((function(e){"ok"===e.status?r.PV("success",Z.Z.t("provider:SMTP connected successfully")):r.PV("error",e.msg)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))},children:Z.Z.t("provider:Test SMTP Connection")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},type:"primary",disabled:!r.vV(this.state.provider.receiver),onClick:function(){return t=e.state.provider,n=e.state.provider.receiver,void Ia(t,n).then((function(e){"ok"===e.status?r.PV("success",Z.Z.t("general:Successfully sent")):r.PV("error",e.msg)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}));var t,n},children:Z.Z.t("provider:Send Testing Email")})]})]}):"SMS"===this.state.provider.category?(0,v.jsxs)(y.Fragment,{children:[["Custom HTTP SMS","Twilio SMS","Amazon SNS","Azure ACS","Msg91 SMS","Infobip SMS"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Sign Name"),Z.Z.t("provider:Sign Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.signName,onChange:function(t){e.updateProviderField("signName",t.target.value)}})})]}),["Infobip SMS"].includes(this.state.provider.type)?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Template code"),Z.Z.t("provider:Template code - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.templateCode,onChange:function(t){e.updateProviderField("templateCode",t.target.value)}})})]}),["Custom HTTP SMS","Custom HTTP Email"].includes(this.state.provider.type)?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:2,children:[r.id(Z.Z.t("general:Method"),Z.Z.t("provider:Method - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.method,onChange:function(t){e.updateProviderField("method",t)},children:[{id:"GET",name:"GET"},{id:"POST",name:"POST"}].map((function(e,t){return(0,v.jsx)(Ra,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Parameter"),Z.Z.t("provider:Parameter - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.title,onChange:function(t){e.updateProviderField("title",t.target.value)}})})]})]}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:SMS Test"),Z.Z.t("provider:SMS Test - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:4,children:(0,v.jsxs)(ae.Z.Group,{compact:!0,children:[(0,v.jsx)(Je.l,{style:{width:"90px"},initValue:this.state.provider.content,onChange:function(t){e.updateProviderField("content",t)},countryCodes:this.props.account.organization.countryCodes}),(0,v.jsx)(ae.Z,{value:this.state.provider.receiver,style:{width:"150px"},placeholder:Z.Z.t("user:Input your phone number"),onChange:function(t){e.updateProviderField("receiver",t.target.value)}})]})}),(0,v.jsx)(L.Z,{span:2,children:(0,v.jsx)(d.ZP,{style:{marginLeft:"10px",marginBottom:"5px"},type:"primary",disabled:!r.kj(this.state.provider.receiver)&&("Custom HTTP SMS"!==this.state.provider.type||""===this.state.provider.endpoint),onClick:function(){return za(e.state.provider,"+"+r.so(e.state.provider.content)+e.state.provider.receiver)},children:Z.Z.t("provider:Send Testing SMS")})})]})]}):"SAML"===this.state.provider.category?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Sign request"),Z.Z.t("provider:Sign request - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(re.Z,{checked:this.state.provider.enableSignAuthnRequest,onChange:function(t){e.updateProviderField("enableSignAuthnRequest",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Metadata url"),Z.Z.t("provider:Metadata url - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:6,children:(0,v.jsx)(ae.Z,{value:this.state.requestUrl,onChange:function(t){e.setState({requestUrl:t.target.value})}})}),(0,v.jsx)(L.Z,{span:16,children:(0,v.jsx)(d.ZP,{type:"primary",loading:this.state.metadataLoading,onClick:function(){e.fetchSamlMetadata()},children:Z.Z.t("general:Request")})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Metadata"),Z.Z.t("provider:Metadata - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(La,{rows:4,value:this.state.provider.metadata,onChange:function(t){e.updateProviderField("metadata",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:2}),(0,v.jsx)(L.Z,{span:2,children:(0,v.jsx)(d.ZP,{type:"primary",onClick:function(){e.parseSamlMetadata()},children:Z.Z.t("provider:Parse")})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Endpoint"),Z.Z.t("provider:SAML 2.0 Endpoint (HTTP)"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.endpoint,onChange:function(t){e.updateProviderField("endpoint",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:IdP"),Z.Z.t("provider:IdP certificate"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.idP,onChange:function(t){e.updateProviderField("idP",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Issuer URL"),Z.Z.t("provider:Issuer URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.provider.issuerUrl,onChange:function(t){e.updateProviderField("issuerUrl",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:SP ACS URL"),Z.Z.t("provider:SP ACS URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:"".concat(Aa.a.serverUrl,"/api/acs"),readOnly:"readonly"})}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(d.ZP,{type:"primary",onClick:function(){ot()("".concat(Aa.a.serverUrl,"/api/acs")),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("provider:Copy")})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:SP Entity ID"),Z.Z.t("provider:SP ACS URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:"".concat(Aa.a.serverUrl,"/api/acs"),readOnly:"readonly"})}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(d.ZP,{type:"primary",onClick:function(){ot()("".concat(Aa.a.serverUrl,"/api/acs")),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("provider:Copy")})})]})]}):null,"Alipay"===this.state.provider.type||"WeChat Pay"===this.state.provider.type||"Casdoor"===this.state.provider.type?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Cert"),Z.Z.t("general:Cert - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.cert,onChange:function(t){e.updateProviderField("cert",t)},children:this.state.certs.map((function(e,t){return(0,v.jsx)(Ra,{value:e.name,children:e.name},t)}))})})]}):null,"Alipay"===this.state.provider.type?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Root cert"),Z.Z.t("general:Root cert - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.provider.metadata,onChange:function(t){e.updateProviderField("metadata",t)},children:this.state.certs.map((function(e,t){return(0,v.jsx)(Ra,{value:e.name,children:e.name},t)}))})})]}):null,"Web3Onboard"===this.state.provider.type?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Wallets"),Z.Z.t("provider:Wallets - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Pa.Z.Group,{options:Ea.getWeb3OnboardWalletsOptions(),value:function(){try{return JSON.parse(e.state.provider.metadata)}catch(t){return["injected"]}},onChange:function(t){e.updateProviderField("metadata",JSON.stringify(t))}})})]}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Provider URL"),Z.Z.t("provider:Provider URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.provider.providerUrl,onChange:function(t){e.updateProviderField("providerUrl",t.target.value)}})})]}),"Captcha"!==this.state.provider.category?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Preview"),Z.Z.t("general:Preview - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Ua,{owner:this.state.provider.owner,name:this.state.provider.name,provider:this.state.provider,providerName:this.state.providerName,captchaType:this.state.provider.type,subType:this.state.provider.subType,clientId:this.state.provider.clientId,clientSecret:this.state.provider.clientSecret,clientId2:this.state.provider.clientId2,clientSecret2:this.state.provider.clientSecret2,providerUrl:this.state.provider.providerUrl})})]})]})}},{key:"submitProviderEdit",value:function(e){var t=this,n=r.p$(this.state.provider);ia.P0(this.state.owner,this.state.providerName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({owner:t.state.provider.owner,providerName:t.state.provider.name}),e?t.props.history.push("/providers"):t.props.history.push("/providers/".concat(t.state.provider.owner,"/").concat(t.state.provider.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateProviderField("name",t.state.providerName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteProvider",value:function(){var e=this;ia.dm(this.state.provider).then((function(t){"ok"===t.status?e.props.history.push("/providers"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.provider?this.renderProvider():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitProviderEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitProviderEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteProvider()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),qa=Va,Da=n(63061);var Ma=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).getEditorMaxWidth=function(){return r.tq()?window.innerWidth-60:475},e.jsonStrFormatter=function(e){try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return console.error(t),e}},e.getDetailField=function(t){var n,a;return e.state.detailRecord&&null!==(n=null===(a=e.state.detailRecord)||void 0===a?void 0:a[t])&&void 0!==n?n:""},e.fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.method&&null!==t.method&&(n="method",i=t.method),e.setState({loading:!0}),function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-records?organizationName=").concat(e,"&pageSize=").concat(n,"&p=").concat(t,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn,detailShow:!1,detailRecord:null}):n.data.includes("Please login first")&&e.setState({loading:!1,isAuthorized:!1})}))},e}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.state.pagination.pageSize=20;var e=this.state.pagination;this.fetch({pagination:e})}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"320px",sorter:!0},this.getColumnSearchProps("name")),(0,a.Z)({title:Z.Z.t("general:ID"),dataIndex:"id",key:"id",width:"90px",sorter:!0},this.getColumnSearchProps("id")),(0,a.Z)({title:Z.Z.t("general:Client IP"),dataIndex:"clientIp",key:"clientIp",width:"120px",sorter:!0},this.getColumnSearchProps("clientIp",(function(e,t){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://db-ip.com/".concat(e.text),children:t})}))),{title:Z.Z.t("general:Timestamp"),dataIndex:"createdTime",key:"createdTime",width:"150px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"organization",key:"organization",width:"110px",sorter:!0},this.getColumnSearchProps("organization")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"100px",sorter:!0},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.organization,"/").concat(t.user),children:e})}}),{title:Z.Z.t("general:Method"),dataIndex:"method",key:"method",width:"100px",sorter:!0,filterMultiple:!1,filters:["GET","HEAD","POST","PUT","DELETE","CONNECT","OPTIONS","TRACE","PATCH"].map((function(e){return{text:e,value:e}}))},(0,a.Z)({title:Z.Z.t("general:Request URI"),dataIndex:"requestUri",key:"requestUri",width:"200px",sorter:!0,ellipsis:{showTitle:!1}},this.getColumnSearchProps("requestUri",(function(e,t){return(0,v.jsx)(l.Z,{placement:"topLeft",title:e.text,children:t})}))),(0,a.Z)({title:Z.Z.t("user:Language"),dataIndex:"language",key:"language",width:"90px",sorter:!0},this.getColumnSearchProps("language")),(0,a.Z)({title:Z.Z.t("record:Status code"),dataIndex:"statusCode",key:"statusCode",width:"120px",sorter:!0},this.getColumnSearchProps("statusCode")),(0,a.Z)({title:Z.Z.t("record:Response"),dataIndex:"response",key:"response",width:"220px",sorter:!0,ellipsis:{showTitle:!1}},this.getColumnSearchProps("response",(function(e,t){return(0,v.jsx)(l.Z,{placement:"topLeft",title:e.text,children:t})}))),(0,a.Z)({title:Z.Z.t("record:Object"),dataIndex:"object",key:"object",width:"200px",sorter:!0,ellipsis:{showTitle:!1}},this.getColumnSearchProps("object")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Action"),dataIndex:"action",key:"action",width:"200px",sorter:!0},this.getColumnSearchProps("action")),{},{fixed:r.tq()?"false":"right",render:function(e,t,n){return e}}),{title:Z.Z.t("record:Is triggered"),dataIndex:"isTriggered",key:"isTriggered",width:"120px",sorter:!0,fixed:r.tq()?"false":"right",render:function(e,t,n){return["signup","login","logout","update-user","new-user"].includes(t.action)?(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e}):null}},{title:Z.Z.t("general:Action"),dataIndex:"action",key:"action",width:"80px",sorter:!0,fixed:"right",render:function(e,n,a){return(0,v.jsx)(d.ZP,{type:"link",onClick:function(){t.setState({detailRecord:n,detailShow:!0})},children:Z.Z.t("general:Detail")})}}];r.$J(this.props.account)&&(n=n.filter((function(e){return"name"!==e.key})));var i={total:this.state.pagination.total,pageSize:this.state.pagination.pageSize,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsxs)("div",{children:[(0,v.jsx)(Ee.Z,{scroll:{x:"100%"},columns:n,dataSource:e,rowKey:"id",size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Records"),"\xa0\xa0\xa0\xa0"]})},loading:this.state.loading,onChange:this.handleTableChange}),(0,v.jsx)(p.Z,{title:Z.Z.t("general:Detail"),width:r.tq()?"100%":640,placement:"right",destroyOnClose:!0,onClose:function(){return t.setState({detailShow:!1})},open:this.state.detailShow,children:(0,v.jsxs)(Da.Z,{bordered:!0,size:"small",column:1,layout:r.tq()?"vertical":"horizontal",style:{padding:"12px",height:"100%",overflowY:"auto"},children:[(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:ID"),children:this.getDetailField("id")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:Client IP"),children:this.getDetailField("clientIp")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:Timestamp"),children:this.getDetailField("createdTime")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:Organization"),children:(0,v.jsx)(T.rU,{to:"/organizations/".concat(this.getDetailField("organization")),children:this.getDetailField("organization")})}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:User"),children:(0,v.jsx)(T.rU,{to:"/users/".concat(this.getDetailField("organization"),"/").concat(this.getDetailField("user")),children:this.getDetailField("user")})}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:Method"),children:this.getDetailField("method")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:Request URI"),children:this.getDetailField("requestUri")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("user:Language"),children:this.getDetailField("language")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("record:Status code"),children:this.getDetailField("statusCode")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("general:Action"),children:this.getDetailField("action")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("record:Response"),children:(0,v.jsx)(Jn,{value:this.getDetailField("response"),fillHeight:!0,fillWidth:!0,maxWidth:this.getEditorMaxWidth(),dark:!0,readOnly:!0})}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("record:Object"),children:(0,v.jsx)(Jn,{value:this.jsonStrFormatter(this.getDetailField("object")),lang:"json",fillHeight:!0,fillWidth:!0,maxWidth:this.getEditorMaxWidth(),dark:!0,readOnly:!0})})]})})]})}}]),n}(jt),Ba=Ma,Wa=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i;return(0,G.Z)(this,n),(i=t.call(this,e)).fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.searchedColumn,n=e.searchText,s=e.sortField,o=e.sortOrder;i.setState({loading:!0}),ve(r.Qy(i.props.account)?"":r.jb(i.props.account),i.props.account.name,e.pagination.current,e.pagination.pageSize,t,n,s,o).then((function(t){i.setState({loading:!1}),"ok"===t.status?i.setState({data:t.data,pagination:(0,a.Z)((0,a.Z)({},e.pagination),{},{total:t.data2}),searchText:e.searchText,searchedColumn:e.searchedColumn}):t.data.includes("Please login first")&&i.setState({loading:!1,isAuthorized:!1})}))},i}return(0,J.Z)(n,[{key:"componentDidMount",value:function(){this.setState({fileList:[],uploading:!1})}},{key:"deleteResource",value:function(e){var t=this;(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=r.p$(e);return fetch("".concat(r.nn,"/api/delete-resource?provider=").concat(t),{method:"POST",credentials:"include",body:JSON.stringify(n),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"handleUpload",value:function(e){var t=this;this.setState({uploading:!0});var n=e.fileList[0].name,a="resource/".concat(this.props.account.owner,"/").concat(this.props.account.name,"/").concat(n);je(this.props.account.owner,this.props.account.name,"custom","ResourceListPage",a,e.file).then((function(e){if("ok"===e.status){r.PV("success",Z.Z.t("application:File uploaded successfully"));var n=t.state.pagination;t.fetch({pagination:n})}else r.PV("error",e.msg)})).finally((function(){t.setState({uploading:!1})}))}},{key:"renderUpload",value:function(){var e=this;return(0,v.jsx)(Tn.Z,{maxCount:1,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.csv,.xls,.xlsx",showUploadList:!1,beforeUpload:function(e){return!1},onChange:function(t){e.handleUpload(t)},children:(0,v.jsx)(d.ZP,{id:"upload-button",icon:(0,v.jsx)(kn.Z,{}),loading:this.state.uploading,type:"primary",size:"small",children:Z.Z.t("resource:Upload a file...")})})}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Provider"),dataIndex:"provider",key:"provider",width:"150px",sorter:!0},this.getColumnSearchProps("provider")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/providers/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Application"),dataIndex:"application",key:"application",width:"80px",sorter:!0},this.getColumnSearchProps("application")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"80px",sorter:!0},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(t.user),children:e})}}),(0,a.Z)({title:Z.Z.t("resource:Parent"),dataIndex:"parent",key:"parent",width:"80px",sorter:!0},this.getColumnSearchProps("parent")),(0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",sorter:!0},this.getColumnSearchProps("name")),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"150px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("user:Tag"),dataIndex:"tag",key:"tag",width:"80px",sorter:!0},this.getColumnSearchProps("tag")),(0,a.Z)({title:Z.Z.t("provider:Type"),dataIndex:"fileType",key:"fileType",width:"80px",sorter:!0},this.getColumnSearchProps("fileType")),(0,a.Z)({title:Z.Z.t("resource:Format"),dataIndex:"fileFormat",key:"fileFormat",width:"80px",sorter:!0},this.getColumnSearchProps("fileFormat")),{title:Z.Z.t("resource:File size"),dataIndex:"fileSize",key:"fileSize",width:"100px",sorter:!0,render:function(e,t,n){return r.iO(e)}},{title:Z.Z.t("general:Preview"),dataIndex:"preview",key:"preview",width:"100px",fixed:r.tq()?"false":"right",render:function(e,t,n){if("image"===t.fileType){return(0,v.jsx)(nt.Z,{width:200,src:t.url,fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg=="})}if("video"===t.fileType)return(0,v.jsx)("video",{width:200,controls:!0,children:(0,v.jsx)("source",{src:t.url,type:"video/mp4"})})}},{title:Z.Z.t("general:URL"),dataIndex:"url",key:"url",width:"120px",fixed:r.tq()?"false":"right",render:function(e,t,n){return(0,v.jsx)("div",{children:(0,v.jsx)(d.ZP,{onClick:function(){ot()(t.url),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("resource:Copy Link")})})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"70px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsx)("div",{children:(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteResource(a)},okText:Z.Z.t("general:OK"),cancelText:Z.Z.t("general:Cancel")})})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:"name",size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Resources"),"\xa0\xa0\xa0\xa0",t.renderUpload()]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Ha=Wa,Ga=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var i;return(0,G.Z)(this,n),(i=t.call(this,e)).fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.searchedColumn,n=e.searchText,s=e.sortField,o=e.sortOrder;void 0!==e.category&&null!==e.category?(t="category",n=e.category):void 0!==e.type&&null!==e.type&&(t="type",n=e.type),i.setState({loading:!0}),(r.Qy(i.props.account)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return fetch("".concat(r.nn,"/api/get-global-certs?&p=").concat(e,"&pageSize=").concat(t,"&field=").concat(n,"&value=").concat(a,"&sortField=").concat(i,"&sortOrder=").concat(s),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(e.pagination.current,e.pagination.pageSize,t,n,s,o):na(r.jb(i.props.account),e.pagination.current,e.pagination.pageSize,t,n,s,o)).then((function(t){i.setState({loading:!1}),"ok"===t.status?i.setState({data:t.data,pagination:(0,a.Z)((0,a.Z)({},e.pagination),{},{total:t.data2}),searchText:e.searchText,searchedColumn:e.searchedColumn}):r.Ai(t)?i.setState({isAuthorized:!1}):r.PV("error",t.msg)}))},i}return(0,J.Z)(n,[{key:"componentDidMount",value:function(){(0,vn.Z)((0,jn.Z)(n.prototype),"componentDidMount",this).call(this),this.setState({owner:r.VN(this.props.account)?"admin":this.props.account.owner})}},{key:"newCert",value:function(){var e=r.VO();return{owner:r.Qy(this.props.account)?this.state.owner:r.jb(this.props.account),name:"cert_".concat(e),createdTime:Fe()().format(),displayName:"New Cert - ".concat(e),scope:"JWT",type:"x509",cryptoAlgorithm:"RS256",bitSize:4096,expireInYears:20,certificate:"",privateKey:""}}},{key:"addCert",value:function(){var e=this,t=this.newCert();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-cert"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/certs/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteCert",value:function(e){var t=this;aa(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"120px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/certs/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"150px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return"admin"!==e?e:Z.Z.t("provider:admin (Shared)")}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"180px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("provider:Scope"),dataIndex:"scope",key:"scope",filterMultiple:!1,filters:[{text:"JWT",value:"JWT"}],width:"110px",sorter:!0},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",filterMultiple:!1,filters:[{text:"x509",value:"x509"},{text:"Payment",value:"Payment"}],width:"110px",sorter:!0},{title:Z.Z.t("cert:Crypto algorithm"),dataIndex:"cryptoAlgorithm",key:"cryptoAlgorithm",filterMultiple:!1,filters:[{text:"RS256",value:"RS256"}],width:"190px",sorter:!0},(0,a.Z)({title:Z.Z.t("cert:Bit size"),dataIndex:"bitSize",key:"bitSize",width:"130px",sorter:!0},this.getColumnSearchProps("bitSize")),(0,a.Z)({title:Z.Z.t("cert:Expire in years"),dataIndex:"expireInYears",key:"expireInYears",width:"170px",sorter:!0},this.getColumnSearchProps("expireInYears")),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{disabled:!r.VN(t.props.account)&&n.owner!==t.props.account.owner,style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/certs/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{disabled:!r.VN(t.props.account)&&n.owner!==t.props.account.owner,title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteCert(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Certs"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addCert.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Ja=Ga,Qa=n(78925),Ka=n.n(Qa),_a=ne.Z.Option,$a=ae.Z.TextArea,Ya=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,certName:e.match.params.certName,owner:e.match.params.organizationName,cert:null,organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getCert(),this.getOrganizations()}},{key:"getCert",value:function(){var e,t,n=this;(e=this.state.owner,t=this.state.certName,fetch("".concat(r.nn,"/api/get-cert?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){null!==e.data?"error"!==e.status?n.setState({cert:e.data}):r.PV("error",e.msg):n.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"parseCertField",value:function(e,t){return["port"].includes(e)&&(t=r.Js(t)),t}},{key:"updateCertField",value:function(e,t){t=this.parseCertField(e,t);var n=this.state.cert;n[e]=t,this.setState({cert:n})}},{key:"renderCert",value:function(){var e=this,t=r.tq()?22:9;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("cert:New Cert"):Z.Z.t("cert:Edit Cert"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitCertEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitCertEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteCert()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.cert.owner,onChange:function(t){e.updateCertField("owner",t)},children:[r.VN(this.props.account)?(0,v.jsx)(_a,{value:"admin",children:Z.Z.t("provider:admin (Shared)")},"admin"):null,this.state.organizations.map((function(e,t){return(0,v.jsx)(_a,{value:e.name,children:e.name},t)}))]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.cert.name,onChange:function(t){e.updateCertField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.cert.displayName,onChange:function(t){e.updateCertField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Scope"),Z.Z.t("cert:Scope - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.cert.scope,onChange:function(t){e.updateCertField("scope",t)},children:[{id:"JWT",name:"JWT"}].map((function(e,t){return(0,v.jsx)(_a,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Type"),Z.Z.t("cert:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.cert.type,onChange:function(t){e.updateCertField("type",t)},children:[{id:"x509",name:"x509"},{id:"Payment",name:"Payment"}].map((function(e,t){return(0,v.jsx)(_a,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("cert:Crypto algorithm"),Z.Z.t("cert:Crypto algorithm - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.cert.cryptoAlgorithm,onChange:function(t){e.updateCertField("cryptoAlgorithm",t),t.startsWith("ES")?e.updateCertField("bitSize",0):1024!==e.state.cert.bitSize&&2048!==e.state.cert.bitSize&&4096!==e.state.cert.bitSize&&e.updateCertField("bitSize",2048),e.updateCertField("certificate",""),e.updateCertField("privateKey","")},children:[{id:"RS256",name:"RS256 (RSA + SHA256)"},{id:"RS384",name:"RS384 (RSA + SHA384)"},{id:"RS512",name:"RS512 (RSA + SHA512)"},{id:"ES256",name:"ES256 (ECDSA using P-256 + SHA256)"},{id:"ES384",name:"ES384 (ECDSA using P-384 + SHA384)"},{id:"ES512",name:"ES512 (ECDSA using P-521 + SHA512)"},{id:"PS256",name:"PS256 (RSASSA-PSS using SHA256 and MGF1 with SHA256)"},{id:"PS384",name:"PS384 (RSASSA-PSS using SHA384 and MGF1 with SHA384)"},{id:"PS512",name:"PS512 (RSASSA-PSS using SHA512 and MGF1 with SHA512)"}].map((function(e,t){return(0,v.jsx)(_a,{value:e.id,children:e.name},t)}))})})]}),this.state.cert.cryptoAlgorithm.startsWith("ES")?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("cert:Bit size"),Z.Z.t("cert:Bit size - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.cert.bitSize,onChange:function(t){e.updateCertField("bitSize",t),e.updateCertField("certificate",""),e.updateCertField("privateKey","")},children:r.qG(this.state.cert.cryptoAlgorithm).map((function(e,t){return(0,v.jsx)(_a,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("cert:Expire in years"),Z.Z.t("cert:Expire in years - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.cert.expireInYears,onChange:function(t){e.updateCertField("expireInYears",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("cert:Certificate"),Z.Z.t("cert:Certificate - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:t,children:[(0,v.jsx)(d.ZP,{style:{marginRight:"10px",marginBottom:"10px"},disabled:""===this.state.cert.certificate,onClick:function(){ot()(e.state.cert.certificate),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("cert:Copy certificate")}),(0,v.jsx)(d.ZP,{type:"primary",disabled:""===this.state.cert.certificate,onClick:function(){var t=new Blob([e.state.cert.certificate],{type:"text/plain;charset=utf-8"});Ka().saveAs(t,"token_jwt_key.pem")},children:Z.Z.t("cert:Download certificate")}),(0,v.jsx)($a,{autoSize:{minRows:30,maxRows:30},value:this.state.cert.certificate,onChange:function(t){e.updateCertField("certificate",t.target.value)}})]}),(0,v.jsx)(L.Z,{span:1}),(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("cert:Private key"),Z.Z.t("cert:Private key - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:t,children:[(0,v.jsx)(d.ZP,{style:{marginRight:"10px",marginBottom:"10px"},disabled:""===this.state.cert.privateKey,onClick:function(){ot()(e.state.cert.privateKey),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("cert:Copy private key")}),(0,v.jsx)(d.ZP,{type:"primary",disabled:""===this.state.cert.privateKey,onClick:function(){var t=new Blob([e.state.cert.privateKey],{type:"text/plain;charset=utf-8"});Ka().saveAs(t,"token_jwt_key.key")},children:Z.Z.t("cert:Download private key")}),(0,v.jsx)($a,{autoSize:{minRows:30,maxRows:30},value:this.state.cert.privateKey,onChange:function(t){e.updateCertField("privateKey",t.target.value)}})]})]})]})}},{key:"submitCertEdit",value:function(e){var t=this,n=r.p$(this.state.cert);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-cert?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.owner,this.state.certName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({certName:t.state.cert.name},(function(){e?t.props.history.push("/certs"):(t.props.history.push("/certs/".concat(t.state.cert.owner,"/").concat(t.state.cert.name)),t.getCert())}))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateCertField("name",t.state.certName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteCert",value:function(){var e=this;aa(this.state.cert).then((function(t){"ok"===t.status?e.props.history.push("/certs"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.cert?this.renderCert():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitCertEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitCertEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteCert()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component);function Xa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-roles?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function ei(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-role"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var ti=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),Xa(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newRole",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"role_".concat(e),createdTime:Fe()().format(),displayName:"New Role - ".concat(e),users:[],groups:[],roles:[],domains:[],isEnabled:!0}}},{key:"addRole",value:function(){var e=this,t=this.newRole();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-role"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/roles/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteRole",value:function(e){var t=this;ei(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){}))}},{key:"uploadRoleFile",value:function(e){var t=e.file,n=t.status,a=t.response;if("done"===n)if("ok"===a.status){r.PV("success","Users uploaded successfully, refreshing the page");var i=this.state.pagination;this.fetch({pagination:i})}else r.PV("error","".concat(Z.Z.t("general:Failed to sync"),": ").concat(a.msg));else"error"===n&&r.PV("error","File failed to upload")}},{key:"renderRoleUpload",value:function(){var e=this,t={name:"file",accept:".xlsx",method:"post",action:"".concat(r.nn,"/api/upload-roles"),withCredentials:!0,onChange:function(t){e.uploadRoleFile(t)}};return(0,v.jsx)(Tn.Z,(0,a.Z)((0,a.Z)({},t),{},{children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(kn.Z,{}),type:"primary",size:"small",children:Z.Z.t("user:Upload (.xlsx)")})}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/roles/".concat(t.owner,"/").concat(encodeURIComponent(t.name)),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"200px",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub users"),dataIndex:"users",key:"users",sorter:!0},this.getColumnSearchProps("users")),{},{render:function(e,t,n){return r.NJ(e,"users")}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub groups"),dataIndex:"groups",key:"groups",sorter:!0},this.getColumnSearchProps("groups")),{},{render:function(e,t,n){return r.NJ(e,"groups")}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub roles"),dataIndex:"roles",key:"roles",sorter:!0},this.getColumnSearchProps("roles")),{},{render:function(e,t,n){return r.NJ(e,"roles")}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub domains"),dataIndex:"domains",key:"domains",sorter:!0},this.getColumnSearchProps("domains")),{},{render:function(e,t,n){return r.NJ(e)}}),{title:Z.Z.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/roles/".concat(n.owner,"/").concat(encodeURIComponent(n.name)))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteRole(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Roles"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:t.addRole.bind(t),children:Z.Z.t("general:Add")}),t.renderRoleUpload()]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),ni=ti,ai=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,roleName:decodeURIComponent(e.match.params.roleName),role:null,organizations:[],users:[],groups:[],roles:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getRole(),this.getOrganizations()}},{key:"getRole",value:function(){var e,t,n=this;(e=this.state.organizationName,t=this.state.roleName,fetch("".concat(r.nn,"/api/get-role?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){null!==e.data?"error"!==e.status?(n.setState({role:e.data}),n.getUsers(n.state.organizationName),n.getGroups(n.state.organizationName),n.getRoles(n.state.organizationName)):r.PV("error",e.msg):n.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getUsers",value:function(e){var t=this;ue.getUsers(e).then((function(e){"error"!==e.status?t.setState({users:e.data}):r.PV("error",e.msg)}))}},{key:"getGroups",value:function(e){var t=this;ce(e).then((function(e){"error"!==e.status?t.setState({groups:e.data}):r.PV("error",e.msg)}))}},{key:"getRoles",value:function(e){var t=this;Xa(e).then((function(e){"error"!==e.status?t.setState({roles:e.data}):r.PV("error",e.msg)}))}},{key:"parseRoleField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateRoleField",value:function(e,t){t=this.parseRoleField(e,t);var n=this.state.role;n[e]=t,this.setState({role:n})}},{key:"renderRole",value:function(){var e,t=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("role:New Role"):Z.Z.t("role:Edit Role"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return t.submitRoleEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return t.submitRoleEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return t.deleteRole()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.role.owner,onChange:function(e){t.updateRoleField("owner",e)},options:this.state.organizations.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.role.name,onChange:function(e){t.updateRoleField("name",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.role.displayName,onChange:function(e){t.updateRoleField("displayName",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.role.description,onChange:function(e){t.updateRoleField("description",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub users"),Z.Z.t("role:Sub users - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!0,mode:"multiple",style:{width:"100%"},value:this.state.role.users,onChange:function(e){t.updateRoleField("users",e)},options:this.state.users.map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub groups"),Z.Z.t("role:Sub groups - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.role.groups,onChange:function(e){t.updateRoleField("groups",e)},options:this.state.groups.map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub roles"),Z.Z.t("role:Sub roles - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.role.roles,onChange:function(e){t.updateRoleField("roles",e)},options:this.state.roles.filter((function(e){return e.owner!==t.state.role.owner||e.name!==t.state.role.name})).map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub domains"),Z.Z.t("role:Sub domains - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",style:{width:"100%"},value:this.state.role.domains,onChange:function(e){t.updateRoleField("domains",e)},options:null===(e=this.state.role.domains)||void 0===e?void 0:e.map((function(e){return r.Rl(e,e)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.role.isEnabled,onChange:function(e){t.updateRoleField("isEnabled",e)}})})]})]})}},{key:"submitRoleEdit",value:function(e){var t=this,n=r.p$(this.state.role);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-role?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.organizationName,this.state.roleName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({roleName:t.state.role.name}),e?t.props.history.push("/roles"):t.props.history.push("/roles/".concat(t.state.role.owner,"/").concat(encodeURIComponent(t.state.role.name)))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateRoleField("name",t.state.roleName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteRole",value:function(){var e=this;ei(this.state.role).then((function(t){"ok"===t.status?e.props.history.push("/roles"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.role?this.renderRole():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitRoleEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitRoleEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteRole()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component);function ii(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-permissions?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function ri(){return fetch("".concat(r.nn,"/api/get-permissions-by-submitter"),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function si(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-permission"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var oi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),(r.$J(e.props.account)?ii:ri)(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newPermission",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"permission_".concat(e),createdTime:Fe()().format(),displayName:"New Permission - ".concat(e),users:["".concat(this.props.account.owner,"/").concat(this.props.account.name)],groups:[],roles:[],domains:[],resourceType:"Application",resources:["app-built-in"],actions:["Read"],effect:"Allow",isEnabled:!0,submitter:this.props.account.name,approver:"",approveTime:"",state:r.$J(this.props.account)?"Approved":"Pending"}}},{key:"addPermission",value:function(){var e=this,t=this.newPermission();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-permission"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/permissions/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deletePermission",value:function(e){var t=this;si(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"uploadPermissionFile",value:function(e){var t=e.file,n=t.status,a=t.response;if("done"===n)if("ok"===a.status){r.PV("success","Users uploaded successfully, refreshing the page");var i=this.state.pagination;this.fetch({pagination:i})}else r.PV("error","".concat(Z.Z.t("general:Failed to sync"),": ").concat(a.msg));else"error"===n&&r.PV("error","File failed to upload")}},{key:"renderPermissionUpload",value:function(){var e=this,t={name:"file",accept:".xlsx",method:"post",action:"".concat(r.nn,"/api/upload-permissions"),withCredentials:!0,onChange:function(t){e.uploadPermissionFile(t)}};return(0,v.jsx)(Tn.Z,(0,a.Z)((0,a.Z)({},t),{},{children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(kn.Z,{}),id:"upload-button",type:"primary",size:"small",children:Z.Z.t("user:Upload (.xlsx)")})}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/permissions/".concat(t.owner,"/").concat(encodeURIComponent(e)),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"160px",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub users"),dataIndex:"users",key:"users",sorter:!0},this.getColumnSearchProps("users")),{},{render:function(e,t,n){return r.NJ(e,"users")}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub groups"),dataIndex:"groups",key:"groups",sorter:!0},this.getColumnSearchProps("groups")),{},{render:function(e,t,n){return r.NJ(e,"groups")}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub roles"),dataIndex:"roles",key:"roles",sorter:!0},this.getColumnSearchProps("roles")),{},{render:function(e,t,n){return r.NJ(e,"roles")}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("role:Sub domains"),dataIndex:"domains",key:"domains",sorter:!0},this.getColumnSearchProps("domains")),{},{render:function(e,t,n){return r.NJ(e)}}),{title:Z.Z.t("permission:Resource type"),dataIndex:"resourceType",key:"resourceType",filterMultiple:!1,filters:[{text:"Application",value:"Application"}],width:"170px",sorter:!0},(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Resources"),dataIndex:"resources",key:"resources",sorter:!0},this.getColumnSearchProps("resources")),{},{render:function(e,t,n){return r.NJ(e)}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("permission:Actions"),dataIndex:"actions",key:"actions",sorter:!0},this.getColumnSearchProps("actions")),{},{render:function(e,t,n){var a=e.map((function(e,t){switch(e){case"Read":return Z.Z.t("permission:Read");case"Write":return Z.Z.t("permission:Write");case"Admin":return Z.Z.t("permission:Admin");default:return null}}));return r.NJ(a)}}),{title:Z.Z.t("permission:Effect"),dataIndex:"effect",key:"effect",filterMultiple:!1,filters:[{text:Z.Z.t("permission:Allow"),value:"Allow"},{text:Z.Z.t("permission:Deny"),value:"Deny"}],width:"120px",sorter:!0,render:function(e,t,n){switch(e){case"Allow":return r.h1("success",Z.Z.t("permission:Allow"));case"Deny":return r.h1("error",Z.Z.t("permission:Deny"));default:return null}}},{title:Z.Z.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("permission:Submitter"),dataIndex:"submitter",key:"submitter",filterMultiple:!1,width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(encodeURIComponent(e)),children:e})}},{title:Z.Z.t("permission:Approver"),dataIndex:"approver",key:"approver",filterMultiple:!1,width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(encodeURIComponent(e)),children:e})}},{title:Z.Z.t("permission:Approve time"),dataIndex:"approveTime",key:"approveTime",filterMultiple:!1,width:"120px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("general:State"),dataIndex:"state",key:"state",filterMultiple:!1,filters:[{text:Z.Z.t("permission:Approved"),value:"Approved"},{text:Z.Z.t("permission:Pending"),value:"Pending"}],width:"120px",sorter:!0,render:function(e,t,n){switch(e){case"Approved":return r.h1("success",Z.Z.t("permission:Approved"));case"Pending":return r.h1("error",Z.Z.t("permission:Pending"));default:return null}}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/permissions/".concat(n.owner,"/").concat(encodeURIComponent(n.name)))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deletePermission(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Permissions"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{id:"add-button",style:{marginRight:"5px"},type:"primary",size:"small",onClick:t.addPermission.bind(t),children:Z.Z.t("general:Add")}),t.renderPermissionUpload()]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),li=oi;function ci(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-models?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function di(e,t){return fetch("".concat(r.nn,"/api/get-model?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function pi(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-model"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var ui=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,permissionName:decodeURIComponent(e.match.params.permissionName),permission:null,organizations:[],model:null,users:[],groups:[],roles:[],models:[],resources:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getPermission(),this.getOrganizations()}},{key:"getPermission",value:function(){var e,t,n=this;(e=this.state.organizationName,t=this.state.permissionName,fetch("".concat(r.nn,"/api/get-permission?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){var t=e.data;null!==t?"error"!==e.status?(n.setState({permission:t}),n.getUsers(t.owner),n.getGroups(t.owner),n.getRoles(t.owner),n.getModels(t.owner),n.getResources(t.owner),n.getModel(t.owner,t.model)):r.PV("error",e.msg):n.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getUsers",value:function(e){var t=this;ue.getUsers(e).then((function(e){"error"!==e.status?t.setState({users:e.data}):r.PV("error",e.msg)}))}},{key:"getGroups",value:function(e){var t=this;ce(e).then((function(e){"error"!==e.status?t.setState({groups:e.data}):r.PV("error",e.msg)}))}},{key:"getRoles",value:function(e){var t=this;Xa(e).then((function(e){"error"!==e.status?t.setState({roles:e.data}):r.PV("error",e.msg)}))}},{key:"getModels",value:function(e){var t=this;ci(e).then((function(e){"error"!==e.status?t.setState({models:e.data}):r.PV("error",e.msg)}))}},{key:"getModel",value:function(e,t){var n=this;""!==t&&di(e,t).then((function(e){n.setState({model:e.data})}))}},{key:"getResources",value:function(e){var t=this;W.rW("admin",e).then((function(e){t.setState({resources:e.data||[]})}))}},{key:"parsePermissionField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updatePermissionField",value:function(e,t){"model"===e&&this.getModel(this.state.permission.owner,t),t=this.parsePermissionField(e,t);var n=this.state.permission;n[e]=t,this.setState({permission:n})}},{key:"hasRoleDefinition",value:function(e){return null!==e&&e.modelText.includes("role_definition")}},{key:"renderPermission",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("permission:New Permission"):Z.Z.t("permission:Edit Permission"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitPermissionEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitPermissionEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deletePermission()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.permission.owner,onChange:function(t){e.updatePermissionField("owner",t),e.getUsers(t),e.getGroups(t),e.getRoles(t),e.getModels(t),e.getResources(t)},options:this.state.organizations.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.permission.name,onChange:function(t){e.updatePermissionField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.permission.displayName,onChange:function(t){e.updatePermissionField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.permission.description,onChange:function(t){e.updatePermissionField("description",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Model"),Z.Z.t("general:Model - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.permission.model,onChange:function(t){e.updatePermissionField("model",t)},options:this.state.models.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Adapter"),Z.Z.t("general:Adapter - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.permission.adapter,onChange:function(t){e.updatePermissionField("adapter",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub users"),Z.Z.t("role:Sub users - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.permission.users,onChange:function(t){e.updatePermissionField("users",t)},options:[r.Rl(Z.Z.t("organization:All"),"*")].concat((0,Ve.Z)(this.state.users.map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub groups"),Z.Z.t("role:Sub groups - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.permission.groups,onChange:function(t){e.updatePermissionField("groups",t)},options:[r.Rl(Z.Z.t("organization:All"),"*")].concat((0,Ve.Z)(this.state.groups.map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub roles"),Z.Z.t("role:Sub roles - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{disabled:!this.hasRoleDefinition(this.state.model),placeholder:this.hasRoleDefinition(this.state.model)?"":"This field is disabled because the model is empty or it doesn't support RBAC (in another word, doesn't contain [role_definition])",virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.permission.roles,onChange:function(t){e.updatePermissionField("roles",t)},options:[r.Rl(Z.Z.t("organization:All"),"*")].concat((0,Ve.Z)(this.state.roles.filter((function(t){return t.owner!==e.state.roles.owner||t.name!==e.state.roles.name})).map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("role:Sub domains"),Z.Z.t("role:Sub domains - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",style:{width:"100%"},value:this.state.permission.domains,onChange:function(t){e.updatePermissionField("domains",t)},options:[r.Rl(Z.Z.t("organization:All"),"*")].concat((0,Ve.Z)(this.state.permission.domains.filter((function(e){return"*"!==e})).map((function(e){return r.Rl(e,e)}))))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("permission:Resource type"),Z.Z.t("permission:Resource type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.permission.resourceType,onChange:function(t){e.updatePermissionField("resourceType",t),e.updatePermissionField("resources",[])},options:[{value:"Application",name:Z.Z.t("general:Application")},{value:"TreeNode",name:Z.Z.t("permission:TreeNode")},{value:"Custom",name:Z.Z.t("general:Custom")}].map((function(e){return r.Rl(e.name,e.value)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Resources"),Z.Z.t("permission:Resources - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"Custom"===this.state.permission.resourceType?"tags":"multiple",style:{width:"100%"},value:this.state.permission.resources,onChange:function(t){e.updatePermissionField("resources",t)},options:[r.Rl(Z.Z.t("organization:All"),"*")].concat((0,Ve.Z)(this.state.resources.map((function(e){return r.Rl("".concat(e.name),"".concat(e.name))}))))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("permission:Actions"),Z.Z.t("permission:Actions - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"Custom"===this.state.permission.resourceType?"tags":"multiple",style:{width:"100%"},value:this.state.permission.actions,onChange:function(t){e.updatePermissionField("actions",t)},options:[{value:"Read",name:Z.Z.t("permission:Read")},{value:"Write",name:Z.Z.t("permission:Write")},{value:"Admin",name:Z.Z.t("permission:Admin")}].map((function(e){return r.Rl(e.name,e.value)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("permission:Effect"),Z.Z.t("permission:Effect - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.permission.effect,onChange:function(t){e.updatePermissionField("effect",t)},options:[{value:"Allow",name:Z.Z.t("permission:Allow")},{value:"Deny",name:Z.Z.t("permission:Deny")}].map((function(e){return r.Rl(e.name,e.value)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.permission.isEnabled,onChange:function(t){e.updatePermissionField("isEnabled",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("permission:Submitter"),Z.Z.t("permission:Submitter - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.permission.submitter,onChange:function(t){e.updatePermissionField("submitter",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("permission:Approver"),Z.Z.t("permission:Approver - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.permission.approver,onChange:function(t){e.updatePermissionField("approver",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("permission:Approve time"),Z.Z.t("permission:Approve time - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:r.L0(this.state.permission.approveTime),onChange:function(t){e.updatePermissionField("approveTime",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:State"),Z.Z.t("general:State - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:!r.$J(this.props.account),style:{width:"100%"},value:this.state.permission.state,onChange:function(t){e.state.permission.state!==t&&("Approved"===t?(e.updatePermissionField("approver",e.props.account.name),e.updatePermissionField("approveTime",Fe()().format())):(e.updatePermissionField("approver",""),e.updatePermissionField("approveTime",""))),e.updatePermissionField("state",t)},options:[{value:"Approved",name:Z.Z.t("permission:Approved")},{value:"Pending",name:Z.Z.t("permission:Pending")}].map((function(e){return r.Rl(e.name,e.value)}))})})]})]})}},{key:"submitPermissionEdit",value:function(e){var t=this;if(0!==this.state.permission.users.length||0!==this.state.permission.roles.length)if(0!==this.state.permission.resources.length)if(0!==this.state.permission.actions.length)if(r.$J(this.props.account)||this.state.permission.submitter===this.props.account.name){var n=r.p$(this.state.permission);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-permission?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.organizationName,this.state.permissionName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({organizationName:t.state.permission.owner,permissionName:t.state.permission.name}),e?t.props.history.push("/permissions"):t.props.history.push("/permissions/".concat(t.state.permission.owner,"/").concat(encodeURIComponent(t.state.permission.name)))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updatePermissionField("name",t.state.permissionName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}else r.PV("error","A normal user can only modify the permission submitted by itself");else r.PV("error","The actions cannot be empty");else r.PV("error","The resources cannot be empty");else r.PV("error","The users and roles cannot be empty at the same time")}},{key:"deletePermission",value:function(){var e=this;si(this.state.permission).then((function(t){"ok"===t.status?e.props.history.push("/permissions"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.permission?this.renderPermission():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitPermissionEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitPermissionEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deletePermission()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),hi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),ci(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newModel",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"model_".concat(e),createdTime:Fe()().format(),displayName:"New Model - ".concat(e),modelText:"[request_definition]\nr = sub, obj, act\n\n[policy_definition]\np = sub, obj, act\n\n[role_definition]\ng = _, _\n\n[policy_effect]\ne = some(where (p.eft == allow))\n\n[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act"}}},{key:"addModel",value:function(){var e=this,t=this.newModel();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-model"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/models/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteModel",value:function(e){var t=this;pi(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"180px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/models/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"180px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"180px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"200px",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("model:Model text"),dataIndex:"modelText",key:"modelText",sorter:!0,render:function(e,t,n){return(0,v.jsx)(at.Z,{placement:"topRight",content:function(){return(0,v.jsx)(Jn,{value:e})},title:"",trigger:"hover",children:r.xu(e,100)})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"180px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/models/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{disabled:r.CM(n),title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteModel(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Models"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addModel.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),gi=hi,mi=(0,y.forwardRef)((function(e,t){var n=e.initialModelText,a=e.onModelTextChange,r=(0,y.useRef)(null),s=(0,y.useState)(!1),o=(0,i.Z)(s,2),l=o[0],c=o[1],d=localStorage.getItem("language")||"en";return(0,y.useEffect)((function(){var e=function(e){if("https://editor.casbin.org"===e.origin)if("modelUpdate"===e.data.type)a(e.data.modelText);else if("iframeReady"===e.data.type){var t;c(!0),n&&null!==(t=r.current)&&void 0!==t&&t.contentWindow&&r.current.contentWindow.postMessage({type:"initializeModel",modelText:n,lang:d},"*")}};return window.addEventListener("message",e),function(){return window.removeEventListener("message",e)}}),[a,n,d]),(0,y.useImperativeHandle)(t,(function(){return{getModelText:function(){var e;null!==(e=r.current)&&void 0!==e&&e.contentWindow&&r.current.contentWindow.postMessage({type:"getModelText"},"*")},updateModelText:function(e){var t;l&&null!==(t=r.current)&&void 0!==t&&t.contentWindow&&r.current.contentWindow.postMessage({type:"updateModelText",modelText:e},"*")}}})),(0,v.jsx)("iframe",{ref:r,src:"https://editor.casbin.org/model-editor?lang=".concat(d),frameBorder:"0",width:"100%",height:"500px",title:"Casbin Model Editor"})})),xi=n(13999),Zi=function(e){var t=e.model,n=e.onModelTextChange,a=(0,y.useState)("advanced"),s=(0,i.Z)(a,2),o=s[0],l=s[1],c=(0,y.useRef)(null),d=(0,y.useState)(t.modelText),p=(0,i.Z)(d,2),u=p[0],h=p[1],g=(0,y.useCallback)((function(e){r.CM(t)||(h(e),n(e))}),[t,n]),m=(0,y.useCallback)((function(){return new Promise((function(e){if("advanced"===o&&c.current){window.addEventListener("message",(function t(n){"modelUpdate"===n.data.type&&(window.removeEventListener("message",t),g(n.data.modelText),e())})),c.current.getModelText()}else e()}))}),[o,g]);return(0,y.useEffect)((function(){h(t.modelText)}),[t.modelText]),(0,v.jsxs)("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},children:[(0,v.jsx)(xi.Z,{activeKey:o,onChange:function(e){m().then((function(){l(e),"advanced"===e&&c.current&&c.current.updateModelText(u)}))},style:{flex:"0 0 auto",marginTop:"-10px"},items:[{key:"basic",label:Z.Z.t("model:Basic Editor")},{key:"advanced",label:Z.Z.t("model:Advanced Editor")}]}),(0,v.jsx)("div",{style:{flex:"1 1 auto",overflow:"hidden"},children:"advanced"===o?(0,v.jsx)(mi,{ref:c,initialModelText:u,onModelTextChange:g,style:{width:"100%",height:"100%"}}):(0,v.jsx)(Jn,{value:u,readOnly:r.CM(t),onChange:function(e){g(e)}})})]})},yi=ne.Z.Option,fi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,modelName:e.match.params.modelName,model:null,organizations:[],users:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getModel(),this.getOrganizations()}},{key:"getModel",value:function(){var e=this;di(this.state.organizationName,this.state.modelName).then((function(t){null!==t.data?"error"!==t.status?e.setState({model:t.data}):r.PV("error",t.msg):e.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"parseModelField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateModelField",value:function(e,t){t=this.parseModelField(e,t);var n=this.state.model;n[e]=t,this.setState({model:n})}},{key:"renderModel",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("model:New Model"):Z.Z.t("model:Edit Model"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitModelEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitModelEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteModel()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account)||r.CM(this.state.model),value:this.state.model.owner,onChange:function(t){e.updateModelField("owner",t)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(yi,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:r.CM(this.state.model),value:this.state.model.name,onChange:function(t){e.updateModelField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.model.displayName,onChange:function(t){e.updateModelField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.model.description,onChange:function(t){e.updateModelField("description",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("model:Model text"),Z.Z.t("model:Model text - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)("div",{style:{position:"relative",height:"500px"},children:(0,v.jsx)(Zi,{model:this.state.model,onModelTextChange:function(t){return e.updateModelField("modelText",t)}})})})]})]})}},{key:"submitModelEdit",value:function(e){var t=this,n=r.p$(this.state.model);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-model?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.organizationName,this.state.modelName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({modelName:t.state.model.name}),e?t.props.history.push("/models"):t.props.history.push("/models/".concat(t.state.model.owner,"/").concat(t.state.model.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateModelField("name",t.state.modelName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteModel",value:function(){var e=this;pi(this.state.model).then((function(t){"ok"===t.status?e.props.history.push("/models"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.model?this.renderModel():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitModelEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitModelEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteModel()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component);function vi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-adapters?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function ji(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-adapter"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}function Ti(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return fetch("".concat(r.nn,"/api/get-policies?id=").concat(e,"/").concat(encodeURIComponent(t),"&adapterId=").concat(n),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var ki=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),vi(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newAdapter",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"adapter_".concat(e),createdTime:Fe()().format(),table:"table_name",useSameDb:!0}}},{key:"addAdapter",value:function(){var e=this,t=this.newAdapter();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-adapter"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/adapters/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteAdapter",value:function(e){var t=this;ji(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/adapters/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("syncer:Table"),dataIndex:"table",key:"table",width:"120px",sorter:!0},{title:Z.Z.t("adapter:Use same DB"),dataIndex:"useSameDb",key:"useSameDb",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"100px",sorter:!0,filterMultiple:!1,filters:[{text:"Database",value:"Database"}]},{title:Z.Z.t("syncer:Database type"),dataIndex:"databaseType",key:"databaseType",width:"120px",sorter:function(e,t){return e.databaseType.localeCompare(t.databaseType)}},(0,a.Z)({title:Z.Z.t("provider:Host"),dataIndex:"host",key:"host",width:"120px",sorter:!0},this.getColumnSearchProps("host")),(0,a.Z)((0,a.Z)({title:Z.Z.t("provider:Port"),dataIndex:"port",key:"port",width:"100px",sorter:!0},this.getColumnSearchProps("port")),{},{render:function(e,t,n){return 0===e?"":e}}),(0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),(0,a.Z)({title:Z.Z.t("general:Password"),dataIndex:"password",key:"password",width:"120px",sorter:!0},this.getColumnSearchProps("password")),{title:Z.Z.t("syncer:Database"),dataIndex:"database",key:"database",width:"120px",sorter:!0},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/adapters/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{disabled:r.CM(n),title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteAdapter(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Adapters"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addAdapter.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Ci=ki,bi=ne.Z.Option,Si=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,adapterName:e.match.params.adapterName,adapter:null,organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getAdapter(),this.getOrganizations()}},{key:"getAdapter",value:function(){var e,t,n=this;(e=this.state.organizationName,t=this.state.adapterName,fetch("".concat(r.nn,"/api/get-adapter?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){if("ok"===e.status){if(null===e.data)return void n.props.history.push("/404");n.setState({adapter:e.data})}}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"parseAdapterField",value:function(e,t){return t}},{key:"updateAdapterField",value:function(e,t){t=this.parseAdapterField(e,t);var n=this.state.adapter;n[e]=t,this.setState({adapter:n})}},{key:"renderAdapter",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("adapter:New Adapter"):Z.Z.t("adapter:Edit Adapter"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitAdapterEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitAdapterEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteAdapter()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account)||r.CM(this.state.adapter),value:this.state.adapter.owner,onChange:function(t){e.updateAdapterField("owner",t)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(bi,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:r.CM(this.state.adapter),value:this.state.adapter.name,onChange:function(t){e.updateAdapterField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Table"),Z.Z.t("syncer:Table - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.adapter.table,disabled:r.CM(this.state.adapter),onChange:function(t){e.updateAdapterField("table",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("adapter:Use same DB"),Z.Z.t("adapter:Use same DB - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{disabled:r.CM(this.state.adapter),checked:this.state.adapter.useSameDb||r.CM(this.state.adapter),onChange:function(t){e.updateAdapterField("useSameDb",t),t?(e.updateAdapterField("type",""),e.updateAdapterField("databaseType",""),e.updateAdapterField("host",""),e.updateAdapterField("port",0),e.updateAdapterField("user",""),e.updateAdapterField("password",""),e.updateAdapterField("database","")):(e.updateAdapterField("type","Database"),e.updateAdapterField("databaseType","mysql"),e.updateAdapterField("host","localhost"),e.updateAdapterField("port",3306),e.updateAdapterField("user","root"),e.updateAdapterField("password","123456"),e.updateAdapterField("database","dbName"))}})})]}),this.state.adapter.useSameDb||r.CM(this.state.adapter)?null:(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Type"),Z.Z.t("provider:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:r.CM(this.state.adapter),style:{width:"100%"},value:this.state.adapter.type,onChange:function(t){e.updateAdapterField("type",t);var n=e.state.adapter;e.setState({adapter:n})},children:["Database"].map((function(e,t){return(0,v.jsx)(bi,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Database type"),Z.Z.t("syncer:Database type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:r.CM(this.state.adapter),style:{width:"100%"},value:this.state.adapter.databaseType,onChange:function(t){e.updateAdapterField("databaseType",t)},children:[{id:"mysql",name:"MySQL"},{id:"postgres",name:"PostgreSQL"},{id:"mssql",name:"SQL Server"},{id:"oracle",name:"Oracle"},{id:"sqlite3",name:"Sqlite 3"}].map((function(e,t){return(0,v.jsx)(bi,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Host"),Z.Z.t("provider:Host - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.adapter.host,onChange:function(t){e.updateAdapterField("host",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Port"),Z.Z.t("provider:Port - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.adapter.port,min:0,max:65535,onChange:function(t){e.updateAdapterField("port",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:User"),Z.Z.t("general:User - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.adapter.user,onChange:function(t){e.updateAdapterField("user",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password"),Z.Z.t("general:Password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.adapter.password,onChange:function(t){e.updateAdapterField("password",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Database"),Z.Z.t("syncer:Database - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:r.CM(this.state.adapter),value:this.state.adapter.database,onChange:function(t){e.updateAdapterField("database",t.target.value)}})})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:DB test"),Z.Z.t("provider:DB test - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:2,children:(0,v.jsx)(d.ZP,{disabled:this.state.organizationName!==this.state.adapter.owner,type:"primary",onClick:function(){Ti("","","".concat(e.state.adapter.owner,"/").concat(e.state.adapter.name)).then((function(e){"ok"===e.status?r.PV("success",Z.Z.t("syncer:Connect successfully")):r.PV("error",Z.Z.t("syncer:Failed to connect")+": "+e.msg)})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))},children:Z.Z.t("syncer:Test DB Connection")})})]})]})}},{key:"submitAdapterEdit",value:function(e){var t=this,n=r.p$(this.state.adapter);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-adapter?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.organizationName,this.state.adapterName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({organizationName:t.state.adapter.owner,adapterName:t.state.adapter.name}),e?t.props.history.push("/adapters"):t.props.history.push("/adapters/".concat(t.state.adapter.owner,"/").concat(t.state.adapter.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateAdapterField("name",t.state.adapterName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteAdapter",value:function(){var e=this;ji(this.state.adapter).then((function(t){"ok"===t.status?e.props.history.push("/adapters"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.adapter?this.renderAdapter():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitAdapterEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitAdapterEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteAdapter()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component);function wi(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-enforcer"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var Pi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-enforcers?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newEnforcer",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"enforcer_".concat(e),createdTime:Fe()().format(),displayName:"New Enforcer - ".concat(e)}}},{key:"addEnforcer",value:function(){var e=this,t=this.newEnforcer();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-enforcer"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/enforcers/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteEnforcer",value:function(e){var t=this;wi(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"200px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/enforcers/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Model"),dataIndex:"model",key:"model",width:"250px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/models/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Adapter"),dataIndex:"adapter",key:"adapter",width:"250px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/adapters/".concat(e),children:e})}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"180px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/enforcers/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{disabled:r.CM(n),title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteEnforcer(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Enforcers"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addEnforcer.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Ai=Pi,Ii=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).count=0,a.pageSize=100,a.isEditing=function(e){return e===a.state.editingIndex},a.edit=function(e,t){a.setState({editingIndex:t,oldPolicy:r.p$(e)})},a.cancel=function(e,t){Object.keys(e[a.getIndex(t)]).forEach((function(n){e[a.getIndex(t)][n]=a.state.oldPolicy[n]})),a.updateTable(e),a.setState({editingIndex:"",oldPolicy:""}),a.state.add&&(a.deleteRow(a.state.policyLists,t),a.setState({add:!1}))},a.state={policyLists:[],loading:!1,editingIndex:"",oldPolicy:"",add:!1,page:1},a}return(0,J.Z)(n,[{key:"getIndex",value:function(e){return e+(this.state.page-1)*this.pageSize}},{key:"UNSAFE_componentWillMount",value:function(){"edit"===this.props.mode&&""!==this.props.enforcer.adapter&&this.getPolicies()}},{key:"updateTable",value:function(e){this.setState({policyLists:e})}},{key:"updateField",value:function(e,t,n,a){e[this.getIndex(t)][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={key:this.count,Ptype:"p"};void 0===e&&(e=[]),e=r.SA(e,t,"top"),this.count=this.count+1,this.updateTable(e),this.edit(t,0),this.setState({page:1,add:!0})}},{key:"deleteRow",value:function(e,t){e=r.qK(e,this.getIndex(t)),this.updateTable(e)}},{key:"save",value:function(e,t){this.state.add?this.addPolicy(e,t):this.updatePolicy(e,t)}},{key:"getPolicies",value:function(){var e=this;this.setState({loading:!0}),Ti(this.props.enforcer.owner,this.props.enforcer.name).then((function(t){if("ok"===t.status){var n=t.data;n.map((function(e,t){e.key=t})),e.count=n.length,e.setState({policyLists:n})}else r.PV("error","".concat(Z.Z.t("adapter:Failed to sync policies"),": ").concat(t.msg));e.setState({loading:!1})})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"updatePolicy",value:function(e,t){var n,a,i,s=this;(n=this.props.enforcer.owner,a=this.props.enforcer.name,i=[this.state.oldPolicy,e[t]],fetch("".concat(r.nn,"/api/update-policy?id=").concat(n,"/").concat(encodeURIComponent(a)),{method:"POST",credentials:"include",body:JSON.stringify(i),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){"ok"===e.status?(s.setState({editingIndex:"",oldPolicy:""}),r.PV("success",Z.Z.t("general:Successfully saved"))):r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(e.msg))}))}},{key:"addPolicy",value:function(e,t){var n,a,i,s=this;(n=this.props.enforcer.owner,a=this.props.enforcer.name,i=e[t],fetch("".concat(r.nn,"/api/add-policy?id=").concat(n,"/").concat(encodeURIComponent(a)),{method:"POST",credentials:"include",body:JSON.stringify(i),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){"ok"===e.status?(s.setState({editingIndex:"",oldPolicy:"",add:!1}),"Affected"!==e.data?(e.msg=Z.Z.t("adapter:Duplicated policy rules"),r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(e.msg))):r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(e.msg))}))}},{key:"deletePolicy",value:function(e,t){var n,a,i,s=this;(n=this.props.enforcer.owner,a=this.props.enforcer.name,i=e[this.getIndex(t)],fetch("".concat(r.nn,"/api/remove-policy?id=").concat(n,"/").concat(encodeURIComponent(a)),{method:"POST",credentials:"include",body:JSON.stringify(i),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),s.deleteRow(e,t)):r.PV("error",Z.Z.t("general:Failed to delete"))}))}},{key:"renderTable",value:function(e){var t=this;if(void 0===this.props.modelCfg)return null;var n=[{title:Z.Z.t("adapter:Rule type"),dataIndex:"Ptype",width:"100px",render:function(n,a,i){return t.isEditing(i)&&t.props.modelCfg?(0,v.jsx)(ne.Z,{size:"small",style:{width:"60px"},options:Object.keys(t.props.modelCfg).reverse().map((function(e){return r.Rl(e,e)})),value:n,onChange:function(n){t.updateField(e,i,"Ptype",n)}}):n}}],a=["V0","V1","V2","V3","V4","V5"];return(this.props.modelCfg?this.props.modelCfg.p.split(","):a).forEach((function(i,r){n.push({title:i,dataIndex:a[r],width:"200px",render:function(n,i,s){return t.isEditing(s)?(0,v.jsx)(ae.Z,{size:"small",value:n,onChange:function(n){t.updateField(e,s,a[r],n.target.value)}}):n}})})),n.push({title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"150px",render:function(n,a,i){return t.isEditing(i)?(0,v.jsxs)("span",{children:[(0,v.jsx)(d.ZP,{style:{marginRight:"10px"},size:"small",type:"primary",onClick:function(){return t.save(e,i)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{size:"small",onClick:function(){return t.cancel(e,i)},children:Z.Z.t("general:Cancel")})]}):(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"topLeft",title:"Edit",children:(0,v.jsx)(d.ZP,{disabled:""!==t.state.editingIndex||r.CM(t.props.enforcer),style:{marginRight:"5px"},icon:(0,v.jsx)(Pn.Z,{}),size:"small",onClick:function(){return t.edit(a,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:"Delete",children:(0,v.jsx)(d.ZP,{disabled:""!==t.state.editingIndex||r.CM(t.props.enforcer),style:{marginRight:"5px"},icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deletePolicy(e,i)}})})]})}}),(0,v.jsx)(Ee.Z,{pagination:{defaultPageSize:this.pageSize,onChange:function(e){return t.setState({page:e})},current:this.state.page},columns:n,dataSource:e,rowKey:"key",size:"middle",bordered:!0,loading:this.state.loading,title:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(d.ZP,{disabled:""!==t.state.editingIndex||""===t.props.enforcer.model||""===t.props.enforcer.adapter||r.CM(t.props.enforcer),style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})})}})}},{key:"render",value:function(){var e=this;return(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(d.ZP,{disabled:""!==this.state.editingIndex||""===this.props.enforcer.model||""===this.props.enforcer.adapter,style:{marginBottom:"10px",width:"150px"},type:"primary",onClick:function(){e.getPolicies()},children:Z.Z.t("general:Sync")}),this.renderTable(this.state.policyLists)]})}}]),n}(y.Component),Fi=Ii,zi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,enforcerName:e.match.params.enforcerName,enforcer:null,organizations:[],models:[],adapters:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getEnforcer(),this.getOrganizations()}},{key:"getEnforcer",value:function(){var e=this;(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return fetch("".concat(r.nn,"/api/get-enforcer?id=").concat(e,"/").concat(encodeURIComponent(t),"&loadModelCfg=").concat(n),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.organizationName,this.state.enforcerName,!0).then((function(t){null!==t.data?"error"!==t.status?(e.setState({enforcer:t.data}),e.getModels(e.state.organizationName),e.getAdapters(e.state.organizationName)):r.PV("error",t.msg):e.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getModels",value:function(e){var t=this;ci(e).then((function(e){t.setState({models:e.data||[]})}))}},{key:"getAdapters",value:function(e){var t=this;vi(e).then((function(e){t.setState({adapters:e.data||[]})}))}},{key:"parseEnforcerField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateEnforcerField",value:function(e,t){t=this.parseEnforcerField(e,t);var n=this.state.enforcer;n[e]=t,this.setState({enforcer:n})}},{key:"renderEnforcer",value:function(){var e,t=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("enforcer:New Enforcer"):Z.Z.t("enforcer:Edit Enforcer"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return t.submitEnforcerEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return t.submitEnforcerEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return t.deleteEnforcer()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account)||r.CM(this.state.enforcer),value:this.state.enforcer.owner,onChange:function(e){t.updateEnforcerField("owner",e),t.getModels(e),t.getAdapters(e)},options:this.state.organizations.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:r.CM(this.state.enforcer),value:this.state.enforcer.name,onChange:function(e){t.updateEnforcerField("name",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.enforcer.displayName,onChange:function(e){t.updateEnforcerField("displayName",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.enforcer.description,onChange:function(e){t.updateEnforcerField("description",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Model"),Z.Z.t("general:Model - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:r.CM(this.state.enforcer),style:{width:"100%"},value:this.state.enforcer.model,onChange:function(e){t.updateEnforcerField("model",e)},options:this.state.models.map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Adapter"),Z.Z.t("general:Adapter - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:r.CM(this.state.enforcer),style:{width:"100%"},value:this.state.enforcer.adapter,onChange:function(e){t.updateEnforcerField("adapter",e)},options:this.state.adapters.map((function(e){return r.Rl("".concat(e.owner,"/").concat(e.name),"".concat(e.owner,"/").concat(e.name))}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("adapter:Policies"),Z.Z.t("adapter:Policies - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Fi,{enforcer:this.state.enforcer,modelCfg:null===(e=this.state.enforcer)||void 0===e?void 0:e.modelCfg,mode:this.state.mode})})]})]})}},{key:"submitEnforcerEdit",value:function(e){var t=this,n=r.p$(this.state.enforcer);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-enforcer?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.organizationName,this.state.enforcerName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({enforcerName:t.state.enforcer.name}),e?t.props.history.push("/enforcers"):t.props.history.push("/enforcers/".concat(t.state.enforcer.owner,"/").concat(t.state.enforcer.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateEnforcerField("name",t.state.enforcerName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteEnforcer",value:function(){var e=this;wi(this.state.enforcer).then((function(t){"ok"===t.status?e.props.history.push("/enforcers"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.enforcer?this.renderEnforcer():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitEnforcerEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitEnforcerEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteEnforcer()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),Ni=zi;var Ui=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.contentType&&null!==t.contentType&&(n="contentType",i=t.contentType),e.setState({loading:!0}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-sessions?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"deleteSession",value:function(e){var t,n=this;(t=this.state.data[e],fetch("".concat(r.nn,"/api/delete-session"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),n.fetch({pagination:(0,a.Z)((0,a.Z)({},n.state.pagination),{},{current:n.state.pagination.current>1&&1===n.state.data.length?n.state.pagination.current-1:n.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"110px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"180px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("general:Session ID"),dataIndex:"sessionId",key:"sessionId",width:"180px",sorter:!0,render:function(e,t,n){return e.map((function(e,t){return(0,v.jsx)(x.Z,{children:e},t)}))}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"70px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsx)("div",{children:(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteSession(a)}})})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Ei=Ui;function Ri(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-token"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var Li=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;e.setState({loading:!0}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return fetch("".concat(r.nn,"/api/get-tokens?owner=").concat(e,"&organization=").concat(t,"&p=").concat(n,"&pageSize=").concat(a,"&field=").concat(i,"&value=").concat(s,"&sortField=").concat(o,"&sortOrder=").concat(l),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}("admin",r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newToken",value:function(){var e=r.VO(),t=r.jb(this.props.account);return{owner:"admin",name:"token_".concat(e),createdTime:Fe()().format(),application:"app-built-in",organization:t,user:"admin",accessToken:"",expiresIn:7200,scope:"read",tokenType:"Bearer"}}},{key:"addToken",value:function(){var e=this,t=this.newToken();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-token"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/tokens/".concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteToken",value:function(e){var t=this;Ri(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:r.tq()?"100px":"300px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/tokens/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Application"),dataIndex:"application",key:"application",width:"120px",sorter:!0},this.getColumnSearchProps("application")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.organization,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"organization",key:"organization",width:"120px",sorter:!0},this.getColumnSearchProps("organization")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.organization,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("token:Authorization code"),dataIndex:"code",key:"code",width:"180px",sorter:!0},this.getColumnSearchProps("code")),{},{render:function(e,t,n){return r.I5(e)}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("token:Access token"),dataIndex:"accessToken",key:"accessToken",width:"220px",sorter:!0,ellipsis:!0},this.getColumnSearchProps("accessToken")),{},{render:function(e,t,n){return r.I5(e)}}),(0,a.Z)({title:Z.Z.t("token:Expires in"),dataIndex:"expiresIn",key:"expiresIn",width:"120px",sorter:!0},this.getColumnSearchProps("expiresIn")),(0,a.Z)({title:Z.Z.t("provider:Scope"),dataIndex:"scope",key:"scope",width:"110px",sorter:!0},this.getColumnSearchProps("scope")),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/tokens/".concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteToken(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"100%"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Tokens"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addToken.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Oi=Li,Vi=n(41061),qi=ae.Z.TextArea,Di=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,tokenName:e.match.params.tokenName,token:null,mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getToken()}},{key:"getToken",value:function(){var e,t,n=this;(e="admin",t=this.state.tokenName,fetch("".concat(r.nn,"/api/get-token?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){null!==e.data?"error"!==e.status?n.setState({token:e.data}):r.PV("error",e.msg):n.props.history.push("/404")}))}},{key:"parseTokenField",value:function(e,t){return t}},{key:"updateTokenField",value:function(e,t){t=this.parseTokenField(e,t);var n=this.state.token;n[e]=t,this.setState({token:n})}},{key:"parseAccessToken",value:function(e){try{return JSON.stringify((0,Vi.o)(e,{header:!0}),null,2)+"."+JSON.stringify((0,Vi.o)(e),null,2)}catch(t){return t.message}}},{key:"renderToken",value:function(){var e=this,t=r.tq()?22:9,n=this.parseAccessToken(this.state.token.accessToken);return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("token:New Token"):Z.Z.t("token:Edit Token"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitTokenEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitTokenEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteToken()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.name,onChange:function(t){e.updateTokenField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Application"),Z.Z.t("general:Application - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.application,onChange:function(t){e.updateTokenField("application",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!r.VN(this.props.account),value:this.state.token.organization,onChange:function(t){e.updateTokenField("organization",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:User"),Z.Z.t("general:User - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.user,onChange:function(t){e.updateTokenField("user",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("token:Authorization code"),Z.Z.t("token:Authorization code - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.code,onChange:function(t){e.updateTokenField("code",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("token:Expires in"),Z.Z.t("token:Expires in - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.expiresIn,onChange:function(t){e.updateTokenField("expiresIn",parseInt(t.target.value))}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("provider:Scope"),Z.Z.t("provider:Scope - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.scope,onChange:function(t){e.updateTokenField("scope",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("token:Token type"),Z.Z.t("token:Token type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.token.tokenType,onChange:function(t){e.updateTokenField("tokenType",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("token:Access token"),Z.Z.t("token:Access token - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:t,children:[(0,v.jsx)(d.ZP,{type:"primary",style:{marginRight:"10px",marginBottom:"10px"},disabled:""===this.state.token.accessToken,onClick:function(){ot()(e.state.token.accessToken),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("token:Copy access token")}),(0,v.jsx)(qi,{autoSize:{minRows:10,maxRows:200},value:this.state.token.accessToken,onChange:function(t){e.updateTokenField("accessToken",t.target.value)}})]}),(0,v.jsx)(L.Z,{span:1}),(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("token:Parsed result"),Z.Z.t("token:Parsed result - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:t,children:[(0,v.jsx)(d.ZP,{type:"primary",style:{marginRight:"10px",marginBottom:"10px"},disabled:!n.includes('"alg":'),onClick:function(){ot()(n),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("token:Copy parsed result")}),(0,v.jsx)(qi,{autoSize:{minRows:10,maxRows:200},value:n})]})]})]})}},{key:"submitTokenEdit",value:function(e){var t=this,n=r.p$(this.state.token);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-token?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.token.owner,this.state.tokenName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({tokenName:t.state.token.name}),e?t.props.history.push("/tokens"):t.props.history.push("/tokens/".concat(t.state.token.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateTokenField("name",t.state.tokenName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteToken",value:function(){var e=this;Ri(this.state.token).then((function(t){"ok"===t.status?e.props.history.push("/tokens"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.token?this.renderToken():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitTokenEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitTokenEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteToken()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),Mi=n(3478),Bi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),Mi.Xp(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newProduct",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"product_".concat(e),createdTime:Fe()().format(),displayName:"New Product - ".concat(e),image:"".concat(r.WD,"/img/casdoor-logo_1185x256.png"),tag:"Casdoor Summit 2022",currency:"USD",price:300,quantity:99,sold:10,isRecharge:!1,providers:[],state:"Published"}}},{key:"addProduct",value:function(){var e=this,t=this.newProduct();Mi.gK(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/products/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteProduct",value:function(e){var t=this;Mi.Ir(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"140px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/products/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"150px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"170px",sorter:!0},this.getColumnSearchProps("displayName")),{title:Z.Z.t("product:Image"),dataIndex:"image",key:"image",width:"170px",render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:(0,v.jsx)("img",{src:e,alt:e,width:150})})}},(0,a.Z)({title:Z.Z.t("user:Tag"),dataIndex:"tag",key:"tag",width:"160px",sorter:!0},this.getColumnSearchProps("tag")),(0,a.Z)({title:Z.Z.t("payment:Currency"),dataIndex:"currency",key:"currency",width:"120px",sorter:!0},this.getColumnSearchProps("currency")),(0,a.Z)({title:Z.Z.t("product:Price"),dataIndex:"price",key:"price",width:"120px",sorter:!0},this.getColumnSearchProps("price")),(0,a.Z)({title:Z.Z.t("product:Quantity"),dataIndex:"quantity",key:"quantity",width:"120px",sorter:!0},this.getColumnSearchProps("quantity")),(0,a.Z)({title:Z.Z.t("product:Sold"),dataIndex:"sold",key:"sold",width:"120px",sorter:!0},this.getColumnSearchProps("sold")),(0,a.Z)({title:Z.Z.t("general:State"),dataIndex:"state",key:"state",width:"120px",sorter:!0},this.getColumnSearchProps("state")),(0,a.Z)((0,a.Z)({title:Z.Z.t("product:Payment providers"),dataIndex:"providers",key:"providers",width:"500px"},this.getColumnSearchProps("providers")),{},{render:function(e,n,a){var i=n.owner,s=e;if(0===s.length)return"(".concat(Z.Z.t("general:empty"),")");var o=Math.floor((s.length+1)/2),c=function(e){return(0,v.jsx)(se.Z,{size:"small",locale:{emptyText:" "},dataSource:e,renderItem:function(e,n,a){return(0,v.jsx)(se.Z.Item,{children:(0,v.jsxs)("div",{style:{display:"inline"},children:[(0,v.jsx)(l.Z,{placement:"topLeft",title:"Edit",children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},icon:(0,v.jsx)(Pn.Z,{}),size:"small",onClick:function(){return r.d8(t,"/providers/".concat(i,"/").concat(e))}})}),(0,v.jsx)(T.rU,{to:"/providers/".concat(i,"/").concat(e),children:e})]})})}})};return(0,v.jsx)("div",{children:(0,v.jsxs)(R.Z,{children:[(0,v.jsx)(L.Z,{span:12,children:c(s.slice(0,o))}),(0,v.jsx)(L.Z,{span:12,children:c(s.slice(o))})]})})}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"230px",fixed:r.tq()?"false":"right",render:function(e,n,a){var i="auto_created_product_for_plan"===n.tag;return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},onClick:function(){return t.props.history.push("/products/".concat(n.owner,"/").concat(n.name,"/buy"))},children:Z.Z.t("product:Buy")}),(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/products/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{disabled:i,title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteProduct(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Products"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addProduct.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Wi=Bi,Hi=n(67130),Gi=ne.Z.Option,Ji=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,productName:e.match.params.productName,product:null,providers:[],organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getProduct(),this.getOrganizations(),this.getPaymentProviders(this.state.organizationName)}},{key:"getProduct",value:function(){var e=this;Mi.wv(this.state.organizationName,this.state.productName).then((function(t){null!==t.data?e.setState({product:t.data}):e.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getPaymentProviders",value:function(e){var t=this;ia.J9(e).then((function(e){"ok"===e.status?t.setState({providers:e.data.filter((function(e){return"Payment"===e.category}))}):r.PV("error",e.msg)}))}},{key:"parseProductField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateProductField",value:function(e,t){t=this.parseProductField(e,t);var n=this.state.product;n[e]=t,this.setState({product:n})}},{key:"renderProduct",value:function(){var e=this,t="auto_created_product_for_plan"===this.state.product.tag;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("product:New Product"):Z.Z.t("product:Edit Product"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitProductEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitProductEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteProduct()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account)||t,value:this.state.product.owner,onChange:function(t){e.updateProductField("owner",t)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(Gi,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.product.name,disabled:t,onChange:function(t){e.updateProductField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.product.displayName,onChange:function(t){e.updateProductField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Image"),Z.Z.t("product:Image - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,style:r.tq()?{maxWidth:"100%"}:{},children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.product.image,onChange:function(t){e.updateProductField("image",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:1,children:[Z.Z.t("general:Preview"),":"]}),(0,v.jsx)(L.Z,{span:23,children:(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:this.state.product.image,children:(0,v.jsx)("img",{src:this.state.product.image,alt:this.state.product.image,height:90,style:{marginBottom:"20px"}})})})]})]})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Tag"),Z.Z.t("product:Tag - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.product.tag,disabled:t,onChange:function(t){e.updateProductField("tag",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Detail"),Z.Z.t("product:Detail - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.product.detail,onChange:function(t){e.updateProductField("detail",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.product.description,onChange:function(t){e.updateProductField("description",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Currency"),Z.Z.t("payment:Currency - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.product.currency,disabled:t,onChange:function(t){e.updateProductField("currency",t)},children:[{id:"USD",name:"USD"},{id:"CNY",name:"CNY"},{id:"EUR",name:"EUR"},{id:"JPY",name:"JPY"},{id:"GBP",name:"GBP"},{id:"AUD",name:"AUD"},{id:"CAD",name:"CAD"},{id:"CHF",name:"CHF"},{id:"HKD",name:"HKD"},{id:"SGD",name:"SGD"}].map((function(e,t){return(0,v.jsx)(Gi,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Is recharge"),Z.Z.t("product:Is recharge - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(re.Z,{checked:this.state.product.isRecharge,onChange:function(t){e.updateProductField("isRecharge",t)}})})]}),this.state.product.isRecharge?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Price"),Z.Z.t("product:Price - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.product.price,disabled:t,onChange:function(t){e.updateProductField("price",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Quantity"),Z.Z.t("product:Quantity - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.product.quantity,disabled:t,onChange:function(t){e.updateProductField("quantity",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Sold"),Z.Z.t("product:Sold - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.product.sold,disabled:t,onChange:function(t){e.updateProductField("sold",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Payment providers"),Z.Z.t("product:Payment providers - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},disabled:t,value:this.state.product.providers,onChange:function(t){e.updateProductField("providers",t)},children:this.state.providers.map((function(e,t){return(0,v.jsx)(Gi,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Return URL"),Z.Z.t("product:Return URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.product.returnUrl,onChange:function(t){e.updateProductField("returnUrl",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:State"),Z.Z.t("general:State - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.product.state,onChange:function(t){e.updateProductField("state",t)},children:[{id:"Published",name:"Published"},{id:"Draft",name:"Draft"}].map((function(e,t){return(0,v.jsx)(Gi,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Preview"),Z.Z.t("general:Preview - Tooltip"))," :"]}),this.renderPreview()]})]})}},{key:"renderPreview",value:function(){var e="/products/".concat(this.state.product.owner,"/").concat(this.state.product.name,"/buy");return(0,v.jsxs)(L.Z,{span:22,style:{display:"flex",flexDirection:"column"},children:[(0,v.jsx)("a",{style:{marginBottom:"10px",display:"flex"},target:"_blank",rel:"noreferrer",href:e,children:(0,v.jsx)(d.ZP,{type:"primary",children:Z.Z.t("product:Test buy page..")})}),(0,v.jsx)("br",{}),(0,v.jsx)("br",{}),(0,v.jsx)("div",{style:{width:"90%",border:"1px solid rgb(217,217,217)",boxShadow:"10px 10px 5px #888888",alignItems:"center",overflow:"auto",flexDirection:"column",flex:"auto"},children:(0,v.jsx)(Hi.Z,{product:this.state.product})})]})}},{key:"submitProductEdit",value:function(e){var t=this,n=r.p$(this.state.product);Mi.nM(this.state.organizationName,this.state.productName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({productName:t.state.product.name}),e?t.props.history.push("/products"):t.props.history.push("/products/".concat(t.state.product.owner,"/").concat(t.state.product.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateProductField("name",t.state.productName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteProduct",value:function(){var e=this;Mi.Ir(this.state.product).then((function(t){"ok"===t.status?e.props.history.push("/products"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.product?this.renderProduct():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitProductEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitProductEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteProduct()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),Qi=n(27076),Ki=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),Qi._P(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newPayment",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"payment_".concat(e),createdTime:Fe()().format(),displayName:"New Payment - ".concat(e),provider:"provider_pay_paypal",type:"PayPal",user:"admin",productName:"computer-1",productDisplayName:"A notebook computer",detail:"This is a computer with excellent CPU, memory and disk",tag:"Promotion-1",currency:"USD",price:300,payUrl:"https://pay.com/pay.php",returnUrl:"https://door.casdoor.com/payments",state:"Paid",message:""}}},{key:"addPayment",value:function(){var e=this,t=this.newPayment();Qi._w(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/payments/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deletePayment",value:function(e){var t=this;Qi.bi(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"180px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/payments/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Provider"),dataIndex:"provider",key:"provider",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("provider")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/providers/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"140px",align:"center",filterMultiple:!1,filters:r.oz("Payment").map((function(e){return{text:e.id,value:e.name}})),sorter:!0,render:function(e,t,n){return t.category="Payment",la.Il(t)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("payment:Product"),dataIndex:"productDisplayName",key:"productDisplayName",sorter:!0},this.getColumnSearchProps("productDisplayName")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/products/".concat(t.owner,"/").concat(t.productName),children:e})}}),(0,a.Z)({title:Z.Z.t("product:Price"),dataIndex:"price",key:"price",width:"120px",sorter:!0},this.getColumnSearchProps("price")),(0,a.Z)({title:Z.Z.t("payment:Currency"),dataIndex:"currency",key:"currency",width:"120px",sorter:!0},this.getColumnSearchProps("currency")),(0,a.Z)({title:Z.Z.t("general:State"),dataIndex:"state",key:"state",width:"120px",sorter:!0},this.getColumnSearchProps("state")),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"240px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},onClick:function(){return t.props.history.push("/payments/".concat(n.owner,"/").concat(n.name,"/result"))},children:Z.Z.t("payment:Result")}),(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/payments/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deletePayment(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Payments"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addPayment.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),_i=Ki,$i=n(82484),Yi=ne.Z.Option,Xi=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,paymentName:e.match.params.paymentName,payment:null,isModalVisible:!1,isInvoiceLoading:!1,mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getPayment()}},{key:"getPayment",value:function(){var e=this;Qi.nx(this.state.organizationName,this.state.paymentName).then((function(t){null!==t.data?(e.setState({payment:t.data}),r.cx("invoice-area")):e.props.history.push("/404")}))}},{key:"parsePaymentField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updatePaymentField",value:function(e,t){t=this.parsePaymentField(e,t);var n=this.state.payment;n[e]=t,this.setState({payment:n})}},{key:"issueInvoice",value:function(){var e=this;this.setState({isModalVisible:!1,isInvoiceLoading:!0}),Qi.we(this.state.payment.owner,this.state.paymentName).then((function(t){e.setState({isInvoiceLoading:!1}),"ok"===t.status?(r.PV("success","Successfully invoiced"),r.$y(t.data),e.getPayment()):r.PV(t.msg.includes("\u6210\u529f")?"info":"error",t.msg)})).catch((function(t){e.setState({isInvoiceLoading:!1}),r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(t))}))}},{key:"downloadInvoice",value:function(){r.$y(this.state.payment.invoiceUrl)}},{key:"renderModal",value:function(){var e,t,n,a,i,r,s,o,l=this,c=this;return(0,v.jsx)(ge.Z,{title:(0,v.jsxs)("div",{children:[(0,v.jsx)($i.Z,{twoToneColor:"rgb(45,120,213)"})," "+Z.Z.t("payment:Confirm your invoice information")]}),open:this.state.isModalVisible,onOk:function(){c.issueInvoice()},onCancel:function(){l.setState({isModalVisible:!1})},okText:Z.Z.t("payment:Issue Invoice"),cancelText:Z.Z.t("general:Cancel"),children:(0,v.jsxs)("p",{children:[Z.Z.t("payment:Please carefully check your invoice information. Once the invoice is issued, it cannot be withdrawn or modified."),(0,v.jsx)("br",{}),(0,v.jsx)("br",{}),(0,v.jsxs)(Da.Z,{size:"small",bordered:!0,children:[(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Person name"),span:3,children:null===(e=this.state.payment)||void 0===e?void 0:e.personName}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Person ID card"),span:3,children:null===(t=this.state.payment)||void 0===t?void 0:t.personIdCard}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Person Email"),span:3,children:null===(n=this.state.payment)||void 0===n?void 0:n.personEmail}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Person phone"),span:3,children:null===(a=this.state.payment)||void 0===a?void 0:a.personPhone}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Invoice type"),span:3,children:"Individual"===(null===(i=this.state.payment)||void 0===i?void 0:i.invoiceType)?Z.Z.t("payment:Individual"):Z.Z.t("general:Organization")}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Invoice title"),span:3,children:null===(r=this.state.payment)||void 0===r?void 0:r.invoiceTitle}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Invoice tax ID"),span:3,children:null===(s=this.state.payment)||void 0===s?void 0:s.invoiceTaxId}),(0,v.jsx)(Da.Z.Item,{label:Z.Z.t("payment:Invoice remark"),span:3,children:null===(o=this.state.payment)||void 0===o?void 0:o.invoiceRemark})]})]})})}},{key:"renderPayment",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("payment:New Payment"):Z.Z.t("payment:Edit Payment"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitPaymentEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitPaymentEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deletePayment()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.owner,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.name,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.displayName,onChange:function(t){e.updatePaymentField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Provider"),Z.Z.t("general:Provider - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.provider,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Type"),Z.Z.t("payment:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.type,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Product"),Z.Z.t("payment:Product - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.productName,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Price"),Z.Z.t("product:Price - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.price,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Currency"),Z.Z.t("payment:Currency - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.currency,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:State"),Z.Z.t("general:State - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.state,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Message"),Z.Z.t("payment:Message - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.message,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Person name"),Z.Z.t("payment:Person name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl,value:this.state.payment.personName,onChange:function(t){e.updatePaymentField("personName",t.target.value),"Individual"===e.state.payment.invoiceType&&(e.updatePaymentField("invoiceTitle",t.target.value),e.updatePaymentField("invoiceTaxId",""))}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Person ID card"),Z.Z.t("payment:Person ID card - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl,value:this.state.payment.personIdCard,onChange:function(t){e.updatePaymentField("personIdCard",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Person Email"),Z.Z.t("payment:Person Email - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl,value:this.state.payment.personEmail,onChange:function(t){e.updatePaymentField("personEmail",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Person phone"),Z.Z.t("payment:Person phone - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl,value:this.state.payment.personPhone,onChange:function(t){e.updatePaymentField("personPhone",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Invoice type"),Z.Z.t("payment:Invoice type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:""!==this.state.payment.invoiceUrl,style:{width:"100%"},value:this.state.payment.invoiceType,onChange:function(t){e.updatePaymentField("invoiceType",t),"Individual"===t&&(e.updatePaymentField("invoiceTitle",e.state.payment.personName),e.updatePaymentField("invoiceTaxId",""))},children:[{id:"Individual",name:Z.Z.t("payment:Individual")},{id:"Organization",name:Z.Z.t("general:Organization")}].map((function(e,t){return(0,v.jsx)(Yi,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Invoice title"),Z.Z.t("payment:Invoice title - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl||"Individual"===this.state.payment.invoiceType,value:this.state.payment.invoiceTitle,onChange:function(t){e.updatePaymentField("invoiceTitle",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Invoice tax ID"),Z.Z.t("payment:Invoice tax ID - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl||"Individual"===this.state.payment.invoiceType,value:this.state.payment.invoiceTaxId,onChange:function(t){e.updatePaymentField("invoiceTaxId",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Invoice remark"),Z.Z.t("payment:Invoice remark - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:""!==this.state.payment.invoiceUrl,value:this.state.payment.invoiceRemark,onChange:function(t){e.updatePaymentField("invoiceRemark",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Invoice URL"),Z.Z.t("payment:Invoice URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.payment.invoiceUrl,onChange:function(t){e.updatePaymentField("invoiceUrl",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{id:"invoice-area",style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Invoice actions"),Z.Z.t("payment:Invoice actions - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:22,children:[""===this.state.payment.invoiceUrl?(0,v.jsx)(d.ZP,{type:"primary",loading:this.state.isInvoiceLoading,onClick:function(){var t=e.checkError();""===t?e.setState({isModalVisible:!0}):r.PV("error",t)},children:Z.Z.t("payment:Issue Invoice")}):(0,v.jsx)(d.ZP,{type:"primary",onClick:function(){return e.downloadInvoice(!1)},children:Z.Z.t("payment:Download Invoice")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return r.iF(e.state.payment.returnUrl)},children:Z.Z.t("payment:Return to Website")})]})]})]})}},{key:"checkError",value:function(){if("Paid"!==this.state.payment.state)return Z.Z.t("payment:Please pay the order first!");if(!r.z0(this.state.payment.personName))return Z.Z.t("signup:Please input your real name!");if(!r.kS(this.state.payment.personIdCard))return Z.Z.t("signup:Please input the correct ID card number!");if(!r.vV(this.state.payment.personEmail))return Z.Z.t("signup:The input is not valid Email!");if(!r.kj(this.state.payment.personPhone))return Z.Z.t("signup:The input is not valid Phone!");if(!r.kj(this.state.payment.personPhone))return Z.Z.t("signup:The input is not valid Phone!");if("Individual"===this.state.payment.invoiceType){if(this.state.payment.invoiceTitle!==this.state.payment.personName)return Z.Z.t("signup:The input is not invoice title!");if(""!==this.state.payment.invoiceTaxId)return Z.Z.t("signup:The input is not invoice Tax ID!")}else{if(!r.Pm(this.state.payment.invoiceTitle))return Z.Z.t("signup:The input is not invoice title!");if(!r.e9(this.state.payment.invoiceTaxId))return Z.Z.t("signup:The input is not invoice Tax ID!")}return""}},{key:"submitPaymentEdit",value:function(e){var t=this,n=this.checkError();if(""===n){var a=r.p$(this.state.payment);Qi.cQ(this.state.payment.owner,this.state.paymentName,a).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({paymentName:t.state.payment.name}),e?t.props.history.push("/payments"):t.props.history.push("/payments/".concat(t.state.payment.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updatePaymentField("name",t.state.paymentName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}else r.PV("error",n)}},{key:"deletePayment",value:function(){var e=this;Qi.bi(this.state.payment).then((function(t){"ok"===t.status?e.props.history.push("/payments"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.payment?this.renderPayment():null,this.renderModal(),(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitPaymentEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitPaymentEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deletePayment()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),er=n(76649),tr=n(54285),nr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),tr.qY(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newPlan",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"plan_".concat(e),createdTime:Fe()().format(),displayName:"New Plan - ".concat(e),description:"",price:10,currency:"USD",period:"Monthly",isEnabled:!0,paymentProviders:[],role:"",options:[]}}},{key:"addPlan",value:function(){var e=this,t=this.newPlan();tr.n4(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/plans/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deletePlan",value:function(e){var t=this;tr.Kh(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"140px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/plans/".concat(t.owner,"/").concat(t.name),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"170px",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)({title:Z.Z.t("payment:Currency"),dataIndex:"currency",key:"currency",width:"120px",sorter:!0},this.getColumnSearchProps("currency")),(0,a.Z)({title:Z.Z.t("plan:Price"),dataIndex:"price",key:"price",width:"130px"},this.getColumnSearchProps("price")),(0,a.Z)({title:Z.Z.t("plan:Period"),dataIndex:"period",key:"period",width:"130px"},this.getColumnSearchProps("period")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Role"),dataIndex:"role",key:"role",width:"140px"},this.getColumnSearchProps("role")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/roles/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("plan:Related product"),dataIndex:"product",key:"product",width:"130px"},this.getColumnSearchProps("product")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/products/".concat(t.owner,"/").concat(e),children:e})}}),{title:Z.Z.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"200px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/plans/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deletePlan(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Plans"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addPlan.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),ar=nr,ir=ne.Z.Option,rr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a,i,r,s,o,l,c,d,p,u;return(0,G.Z)(this,n),(u=t.call(this,e)).state={classes:e,organizationName:null!==(a=null!==(i=null===e||void 0===e?void 0:e.organizationName)&&void 0!==i?i:null===e||void 0===e||null===(r=e.match)||void 0===r||null===(s=r.params)||void 0===s?void 0:s.organizationName)&&void 0!==a?a:null,planName:null!==(o=null===e||void 0===e||null===(l=e.match)||void 0===l||null===(c=l.params)||void 0===c?void 0:c.planName)&&void 0!==o?o:null,plan:null,organizations:[],users:[],roles:[],paymentProviders:[],mode:null!==(d=null===e||void 0===e||null===(p=e.location)||void 0===p?void 0:p.mode)&&void 0!==d?d:"edit"},u}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getPlan(),this.getOrganizations()}},{key:"getPlan",value:function(){var e=this;tr.Wh(this.state.organizationName,this.state.planName).then((function(t){null!==t.data?(e.setState({plan:t.data}),e.getUsers(e.state.organizationName),e.getRoles(e.state.organizationName),e.getPaymentProviders(e.state.organizationName)):e.props.history.push("/404")}))}},{key:"getRoles",value:function(e){var t=this;Xa(e).then((function(e){"error"!==e.status?t.setState({roles:e.data}):r.PV("error",e.msg)}))}},{key:"getUsers",value:function(e){var t=this;ue.getUsers(e).then((function(e){"error"!==e.status?t.setState({users:e.data}):r.PV("error",e.msg)}))}},{key:"getPaymentProviders",value:function(e){var t=this;ia.J9(e).then((function(e){"ok"!==e.status?r.PV("error",e.msg):t.setState({paymentProviders:e.data.filter((function(e){return"Payment"===e.category}))})}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"parsePlanField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updatePlanField",value:function(e,t){t=this.parsePlanField(e,t);var n=this.state.plan;n[e]=t,this.setState({plan:n})}},{key:"renderPlan",value:function(){var e,t=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("plan:New Plan"):Z.Z.t("plan:Edit Plan"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return t.submitPlanEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return t.submitPlanEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return t.deletePlan()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.plan.owner,onChange:function(e){t.updatePlanField("owner",e),t.getUsers(e),t.getRoles(e)},options:this.state.organizations.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.plan.name,onChange:function(e){t.updatePlanField("name",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.plan.displayName,onChange:function(e){t.updatePlanField("displayName",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Role"),Z.Z.t("general:Role - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.plan.role,onChange:function(e){t.updatePlanField("role",e)},options:this.state.roles.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.plan.description,onChange:function(e){t.updatePlanField("description",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("plan:Price"),Z.Z.t("plan:Price - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.plan.price,onChange:function(e){t.updatePlanField("price",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("plan:Period"),Z.Z.t("plan:Period - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.plan.period,onChange:function(e){t.updatePlanField("period",e)},options:[{value:"Monthly",label:"Monthly"},{value:"Yearly",label:"Yearly"}]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Currency"),Z.Z.t("payment:Currency - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.plan.currency,onChange:function(e){t.updatePlanField("currency",e)},children:[{id:"USD",name:"USD"},{id:"CNY",name:"CNY"}].map((function(e,t){return(0,v.jsx)(ir,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Payment providers"),Z.Z.t("product:Payment providers - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:null!==(e=this.state.plan.paymentProviders)&&void 0!==e?e:[],onChange:function(e){t.updatePlanField("paymentProviders",e)},children:this.state.paymentProviders.map((function(e,t){return(0,v.jsx)(ir,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.plan.isEnabled,onChange:function(e){t.updatePlanField("isEnabled",e)}})})]})]})}},{key:"submitPlanEdit",value:function(e){var t=this,n=r.p$(this.state.plan);tr.Vs(this.state.organizationName,this.state.planName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({planName:t.state.plan.name}),e?t.props.history.push("/plans"):t.props.history.push("/plans/".concat(t.state.plan.owner,"/").concat(t.state.plan.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updatePlanField("name",t.state.planName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deletePlan",value:function(){var e=this;tr.Kh(this.state.plan).then((function(t){"ok"===t.status?e.props.history.push("/plans"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.plan?this.renderPlan():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitPlanEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitPlanEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deletePlan()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),sr=n(2308),or=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),sr.HU(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newPricing",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"pricing_".concat(e),createdTime:Fe()().format(),plans:[],displayName:"New Pricing - ".concat(e),isEnabled:!0,trialDuration:7}}},{key:"addPricing",value:function(){var e=this,t=this.newPricing();sr.Q4(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/pricings/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deletePricing",value:function(e){var t=this;sr.qw(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"140px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/pricings/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"170px",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Application"),dataIndex:"application",key:"application",width:"170px",sorter:!0},this.getColumnSearchProps("application")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Plans"),dataIndex:"plans",key:"plans",sorter:!0},this.getColumnSearchProps("plans")),{},{render:function(e,n,a){return 0===e.length?"(".concat(Z.Z.t("general:empty"),")"):(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{children:e.map((function(e){return(0,v.jsx)(L.Z,{children:(0,v.jsxs)("div",{style:{display:"inline",marginRight:"20px"},children:[(0,v.jsx)(l.Z,{placement:"topLeft",title:"Edit",children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},icon:(0,v.jsx)(Pn.Z,{}),size:"small",onClick:function(){return r.d8(t,"/plans/".concat(n.owner,"/").concat(e))}})}),(0,v.jsx)(T.rU,{to:"/plans/".concat(n.owner,"/").concat(e),children:e})]})},e)}))})})}}),{title:Z.Z.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"230px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/pricings/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deletePricing(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Pricings"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addPricing.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),lr=or,cr=n(19424),dr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,pricingName:e.match.params.pricingName,organizations:[],applications:[],pricing:null,plans:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getPricing(),this.getOrganizations(),this.getApplicationsByOrganization(this.state.organizationName)}},{key:"getPricing",value:function(){var e=this;sr.Qb(this.state.organizationName,this.state.pricingName).then((function(t){null!==t.data?"error"!==t.status?(e.setState({pricing:t.data}),e.getPlans(e.state.organizationName)):r.PV("error",t.msg):e.props.history.push("/404")}))}},{key:"getPlans",value:function(e){var t=this;tr.qY(e).then((function(e){"error"!==e.status?t.setState({plans:e.data}):r.PV("error",e.msg)}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getApplicationsByOrganization",value:function(e){var t=this;W.rW("admin",e).then((function(e){t.setState({applications:e.data||[]})}))}},{key:"parsePricingField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updatePricingField",value:function(e,t){t=this.parsePricingField(e,t);var n=this.state.pricing;n[e]=t,this.setState({pricing:n})}},{key:"renderPricing",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("pricing:New Pricing"):Z.Z.t("pricing:Edit Pricing"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitPricingEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitPricingEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deletePricing()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.pricing.owner,onChange:function(t){e.updatePricingField("owner",t),e.getApplicationsByOrganization(t),e.getPlans(t)},options:this.state.organizations.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.pricing.name,onChange:function(t){e.updatePricingField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.pricing.displayName,onChange:function(t){e.updatePricingField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.pricing.description,onChange:function(t){e.updatePricingField("description",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Application"),Z.Z.t("general:Application - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.pricing.application,onChange:function(t){e.updatePricingField("application",t)},options:this.state.applications.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Plans"),Z.Z.t("general:Plans - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.pricing.plans,onChange:function(t){e.updatePricingField("plans",t)},options:this.state.plans.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("pricing:Trial duration"),Z.Z.t("pricing:Trial duration - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{min:0,value:this.state.pricing.trialDuration,onChange:function(t){e.updatePricingField("trialDuration",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.pricing.isEnabled,onChange:function(t){e.updatePricingField("isEnabled",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Preview"),Z.Z.t("general:Preview - Tooltip"))," :"]}),this.renderPreview()]})]})}},{key:"submitPricingEdit",value:function(e){var t=this,n=r.p$(this.state.pricing);sr.y0(this.state.organizationName,this.state.pricingName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({pricingName:t.state.pricing.name}),e?t.props.history.push("/pricings"):t.props.history.push("/pricings/".concat(t.state.pricing.owner,"/").concat(t.state.pricing.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updatePricingField("name",t.state.pricingName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deletePricing",value:function(){var e=this;sr.qw(this.state.pricing).then((function(t){"ok"===t.status?e.props.history.push("/pricings"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.pricing?this.renderPricing():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitPricingEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitPricingEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deletePricing()},children:Z.Z.t("general:Cancel")}):null]})]})}},{key:"renderPreview",value:function(){var e="/select-plan/".concat(this.state.pricing.owner,"/").concat(this.state.pricing.name);return(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(L.Z,{children:(0,v.jsx)(d.ZP,{style:{marginBottom:"10px",marginTop:r.tq()?"15px":"0"},type:"primary",shape:"round",icon:(0,v.jsx)(ta.Z,{}),onClick:function(){ot()("".concat(window.location.origin).concat(e)),r.PV("success",Z.Z.t("general:Copied to clipboard successfully"))},children:Z.Z.t("pricing:Copy pricing page URL")})}),(0,v.jsx)(L.Z,{children:(0,v.jsx)(cr.Z,{pricing:this.state.pricing,owner:this.state.pricing.owner})})]})}}]),n}(y.Component),pr=n(3598),ur=n(43065),hr=n(5049),gr=n(13495),mr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),gr.tJ(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newSubscription",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"sub_".concat(e),createdTime:Fe()().format(),displayName:"New Subscription - ".concat(e),startTime:Fe()().format(),endTime:Fe()().add(30,"d").format(),period:"Monthly",description:"",user:"",plan:"",state:"Active"}}},{key:"addSubscription",value:function(){var e=this,t=this.newSubscription();gr.VF(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/subscriptions/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteSubscription",value:function(e){var t=this;gr.X$(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"140px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/subscriptions/".concat(t.owner,"/").concat(t.name),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"170px",sorter:!0},this.getColumnSearchProps("displayName")),(0,a.Z)({title:Z.Z.t("subscription:Period"),dataIndex:"period",key:"period",width:"140px"},this.getColumnSearchProps("period")),(0,a.Z)({title:Z.Z.t("subscription:Start time"),dataIndex:"startTime",key:"startTime",width:"140px"},this.getColumnSearchProps("startTime")),(0,a.Z)({title:Z.Z.t("subscription:End time"),dataIndex:"endTime",key:"endTime",width:"140px"},this.getColumnSearchProps("endTime")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Plan"),dataIndex:"plan",key:"plan",width:"140px"},this.getColumnSearchProps("plan")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/plans/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"140px"},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Payment"),dataIndex:"payment",key:"payment",width:"140px"},this.getColumnSearchProps("payment")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/payments/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:State"),dataIndex:"state",key:"state",width:"120px",sorter:!0},this.getColumnSearchProps("state")),{},{render:function(e,t,n){switch(e){case"Pending":return r.h1("processing",Z.Z.t("subscription:Pending"),(0,v.jsx)(pr.Z,{}));case"Active":return r.h1("success",Z.Z.t("subscription:Active"),(0,v.jsx)(Rn.Z,{spin:!0}));case"Upcoming":return r.h1("warning",Z.Z.t("subscription:Upcoming"),(0,v.jsx)(ur.Z,{}));case"Expired":return r.h1("warning",Z.Z.t("subscription:Expired"),(0,v.jsx)(ur.Z,{}));case"Error":return r.h1("error",Z.Z.t("subscription:Error"),(0,v.jsx)(hr.Z,{}));case"Suspended":return r.h1("default",Z.Z.t("subscription:Suspended"),(0,v.jsx)(Ln.Z,{}));default:return null}}}),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"230px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/subscriptions/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteSubscription(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Subscriptions"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addSubscription.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),xr=mr,Zr=n(19414),yr=n(10658),fr=n.n(yr),vr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,subscriptionName:e.match.params.subscriptionName,subscription:null,organizations:[],users:[],pricings:[],plans:[],providers:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getSubscription(),this.getOrganizations()}},{key:"getSubscription",value:function(){var e=this;gr.pI(this.state.organizationName,this.state.subscriptionName).then((function(t){null!==t.data?"error"!==t.status?(e.setState({subscription:t.data}),e.getUsers(e.state.organizationName),e.getPricings(e.state.organizationName),e.getPlans(e.state.organizationName)):r.PV("error",t.msg):e.props.history.push("/404")}))}},{key:"getPricings",value:function(e){var t=this;sr.HU(e).then((function(e){t.setState({pricings:e.data})}))}},{key:"getPlans",value:function(e){var t=this;tr.qY(e).then((function(e){t.setState({plans:e.data})}))}},{key:"getUsers",value:function(e){var t=this;ue.getUsers(e).then((function(e){"error"!==e.status?t.setState({users:e.data}):r.PV("error",e.msg)}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"parseSubscriptionField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"updateSubscriptionField",value:function(e,t){t=this.parseSubscriptionField(e,t);var n=this.state.subscription;n[e]=t,this.setState({subscription:n})}},{key:"renderSubscription",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("subscription:New Subscription"):Z.Z.t("subscription:Edit Subscription"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitSubscriptionEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitSubscriptionEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteSubscription()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.subscription.owner,onChange:function(t){e.updateSubscriptionField("owner",t),e.getUsers(t),e.getPlans(t)},options:this.state.organizations.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.subscription.name,onChange:function(t){e.updateSubscriptionField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.subscription.displayName,onChange:function(t){e.updateSubscriptionField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("subscription:Start time"),Z.Z.t("subscription:Start time - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Zr.Z,{value:fr()(this.state.subscription.startTime),onChange:function(t){e.updateSubscriptionField("startTime",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsx)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:r.id(Z.Z.t("subscription:End time"),Z.Z.t("subscription:End time - Tooltip"))}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Zr.Z,{value:fr()(this.state.subscription.endTime),onChange:function(t){e.updateSubscriptionField("endTime",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("plan:Period"),Z.Z.t("plan:Period - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{defaultValue:""===this.state.subscription.period?"Monthly":this.state.subscription.period,onChange:function(t){e.updateSubscriptionField("period",t)},options:[{value:"Monthly",label:"Monthly"},{value:"Yearly",label:"Yearly"}]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:User"),Z.Z.t("general:User - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{style:{width:"100%"},value:this.state.subscription.user,onChange:function(t){e.updateSubscriptionField("user",t)},options:this.state.users.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Pricing"),Z.Z.t("general:Pricing - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.subscription.pricing,onChange:function(t){e.updateSubscriptionField("pricing",t)},options:this.state.pricings.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Plan"),Z.Z.t("general:Plan - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.subscription.plan,onChange:function(t){e.updateSubscriptionField("plan",t)},options:this.state.plans.map((function(e){return r.Rl(e.name,e.name)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Payment"),Z.Z.t("general:Payment - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.subscription.payment,disabled:!0,onChange:function(t){e.updateSubscriptionField("payment",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Description"),Z.Z.t("general:Description - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.subscription.description,onChange:function(t){e.updateSubscriptionField("description",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:State"),Z.Z.t("general:State - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,disabled:!r.$J(this.props.account),style:{width:"100%"},value:this.state.subscription.state,onChange:function(t){e.state.subscription.state!==t&&("Approved"===t?(e.updateSubscriptionField("approver",e.props.account.name),e.updateSubscriptionField("approveTime",Fe()().format())):(e.updateSubscriptionField("approver",""),e.updateSubscriptionField("approveTime",""))),e.updateSubscriptionField("state",t)},options:[{value:"Pending",name:Z.Z.t("subscription:Pending")},{value:"Active",name:Z.Z.t("subscription:Active")},{value:"Upcoming",name:Z.Z.t("subscription:Upcoming")},{value:"Expired",name:Z.Z.t("subscription:Expired")},{value:"Error",name:Z.Z.t("subscription:Error")},{value:"Suspended",name:Z.Z.t("subscription:Suspended")}].map((function(e){return r.Rl(e.name,e.value)}))})})]})]})}},{key:"submitSubscriptionEdit",value:function(e){var t=this,n=r.p$(this.state.subscription);gr.Mg(this.state.organizationName,this.state.subscriptionName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({subscriptionName:t.state.subscription.name}),e?t.props.history.push("/subscriptions"):t.props.history.push("/subscriptions/".concat(t.state.subscription.owner,"/").concat(t.state.subscription.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateSubscriptionField("name",t.state.subscriptionName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteSubscription",value:function(){var e=this;gr.X$(this.state.subscription).then((function(t){"ok"===t.status?e.props.history.push("/subscriptions"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.subscription?this.renderSubscription():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitSubscriptionEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitSubscriptionEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteSubscription()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),jr=n(31196),Tr=n(87785);function kr(){return fetch("".concat(r.nn,"/api/get-system-info"),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var Cr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={table:e.table},a}return(0,J.Z)(n,[{key:"render",value:function(){var e=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name"},{title:Z.Z.t("general:Method"),dataIndex:"method",key:"method"},{title:Z.Z.t("system:Count"),dataIndex:"count",key:"count"},{title:Z.Z.t("system:Latency")+"(ms)",dataIndex:"latency",key:"latency"}],t=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name"},{title:Z.Z.t("general:Method"),dataIndex:"method",key:"method"},{title:Z.Z.t("system:Throughput"),dataIndex:"throughput",key:"throughput"}];return"latency"===this.state.table?(0,v.jsx)("div",{style:{height:"300px",overflow:"auto"},children:(0,v.jsx)(Ee.Z,{columns:e,dataSource:this.props.prometheusInfo.apiLatency,pagination:!1})}):"throughput"===this.state.table?(0,v.jsxs)("div",{style:{height:"300px",overflow:"auto"},children:[Z.Z.t("system:Total Throughput"),": ",this.props.prometheusInfo.totalThroughput,(0,v.jsx)(Ee.Z,{columns:t,dataSource:this.props.prometheusInfo.apiThroughput,pagination:!1})]}):void 0}}]),n}(y.Component),br=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).handleTourChange=function(){a.setState({isTourVisible:M.x5()})},a.setIsTourVisible=function(){M.o4(!1),a.setState({isTourVisible:!1})},a.handleTourComplete=function(){var e=M.ny();""!==e&&(a.props.history.push("/"+e),M.o4(!0))},a.getSteps=function(){var e=M.ny(),t=M.It();return t.map((function(n,a){n.target=function(){return document.getElementById(n.id)||null},a===t.length-1&&(n.nextButtonProps={children:M.ts(e)})})),t},a.state={systemInfo:{cpuUsage:[],memoryUsed:0,memoryTotal:0},versionInfo:{},prometheusInfo:{apiThroughput:[],apiLatency:[],totalThroughput:0},intervalId:null,loading:!0,isTourVisible:M.x5()},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;kr().then((function(t){e.setState({systemInfo:t.data,loading:!1});var n=setInterval((function(){kr().then((function(t){e.setState({systemInfo:t.data})})).catch((function(e){r.PV("error","System info failed to get: ".concat(e))})),fetch("".concat(r.nn,"/api/get-prometheus-info "),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()})).then((function(t){e.setState({prometheusInfo:t.data})}))}),2e3);e.setState({intervalId:n})})).catch((function(e){r.PV("error","System info failed to get: ".concat(e))})),fetch("".concat(r.nn,"/api/get-version-info"),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()})).then((function(t){e.setState({versionInfo:t.data})})).catch((function(e){r.PV("error","Version info failed to get: ".concat(e))}))}},{key:"componentDidMount",value:function(){window.addEventListener("storageTourChanged",this.handleTourChange)}},{key:"componentWillUnmount",value:function(){null!==this.state.intervalId&&clearInterval(this.state.intervalId),window.removeEventListener("storageTourChanged",this.handleTourChange)}},{key:"render",value:function(){var e,t,n,a,i,s,o,l,c,d=(null===(e=this.state.systemInfo.cpuUsage)||void 0===e?void 0:e.length)<=0?Z.Z.t("system:Failed to get CPU usage"):this.state.systemInfo.cpuUsage.map((function(e,t){return(0,v.jsx)(jr.Z,{percent:Number(e.toFixed(1))},t)})),p=this.state.systemInfo.memoryUsed&&this.state.systemInfo.memoryTotal&&this.state.systemInfo.memoryTotal<=0?Z.Z.t("system:Failed to get memory usage"):(0,v.jsxs)("div",{children:[r.iO(this.state.systemInfo.memoryUsed)," / ",r.iO(this.state.systemInfo.memoryTotal),(0,v.jsx)("br",{})," ",(0,v.jsx)("br",{}),(0,v.jsx)(jr.Z,{type:"circle",percent:Number((Number(this.state.systemInfo.memoryUsed)/Number(this.state.systemInfo.memoryTotal)*100).toFixed(2))})]}),u=null===this.state.prometheusInfo.apiLatency||(null===(t=this.state.prometheusInfo.apiLatency)||void 0===t?void 0:t.length)<=0?(0,v.jsx)(H.Z,{size:"large"}):(0,v.jsx)(Cr,{prometheusInfo:this.state.prometheusInfo,table:"latency"}),g=null===this.state.prometheusInfo.apiThroughput||(null===(n=this.state.prometheusInfo.apiThroughput)||void 0===n?void 0:n.length)<=0?(0,v.jsx)(H.Z,{size:"large"}):(0,v.jsx)(Cr,{prometheusInfo:this.state.prometheusInfo,table:"throughput"}),m=""!==(null===(a=this.state.versionInfo)||void 0===a?void 0:a.version)?"https://github.com/casdoor/casdoor/releases/tag/".concat(null===(i=this.state.versionInfo)||void 0===i?void 0:i.version):"",x=""!==(null===(s=this.state.versionInfo)||void 0===s?void 0:s.version)?null===(o=this.state.versionInfo)||void 0===o?void 0:o.version:Z.Z.t("system:Unknown version");(null===(l=this.state.versionInfo)||void 0===l?void 0:l.commitOffset)>0&&(x+=" (ahead+".concat(null===(c=this.state.versionInfo)||void 0===c?void 0:c.commitOffset,")"));return r.tq()?(0,v.jsxs)(R.Z,{gutter:[16,0],children:[(0,v.jsx)(L.Z,{span:24,children:(0,v.jsx)(h.Z,{title:Z.Z.t("system:CPU Usage"),bordered:!0,style:{textAlign:"center",width:"100%"},children:this.state.loading?(0,v.jsx)(H.Z,{size:"large"}):d})}),(0,v.jsx)(L.Z,{span:24,children:(0,v.jsx)(h.Z,{title:Z.Z.t("system:Memory Usage"),bordered:!0,style:{textAlign:"center",width:"100%"},children:this.state.loading?(0,v.jsx)(H.Z,{size:"large"}):p})}),(0,v.jsx)(L.Z,{span:24,children:(0,v.jsxs)(h.Z,{title:Z.Z.t("system:About Casdoor"),bordered:!0,style:{textAlign:"center"},children:[(0,v.jsx)("div",{children:Z.Z.t("system:An Identity and Access Management (IAM) / Single-Sign-On (SSO) platform with web UI supporting OAuth 2.0, OIDC, SAML and CAS")}),"GitHub: ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/casdoor/casdoor",children:"Casdoor"}),(0,v.jsx)("br",{}),Z.Z.t("system:Version"),": ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:m,children:x}),(0,v.jsx)("br",{}),Z.Z.t("system:Official website"),": ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://casdoor.org",children:"https://casdoor.org"}),(0,v.jsx)("br",{}),Z.Z.t("system:Community"),": ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://casdoor.org/#:~:text=Casdoor%20API-,Community,-GitHub",children:"Get in Touch!"})]})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(R.Z,{children:[(0,v.jsx)(L.Z,{span:6}),(0,v.jsxs)(L.Z,{span:12,children:[(0,v.jsxs)(R.Z,{gutter:[10,10],children:[(0,v.jsx)(L.Z,{span:12,children:(0,v.jsx)(h.Z,{id:"cpu-card",title:Z.Z.t("system:CPU Usage"),bordered:!0,style:{textAlign:"center",height:"100%"},children:this.state.loading?(0,v.jsx)(H.Z,{size:"large"}):d})}),(0,v.jsx)(L.Z,{span:12,children:(0,v.jsx)(h.Z,{id:"memory-card",title:Z.Z.t("system:Memory Usage"),bordered:!0,style:{textAlign:"center",height:"100%"},children:this.state.loading?(0,v.jsx)(H.Z,{size:"large"}):p})}),(0,v.jsx)(L.Z,{span:24,children:(0,v.jsx)(h.Z,{id:"latency-card",title:Z.Z.t("system:API Latency"),bordered:!0,style:{textAlign:"center",height:"100%"},children:this.state.loading?(0,v.jsx)(H.Z,{size:"large"}):u})}),(0,v.jsx)(L.Z,{span:24,children:(0,v.jsx)(h.Z,{id:"throughput-card",title:Z.Z.t("system:API Throughput"),bordered:!0,style:{textAlign:"center",height:"100%"},children:this.state.loading?(0,v.jsx)(H.Z,{size:"large"}):g})})]}),(0,v.jsx)(Tr.Z,{}),(0,v.jsxs)(h.Z,{id:"about-card",title:Z.Z.t("system:About Casdoor"),bordered:!0,style:{textAlign:"center"},children:[(0,v.jsx)("div",{children:Z.Z.t("system:An Identity and Access Management (IAM) / Single-Sign-On (SSO) platform with web UI supporting OAuth 2.0, OIDC, SAML and CAS")}),"GitHub: ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/casdoor/casdoor",children:"Casdoor"}),(0,v.jsx)("br",{}),Z.Z.t("system:Version"),": ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:m,children:x}),(0,v.jsx)("br",{}),Z.Z.t("system:Official website"),": ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://casdoor.org",children:"https://casdoor.org"}),(0,v.jsx)("br",{}),Z.Z.t("system:Community"),": ",(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://casdoor.org/#:~:text=Casdoor%20API-,Community,-GitHub",children:"Get in Touch!"})]})]}),(0,v.jsx)(L.Z,{span:6})]}),(0,v.jsx)(V.Z,{open:!r.tq()&&this.state.isTourVisible,onClose:this.setIsTourVisible,steps:this.getSteps(),indicatorsRender:function(e,t){return(0,v.jsxs)("span",{children:[e+1," / ",t]})},onFinish:this.handleTourComplete})]})}}]),n}(y.Component);function Sr(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-syncer"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var wr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return fetch("".concat(r.nn,"/api/get-syncers?owner=").concat(e,"&organization=").concat(t,"&p=").concat(n,"&pageSize=").concat(a,"&field=").concat(i,"&value=").concat(s,"&sortField=").concat(o,"&sortOrder=").concat(l),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}("admin",r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newSyncer",value:function(){var e=r.VO(),t=r.jb(this.props.account);return{owner:"admin",name:"syncer_".concat(e),createdTime:Fe()().format(),organization:t,type:"Database",host:"localhost",port:3306,user:"root",password:"123456",databaseType:"mysql",database:"dbName",table:"table_name",tableColumns:[],affiliationTable:"",avatarBaseUrl:"",syncInterval:10,isReadOnly:!1,isEnabled:!1}}},{key:"addSyncer",value:function(){var e=this,t=this.newSyncer();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-syncer"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/syncers/".concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteSyncer",value:function(e){var t=this;Sr(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"runSyncer",value:function(e){var t,n,a=this;this.setState({loading:!0}),(t="admin",n=this.state.data[e].name,fetch("".concat(r.nn,"/api/run-syncer?id=").concat(t,"/").concat(encodeURIComponent(n)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){"ok"===e.status?(a.setState({loading:!1}),r.PV("success",Z.Z.t("general:Successfully synced"))):(a.setState({loading:!1}),r.PV("error","".concat(Z.Z.t("general:Failed to sync"),": ").concat(e.msg)))})).catch((function(e){a.setState({loading:!1}),r.PV("error","Syncer failed to sync users: ".concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/syncers/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"organization",key:"organization",width:"120px",sorter:!0},this.getColumnSearchProps("organization")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"100px",sorter:!0,filterMultiple:!1,filters:[{text:"Database",value:"Database"},{text:"LDAP",value:"LDAP"}]},{title:Z.Z.t("syncer:Database type"),dataIndex:"databaseType",key:"databaseType",width:"130px",sorter:function(e,t){return e.databaseType.localeCompare(t.databaseType)}},(0,a.Z)({title:Z.Z.t("provider:Host"),dataIndex:"host",key:"host",width:"120px",sorter:!0},this.getColumnSearchProps("host")),(0,a.Z)({title:Z.Z.t("provider:Port"),dataIndex:"port",key:"port",width:"100px",sorter:!0},this.getColumnSearchProps("port")),(0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),(0,a.Z)({title:Z.Z.t("general:Password"),dataIndex:"password",key:"password",width:"120px",sorter:!0},this.getColumnSearchProps("password")),{title:Z.Z.t("syncer:Database"),dataIndex:"database",key:"database",width:"120px",sorter:!0},{title:Z.Z.t("syncer:Table"),dataIndex:"table",key:"table",width:"120px",sorter:!0},(0,a.Z)({title:Z.Z.t("syncer:Sync interval"),dataIndex:"syncInterval",key:"syncInterval",width:"140px",sorter:!0},this.getColumnSearchProps("syncInterval")),{title:Z.Z.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"240px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.runSyncer(a)},children:Z.Z.t("general:Sync")}),(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},onClick:function(){return t.props.history.push("/syncers/".concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteSyncer(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Syncers"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addSyncer.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Pr=wr,Ar=ne.Z.Option,Ir=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:"column".concat(e.length),type:"string",values:[],isKey:0===e.filter((function(e){return e.isKey})).length};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("syncer:Column name"),dataIndex:"name",key:"name",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"name",n.target.value)}})}},{title:Z.Z.t("syncer:Column type"),dataIndex:"type",key:"type",render:function(n,a,i){return(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"type",n)},children:["string","integer","boolean"].map((function(e,t){return(0,v.jsx)(Ar,{value:e,children:e},t)}))})}},{title:Z.Z.t("syncer:Casdoor column"),dataIndex:"casdoorName",key:"casdoorName",render:function(n,a,i){return(0,v.jsx)(ne.Z,{virtual:!1,showSearch:!0,style:{width:"100%"},value:n,onChange:function(n){t.updateField(e,i,"casdoorName",n)},children:r.iE().map((function(e,t){return(0,v.jsx)(Ar,{value:e,children:e},t)}))})}},{title:Z.Z.t("syncer:Is key"),dataIndex:"isKey",key:"isKey",render:function(n,a,i){return(0,v.jsx)(re.Z,{checked:n,onChange:function(n){if(!a.isKey&&n)e.forEach((function(n,a){t.updateField(e,a,"isKey",!1)}));else if(a.isKey&&!n)return;t.updateField(e,i,"isKey",n)}})}},{title:Z.Z.t("syncer:Is hashed"),dataIndex:"isHashed",key:"isHashed",render:function(n,a,i){return(0,v.jsx)(re.Z,{checked:n,onChange:function(n){t.updateField(e,i,"isHashed",n)}})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),disabled:a.isKey&&e.length>1,size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{rowKey:"index",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),Fr=ne.Z.Option,zr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={certs:[],classes:e,syncerName:e.match.params.syncerName,syncer:null,organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit",testDbLoading:!1},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getSyncer(),this.getOrganizations()}},{key:"getSyncer",value:function(){var e,t,n=this;(e="admin",t=this.state.syncerName,fetch("".concat(r.nn,"/api/get-syncer?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){null!==e.data?"error"!==e.status?n.setState({syncer:e.data}):r.PV("error",e.msg):n.props.history.push("/404")}))}},{key:"getCerts",value:function(e){var t=this;na(e).then((function(e){t.setState({certs:e.data||[]})}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]}),t.data&&e.getCerts("".concat(t.data.owner,"/").concat(t.data.name))}))}},{key:"parseSyncerField",value:function(e,t){return["port"].includes(e)&&(t=r.Js(t)),t}},{key:"updateSyncerField",value:function(e,t){t=this.parseSyncerField(e,t);var n=this.state.syncer;n[e]=t,this.setState({syncer:n})}},{key:"getSyncerTableColumns",value:function(e){return"Keycloak"===e.type?[{name:"ID",type:"string",casdoorName:"Id",isHashed:!0,values:[]},{name:"USERNAME",type:"string",casdoorName:"Name",isHashed:!0,values:[]},{name:"LAST_NAME+FIRST_NAME",type:"string",casdoorName:"DisplayName",isHashed:!0,values:[]},{name:"EMAIL",type:"string",casdoorName:"Email",isHashed:!0,values:[]},{name:"EMAIL_VERIFIED",type:"boolean",casdoorName:"EmailVerified",isHashed:!0,values:[]},{name:"FIRST_NAME",type:"string",casdoorName:"FirstName",isHashed:!0,values:[]},{name:"LAST_NAME",type:"string",casdoorName:"LastName",isHashed:!0,values:[]},{name:"CREATED_TIMESTAMP",type:"string",casdoorName:"CreatedTime",isHashed:!0,values:[]},{name:"ENABLED",type:"boolean",casdoorName:"IsForbidden",isHashed:!0,values:[]}]:[]}},{key:"renderSyncer",value:function(){var e,t=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("syncer:New Syncer"):Z.Z.t("syncer:Edit Syncer"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return t.submitSyncerEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return t.submitSyncerEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return t.deleteSyncer()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.syncer.organization,onChange:function(e){t.updateSyncerField("organization",e)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(Fr,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.syncer.name,onChange:function(e){t.updateSyncerField("name",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Type"),Z.Z.t("provider:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.syncer.type,onChange:function(e){t.updateSyncerField("type",e);var n=t.state.syncer;n.tableColumns=t.getSyncerTableColumns(t.state.syncer),n.table="Keycloak"===e?"user_entity":t.state.syncer.table,t.setState({syncer:n})},children:["Database","Keycloak"].map((function(e,t){return(0,v.jsx)(Fr,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Database type"),Z.Z.t("syncer:Database type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.syncer.databaseType,onChange:function(e){t.updateSyncerField("databaseType",e),"postgres"===e?t.updateSyncerField("sslMode","disable"):t.updateSyncerField("sslMode","")},children:[{id:"mysql",name:"MySQL"},{id:"postgres",name:"PostgreSQL"},{id:"mssql",name:"SQL Server"},{id:"oracle",name:"Oracle"},{id:"sqlite3",name:"Sqlite 3"}].map((function(e,t){return(0,v.jsx)(Fr,{value:e.id,children:e.name},t)}))})})]}),"postgres"!==this.state.syncer.databaseType?null:(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:SSL mode"),Z.Z.t("syncer:SSL mode - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.syncer.sslMode,onChange:function(e){t.updateSyncerField("sslMode",e)},children:[{id:"disable",name:"disable"},{id:"require",name:"require"},{id:"verify-ca",name:"verify-ca"},{id:"verify-full",name:"verify-full"}].map((function(e,t){return(0,v.jsx)(Fr,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Host"),Z.Z.t("provider:Host - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.syncer.host,onChange:function(e){t.updateSyncerField("host",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Port"),Z.Z.t("provider:Port - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.syncer.port,onChange:function(e){t.updateSyncerField("port",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:User"),Z.Z.t("general:User - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.syncer.user,onChange:function(e){t.updateSyncerField("user",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Password"),Z.Z.t("general:Password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z.Password,{value:this.state.syncer.password,onChange:function(e){t.updateSyncerField("password",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Database"),Z.Z.t("syncer:Database - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.syncer.database,onChange:function(e){t.updateSyncerField("database",e.target.value)}})})]}),"mysql"===this.state.syncer.databaseType||"mssql"===this.state.syncer.databaseType||"postgres"===this.state.syncer.databaseType?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:SSH type"),Z.Z.t("general:SSH type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsxs)(bt.ZP.Group,{value:this.state.syncer.sshType,buttonStyle:"solid",onChange:function(e){t.updateSyncerField("sshType",e.target.value)},children:[(0,v.jsx)(bt.ZP.Button,{value:"",children:Z.Z.t("general:None")}),(0,v.jsx)(bt.ZP.Button,{value:"password",children:Z.Z.t("general:Password")}),(0,v.jsx)(bt.ZP.Button,{value:"cert",children:Z.Z.t("general:Cert")})]})})]}):null,this.state.syncer.sshType&&"mysql"===this.state.syncer.databaseType||"mssql"===this.state.syncer.databaseType||"postgres"===this.state.syncer.databaseType?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:SSH host"),Z.Z.t("provider:Host - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.syncer.sshHost,onChange:function(e){t.updateSyncerField("sshHost",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:SSH port"),Z.Z.t("provider:Port - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.syncer.sshPort,onChange:function(e){t.updateSyncerField("sshPort",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:SSH user"),Z.Z.t("general:User - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.syncer.sshUser,onChange:function(e){t.updateSyncerField("sshUser",e.target.value)}})})]}),"password"!==this.state.syncer.sshType||"mysql"!==this.state.syncer.databaseType&&"mssql"!==this.state.syncer.databaseType&&"postgres"!==this.state.syncer.databaseType?(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:SSH cert"),Z.Z.t("general:Cert - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.syncer.cert,onChange:function(e){t.updateSyncerField("cert",e)},children:null===(e=this.state)||void 0===e?void 0:e.certs.map((function(e,t){return(0,v.jsx)(Fr,{value:e.name,children:e.name},t)}))})})]}):(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:SSH password"),Z.Z.t("general:Password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z.Password,{value:this.state.syncer.sshPassword,onChange:function(e){t.updateSyncerField("ssh sshPassword",e.target.value)}})})]})]}):null,(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Table"),Z.Z.t("syncer:Table - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.syncer.table,onChange:function(e){t.updateSyncerField("table",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:DB test"),Z.Z.t("provider:DB test - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:2,children:(0,v.jsx)(d.ZP,{type:"primary",loading:this.state.testDbLoading,onClick:function(){t.setState({testDbLoading:!0}),function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/test-syncer-db"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(t.state.syncer).then((function(e){"ok"===e.status?(t.setState({testDbLoading:!1}),r.PV("success",Z.Z.t("syncer:Connect successfully"))):(t.setState({testDbLoading:!1}),r.PV("error","".concat(Z.Z.t("syncer:Failed to connect"),": ").concat(e.msg)))})).catch((function(e){t.setState({testDbLoading:!1}),r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))},children:Z.Z.t("syncer:Test DB Connection")})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Table columns"),Z.Z.t("syncer:Table columns - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Ir,{title:Z.Z.t("syncer:Table columns"),table:this.state.syncer.tableColumns,onUpdateTable:function(e){t.updateSyncerField("tableColumns",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Affiliation table"),Z.Z.t("syncer:Affiliation table - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.syncer.affiliationTable,onChange:function(e){t.updateSyncerField("affiliationTable",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Avatar base URL"),Z.Z.t("syncer:Avatar base URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.syncer.avatarBaseUrl,onChange:function(e){t.updateSyncerField("avatarBaseUrl",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Sync interval"),Z.Z.t("syncer:Sync interval - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ie.Z,{value:this.state.syncer.syncInterval,onChange:function(e){t.updateSyncerField("syncInterval",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("syncer:Error text"),Z.Z.t("syncer:Error text - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)("div",{style:{width:"100%",height:"300px"},children:(0,v.jsx)(Jn,{value:this.state.syncer.errorText,fillHeight:!0,readOnly:!0,dark:!0,lang:"js",onChange:function(e){t.updateSyncerField("errorText",e)}})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("syncer:Is read-only"),Z.Z.t("syncer:Is read-only - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.syncer.isReadOnly,onChange:function(e){t.updateSyncerField("isReadOnly",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.syncer.isEnabled,onChange:function(e){t.updateSyncerField("isEnabled",e)}})})]})]})}},{key:"submitSyncerEdit",value:function(e){var t=this,n=r.p$(this.state.syncer);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-syncer?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.syncer.owner,this.state.syncerName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({syncerName:t.state.syncer.name}),e?t.props.history.push("/syncers"):t.props.history.push("/syncers/".concat(t.state.syncer.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateSyncerField("name",t.state.syncerName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteSyncer",value:function(){var e=this;Sr(this.state.syncer).then((function(t){"ok"===t.status?e.props.history.push("/syncers"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.syncer?this.renderSyncer():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitSyncerEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitSyncerEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteSyncer()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component);function Nr(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-webhook"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var Ur=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.contentType&&null!==t.contentType&&(n="contentType",i=t.contentType),e.setState({loading:!0}),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return fetch("".concat(r.nn,"/api/get-webhooks?owner=").concat(e,"&organization=").concat(t,"&p=").concat(n,"&pageSize=").concat(a,"&field=").concat(i,"&value=").concat(s,"&sortField=").concat(o,"&sortOrder=").concat(l),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}("admin",r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newWebhook",value:function(){var e=r.VO(),t=r.jb(this.props.account);return{owner:"admin",name:"webhook_".concat(e),createdTime:Fe()().format(),organization:t,url:"https://example.com/callback",method:"POST",contentType:"application/json",headers:[],events:["signup","login","logout","update-user"],isEnabled:!0}}},{key:"addWebhook",value:function(){var e=this,t=this.newWebhook();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-webhook"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/webhooks/".concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteWebhook",value:function(e){var t=this;Nr(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/webhooks/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"organization",key:"organization",width:"110px",sorter:!0},this.getColumnSearchProps("organization")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"150px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("general:URL"),dataIndex:"url",key:"url",width:"200px",sorter:!0},this.getColumnSearchProps("url")),{},{render:function(e,t,n){return(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:r.xu(e)})}}),(0,a.Z)({title:Z.Z.t("general:Method"),dataIndex:"method",key:"method",width:"100px",sorter:!0},this.getColumnSearchProps("method")),{title:Z.Z.t("webhook:Content type"),dataIndex:"contentType",key:"contentType",width:"140px",sorter:!0,filterMultiple:!1,filters:[{text:"application/json",value:"application/json"},{text:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}]},(0,a.Z)((0,a.Z)({title:Z.Z.t("webhook:Events"),dataIndex:"events",key:"events",sorter:!0},this.getColumnSearchProps("events")),{},{render:function(e,t,n){return r.NJ(e)}}),{title:Z.Z.t("webhook:Is user extended"),dataIndex:"isUserExtended",key:"isUserExtended",width:"140px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("webhook:Single org only"),dataIndex:"singleOrgOnly",key:"singleOrgOnly",width:"140px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,fixed:r.tq()?"false":"right",render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}},{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/webhooks/".concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteWebhook(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Webhooks"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addWebhook.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),Er=Ur,Rr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e},a}return(0,J.Z)(n,[{key:"updateTable",value:function(e){this.props.onUpdateTable(e)}},{key:"updateField",value:function(e,t,n,a){e[t][n]=a,this.updateTable(e)}},{key:"addRow",value:function(e){var t={name:"header-".concat(e.length),value:"value-".concat(e.length)};void 0===e&&(e=[]),e=r.SA(e,t),this.updateTable(e)}},{key:"deleteRow",value:function(e,t){e=r.qK(e,t),this.updateTable(e)}},{key:"upRow",value:function(e,t){e=r.np(e,t-1,t),this.updateTable(e)}},{key:"downRow",value:function(e,t){e=r.np(e,t,t+1),this.updateTable(e)}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"250px",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"name",n.target.value)}})}},{title:Z.Z.t("webhook:Value"),dataIndex:"value",key:"value",render:function(n,a,i){return(0,v.jsx)(ae.Z,{value:n,onChange:function(n){t.updateField(e,i,"value",n.target.value)}})}},{title:Z.Z.t("general:Action"),key:"action",width:"100px",render:function(n,a,i){return(0,v.jsxs)("div",{children:[(0,v.jsx)(l.Z,{placement:"bottomLeft",title:Z.Z.t("general:Up"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:0===i,icon:(0,v.jsx)(De.Z,{}),size:"small",onClick:function(){return t.upRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Down"),children:(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},disabled:i===e.length-1,icon:(0,v.jsx)(b.Z,{}),size:"small",onClick:function(){return t.downRow(e,i)}})}),(0,v.jsx)(l.Z,{placement:"topLeft",title:Z.Z.t("general:Delete"),children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(Me.Z,{}),size:"small",onClick:function(){return t.deleteRow(e,i)}})})]})}}];return(0,v.jsx)(Ee.Z,{rowKey:"index",columns:n,dataSource:e,size:"middle",bordered:!0,pagination:!1,title:function(){return(0,v.jsxs)("div",{children:[t.props.title,"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:function(){return t.addRow(e)},children:Z.Z.t("general:Add")})]})}})}},{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsx)(R.Z,{style:{marginTop:"20px"},children:(0,v.jsx)(L.Z,{span:24,children:this.renderTable(this.props.table)})})})}}]),n}(y.Component),Lr=ne.Z.Option,Or={owner:"admin",name:"application_123",organization:"built-in",createdTime:"2022-01-01T01:03:42+08:00",displayName:"New Application - 123",logo:"".concat(r.WD,"/img/casdoor-logo_1185x256.png"),enablePassword:!0,enableSignUp:!0,enableSigninSession:!1,enableCodeSignin:!1,enableSamlCompress:!1},Vr={id:9078,owner:"built-in",name:"68f55b28-7380-46b1-9bde-64fe1576e3b3",createdTime:"2022-01-01T01:03:42+08:00",organization:"built-in",clientIp:"159.89.126.192",user:"admin",method:"POST",requestUri:"/api/add-application",action:"login",isTriggered:!1,object:JSON.stringify(Or)},qr={owner:"built-in",name:"admin",createdTime:"2020-07-16T21:46:52+08:00",updatedTime:"",deletedTime:"",id:"9eb20f79-3bb5-4e74-99ac-39e3b9a171e8",type:"normal-user",password:"***",passwordSalt:"",displayName:"Admin",avatar:"https://cdn.casbin.com/usercontent/admin/avatar/1596241359.png",permanentAvatar:"https://cdn.casbin.com/casdoor/avatar/casbin/admin.png",email:"admin@example.com",phone:"",location:"",address:null,affiliation:"",title:"",score:1e4,ranking:10,isOnline:!1,isAdmin:!0,isForbidden:!1,isDeleted:!1,signupApplication:"app-casnode",properties:{bio:"",checkinDate:"20200801",editorType:"",emailVerifiedTime:"2020-07-16T21:46:52+08:00",fileQuota:"50",location:"",no:"22",oauth_QQ_displayName:"",oauth_QQ_verifiedTime:"",oauth_WeChat_displayName:"",oauth_WeChat_verifiedTime:"",onlineStatus:"false",phoneVerifiedTime:"",renameQuota:"3",tagline:"",website:""}},Dr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,webhookName:e.match.params.webhookName,webhook:null,organizations:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getWebhook(),this.getOrganizations()}},{key:"getWebhook",value:function(){var e,t,n=this;(e="admin",t=this.state.webhookName,fetch("".concat(r.nn,"/api/get-webhook?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){null!==e.data?n.setState({webhook:e.data}):n.props.history.push("/404")}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"parseWebhookField",value:function(e,t){return["port"].includes(e)&&(t=r.Js(t)),t}},{key:"updateWebhookField",value:function(e,t){t=this.parseWebhookField(e,t);var n=this.state.webhook;n[e]=t,this.setState({webhook:n})}},{key:"getApiPaths",value:function(){var e=[];return["organization","group","user","application","provider","resource","cert","role","permission","model","adapter","enforcer","session","record","token","product","payment","plan","pricing","subscription","syncer","webhook"].forEach((function(t){["add","update","delete"].forEach((function(n){e.push("".concat(n,"-").concat(t))})),"payment"===t&&e.push("invoice-payment","notify-payment")})),e}},{key:"renderWebhook",value:function(){var e=this,t=r.p$(Vr);if(this.state.webhook.isUserExtended)if(this.state.webhook.tokenFields&&0!==this.state.webhook.tokenFields.length){var n={};this.state.webhook.tokenFields.forEach((function(e){var t=e.replace(e[0],e[0].toLowerCase());n[t]=qr[t]})),t.extendedUser=n}else t.extendedUser=qr;var a=JSON.stringify(t,null,2);return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("webhook:New Webhook"):Z.Z.t("webhook:Edit Webhook"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitWebhookEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitWebhookEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteWebhook()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.webhook.organization,onChange:function(t){e.updateWebhookField("organization",t)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(Lr,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{value:this.state.webhook.name,onChange:function(t){e.updateWebhookField("name",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:URL"),Z.Z.t("general:URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{prefix:(0,v.jsx)(qe.Z,{}),value:this.state.webhook.url,onChange:function(t){e.updateWebhookField("url",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Method"),Z.Z.t("webhook:Method - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.webhook.method,onChange:function(t){e.updateWebhookField("method",t)},children:[{id:"POST",name:"POST"},{id:"GET",name:"GET"},{id:"PUT",name:"PUT"},{id:"DELETE",name:"DELETE"}].map((function(e,t){return(0,v.jsx)(Lr,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("webhook:Content type"),Z.Z.t("webhook:Content type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},value:this.state.webhook.contentType,onChange:function(t){e.updateWebhookField("contentType",t)},children:[{id:"application/json",name:"application/json"},{id:"application/x-www-form-urlencoded",name:"application/x-www-form-urlencoded"}].map((function(e,t){return(0,v.jsx)(Lr,{value:e.id,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("webhook:Headers"),Z.Z.t("webhook:Headers - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(Rr,{title:Z.Z.t("webhook:Headers"),table:this.state.webhook.headers,onUpdateTable:function(t){e.updateWebhookField("headers",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("webhook:Events"),Z.Z.t("webhook:Events - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"multiple",style:{width:"100%"},value:this.state.webhook.events,onChange:function(t){e.updateWebhookField("events",t)},children:["signup","login","logout","new-user"].concat(this.getApiPaths()).map((function(e,t){return(0,v.jsx)(Lr,{value:e,children:e},e)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("webhook:Is user extended"),Z.Z.t("webhook:Is user extended - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.webhook.isUserExtended,onChange:function(t){e.updateWebhookField("isUserExtended",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("application:Extended user fields"),Z.Z.t("application:Extended user fields - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ne.Z,{virtual:!1,mode:"tags",showSearch:!0,style:{width:"100%"},value:this.state.webhook.tokenFields,onChange:function(t){e.updateWebhookField("tokenFields",t)},children:r.iE().map((function(e,t){return(0,v.jsx)(Lr,{value:e,children:e},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Preview"),Z.Z.t("general:Preview - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)("div",{style:{width:"900px",height:"300px"},children:(0,v.jsx)(Jn,{value:a,lang:"js",fillHeight:!0,readOnly:!0,dark:!0})})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("webhook:Single org only"),Z.Z.t("webhook:Single org only - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.webhook.singleOrgOnly,onChange:function(t){e.updateWebhookField("singleOrgOnly",t)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?19:2,children:[r.id(Z.Z.t("general:Is enabled"),Z.Z.t("general:Is enabled - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:1,children:(0,v.jsx)(re.Z,{checked:this.state.webhook.isEnabled,onChange:function(t){e.updateWebhookField("isEnabled",t)}})})]})]})}},{key:"submitWebhookEdit",value:function(e){var t=this,n=r.p$(this.state.webhook);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-webhook?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.webhook.owner,this.state.webhookName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({webhookName:t.state.webhook.name}),e?t.props.history.push("/webhooks"):t.props.history.push("/webhooks/".concat(t.state.webhook.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updateWebhookField("name",t.state.webhookName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteWebhook",value:function(){var e=this;Nr(this.state.webhook).then((function(t){"ok"===t.status?e.props.history.push("/webhooks"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.webhook?this.renderWebhook():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitWebhookEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitWebhookEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteWebhook()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component),Mr=n(50294),Br=n(44874),Wr=ne.Z.Option,Hr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={ldapId:e.match.params.ldapId,organizationName:e.match.params.organizationName,ldap:null,organizations:[],groups:null},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getLdap(),this.getOrganizations(),this.getGroups()}},{key:"getLdap",value:function(){var e=this;St(this.state.organizationName,this.state.ldapId).then((function(t){"ok"===t.status?e.setState({ldap:t.data}):r.PV("error",t.msg)}))}},{key:"getOrganizations",value:function(){var e=this;he.jX("admin").then((function(t){e.setState({organizations:t.data||[]})}))}},{key:"getGroups",value:function(){var e=this;ce(this.state.organizationName).then((function(t){"ok"===t.status&&e.setState({groups:t.data})}))}},{key:"updateLdapField",value:function(e,t){this.setState((function(n){return n.ldap[e]=t,n}))}},{key:"renderAutoSyncWarn",value:function(){if(this.state.ldap.autoSync>0)return(0,v.jsx)("span",{style:{color:"#faad14",marginLeft:"20px"},children:Z.Z.t("ldap:The Auto Sync option will sync all users to specify organization")})}},{key:"renderLdap",value:function(){var e,t,n,a,i=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:[Z.Z.t("ldap:Edit LDAP"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return i.submitLdapEdit()},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return i.submitLdapEdit(!0)},children:Z.Z.t("general:Save & Exit")}),(0,v.jsxs)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return r.iF("/ldap/sync/".concat(i.state.organizationName,"/").concat(i.state.ldapId))},children:[Z.Z.t("general:Sync")," LDAP"]})]}),style:{marginLeft:"5px"},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ne.Z,{virtual:!1,style:{width:"100%"},disabled:!r.VN(this.props.account),value:this.state.ldap.owner,onChange:function(e){i.updateLdapField("owner",e)},children:this.state.organizations.map((function(e,t){return(0,v.jsx)(Wr,{value:e.name,children:e.name},t)}))})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("general:ID"),Z.Z.t("general:ID - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:this.state.ldap.id,disabled:!0})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Server name"),Z.Z.t("ldap:Server name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:this.state.ldap.serverName,onChange:function(e){i.updateLdapField("serverName",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Server host"),Z.Z.t("ldap:Server host - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:this.state.ldap.host,onChange:function(e){i.updateLdapField("host",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Server port"),Z.Z.t("ldap:Server port - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ie.Z,{min:0,max:65535,formatter:function(e){return e.replace(/\$\s?|(,*)/g,"")},value:this.state.ldap.port,onChange:function(e){i.updateLdapField("port",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Enable SSL"),Z.Z.t("ldap:Enable SSL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(re.Z,{checked:this.state.ldap.enableSsl,onChange:function(e){i.updateLdapField("enableSsl",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Base DN"),Z.Z.t("ldap:Base DN - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:this.state.ldap.baseDn,onChange:function(e){i.updateLdapField("baseDn",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Search Filter"),Z.Z.t("ldap:Search Filter - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:this.state.ldap.filter,onChange:function(e){i.updateLdapField("filter",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Filter fields"),Z.Z.t("ldap:Filter fields - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ne.Z,{value:null!==(e=this.state.ldap.filterFields)&&void 0!==e?e:[],style:{width:"100%"},mode:"multiple",options:[{value:"uid",label:"uid"},{value:"mail",label:"Email"},{value:"mobile",label:"mobile"},{value:"sAMAccountName",label:"sAMAccountName"}].map((function(e){return r.Rl(e.label,e.value)})),onChange:function(e){i.updateLdapField("filterFields",e)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Admin"),Z.Z.t("ldap:Admin - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z,{value:this.state.ldap.username,onChange:function(e){i.updateLdapField("username",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Admin Password"),Z.Z.t("ldap:Admin Password - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsx)(ae.Z.Password,{iconRender:function(e){return e?(0,v.jsx)(Mr.Z,{}):(0,v.jsx)(Br.Z,{})},value:this.state.ldap.password,onChange:function(e){i.updateLdapField("password",e.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("general:Password type"),Z.Z.t("general:Password type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:null!==(t=this.state.ldap.passwordType)&&void 0!==t?t:[],onChange:function(e){i.updateLdapField("passwordType",e)},children:[(0,v.jsx)(Wr,{value:"Plain",children:Z.Z.t("general:Plain")},"Plain"),(0,v.jsx)(Wr,{value:"SSHA",children:"SSHA"},"SSHA"),(0,v.jsx)(Wr,{value:"MD5",children:"MD5"},"MD5")]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Default group"),Z.Z.t("ldap:Default group - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:21,children:(0,v.jsxs)(ne.Z,{virtual:!1,style:{width:"100%"},value:null!==(n=this.state.ldap.defaultGroup)&&void 0!==n?n:[],onChange:function(e){i.updateLdapField("defaultGroup",e)},children:[(0,v.jsx)(Wr,{value:"",children:(0,v.jsx)(m.Z,{children:Z.Z.t("general:Default")})},""),null===(a=this.state.groups)||void 0===a?void 0:a.map((function(e){return(0,v.jsx)(Wr,{value:"".concat(e.owner,"/").concat(e.name),children:(0,v.jsxs)(m.Z,{children:["Physical"===e.type?(0,v.jsx)(_e.Z,{}):(0,v.jsx)($e.Z,{}),e.displayName]})},e.name)}))]})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{lineHeight:"32px",textAlign:"right",paddingRight:"25px"},span:3,children:[r.id(Z.Z.t("ldap:Auto Sync"),Z.Z.t("ldap:Auto Sync - Tooltip"))," :"]}),(0,v.jsxs)(L.Z,{span:21,children:[(0,v.jsx)(ie.Z,{min:0,formatter:function(e){return e.replace(/\$\s?|(,*)/g,"")},disabled:!1,value:this.state.ldap.autoSync,onChange:function(e){i.updateLdapField("autoSync",e)}}),(0,v.jsx)("span",{children:"\xa0mins"}),this.renderAutoSyncWarn()]})]})]})}},{key:"submitLdapEdit",value:function(e){var t,n=this;(t=this.state.ldap,fetch("".concat(r.nn,"/api/update-ldap"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(t){"ok"===t.status?(r.PV("success","Update LDAP server success"),n.setState({organizationName:n.state.ldap.owner}),e&&n.props.history.push("/organizations/".concat(n.state.organizationName))):r.PV("error",t.msg)})).catch((function(e){r.PV("error","Update LDAP server failed: ".concat(e))}))}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.ldap?this.renderLdap():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitLdapEdit()},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitLdapEdit(!0)},children:Z.Z.t("general:Save & Exit")})]})]})}}]),n}(y.Component),Gr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={ldapId:e.match.params.ldapId,organizationName:e.match.params.organizationName,ldap:null,users:[],existUuids:[],selectedUsers:[]},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getLdap()}},{key:"syncUsers",value:function(){var e,t,n,a=this,i=this.state.selectedUsers;null!==i&&0!==i.length?(e=this.state.ldap.owner,t=this.state.ldap.id,n=i,fetch("".concat(r.nn,"/api/sync-ldap-users?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(n),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){if("ok"===e.status){var t=e.data.exist,n=e.data.failed,i=[],s=[];t&&0!==t.length||n&&0!==n.length?(t&&t.length>0&&(t.forEach((function(e){i.push(e.cn)})),r.PV("error","User [".concat(i,"] is already exist"))),n&&n.length>0&&(n.forEach((function(e){s.push(e.cn)})),r.PV("error","Sync [".concat(s,"] failed")))):r.iF("/organizations/".concat(a.state.ldap.owner,"/users"))}else r.PV("error",e.msg)})):r.PV("error","Please select al least 1 user first")}},{key:"getLdap",value:function(){var e=this;St(this.state.organizationName,this.state.ldapId).then((function(t){"ok"===t.status?(e.setState({ldap:t.data}),e.getLdapUser()):r.PV("error",t.msg)}))}},{key:"getLdapUser",value:function(){var e,t,n=this;(e=this.state.organizationName,t=this.state.ldapId,fetch("".concat(r.nn,"/api/get-ldap-users?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){"ok"===e.status?n.setState((function(t){var n;return t.users=e.data.users,t.existUuids=(null===(n=e.data.existUuids)||void 0===n?void 0:n.length)>0?e.data.existUuids.filter((function(e){return""!==e})):[],t})):r.PV("error",e.msg)}))}},{key:"buildValArray",value:function(e,t){var n=[];return null!==e&&e.length>0&&e.forEach((function(e){var a=e[t];n.includes(a)||n.push(a)})),n}},{key:"buildFilter",value:function(e,t){var n=[];null!==e&&e.length>0&&this.buildValArray(e,t).forEach((function(e){n.push({text:e,value:e})}));return n}},{key:"renderTable",value:function(e){var t=this,n=[{title:Z.Z.t("ldap:CN"),dataIndex:"cn",key:"cn",sorter:function(e,t){return e.cn.localeCompare(t.cn)},render:function(e,n,a){return(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,v.jsx)("div",{children:e}),t.state.existUuids.includes(n.uuid)?r.h1("green",Z.Z.t("ldap:synced")):r.h1("red",Z.Z.t("ldap:unsynced"))]})}},{title:"Uid",dataIndex:"uid",key:"uid",sorter:function(e,t){return e.uid.localeCompare(t.uid)},render:function(e,n,a){return t.state.existUuids.includes(n.uuid)?(0,v.jsx)(T.rU,{to:"/users/".concat(t.state.organizationName,"/").concat(e),children:e}):e}},{title:"UidNumber",dataIndex:"uidNumber",key:"uidNumber",sorter:function(e,t){return e.uidNumber.localeCompare(t.uidNumber)},render:function(e,t,n){return e}},{title:Z.Z.t("ldap:Group ID"),dataIndex:"groupId",key:"groupId",sorter:function(e,t){return e.groupId.localeCompare(t.groupId)},filters:this.buildFilter(this.state.users,"groupId"),onFilter:function(e,t){return 0===t.groupId.indexOf(e)}},{title:Z.Z.t("general:Email"),dataIndex:"email",key:"email",sorter:function(e,t){return e.email.localeCompare(t.email)}},{title:Z.Z.t("general:Phone"),dataIndex:"mobile",key:"mobile",sorter:function(e,t){return e.phone.localeCompare(t.phone)}},{title:Z.Z.t("user:Address"),dataIndex:"address",key:"address",sorter:function(e,t){return e.address.localeCompare(t.address)}}],a={onChange:function(e,n){t.setState({selectedUsers:n})},getCheckboxProps:function(e){return{disabled:-1!==t.state.existUuids.indexOf(e.uuid)}}};return(0,v.jsx)(Ee.Z,{rowSelection:a,columns:n,dataSource:e,rowKey:"uuid",bordered:!0,size:"small",pagination:{defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0},title:function(){var e;return(0,v.jsxs)("div",{children:[null===(e=t.state.ldap)||void 0===e?void 0:e.serverName,(0,v.jsx)(Qe.Z,{placement:"right",disabled:0===t.state.selectedUsers.length,title:"Please confirm to sync selected users",onConfirm:function(){return t.syncUsers()},children:(0,v.jsx)(d.ZP,{type:"primary",style:{marginLeft:"10px"},disabled:0===t.state.selectedUsers.length,children:Z.Z.t("general:Sync")})}),(0,v.jsxs)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return r.iF("/ldap/".concat(t.state.organizationName,"/").concat(t.state.ldapId))},children:[Z.Z.t("general:Edit")," LDAP"]})]})},loading:null===e})}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[this.renderTable(this.state.users),(0,v.jsx)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){e.props.history.push("/organizations/".concat(e.state.organizationName))},children:Z.Z.t("general:Save & Exit")})})]})}}]),n}(y.Component),Jr=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){return(0,G.Z)(this,n),t.apply(this,arguments)}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){r.a8()&&r.iF("".concat(r.nn,"/.well-known/openid-configuration"))}},{key:"render",value:function(){return null}}]),n}(y.Component),Qr=Jr,Kr=n(68122),_r=(n(28457),n(43681)),$r=n(59376),Yr=n(98146),Xr=n(62804),es=[{label:"Default",key:"default",icon:(0,v.jsx)($r.Z,{style:{fontSize:"24px"}})},{label:"Dark",key:"dark",icon:(0,v.jsx)(Yr.Z,{style:{fontSize:"24px"}})},{label:"Compact",key:"compact",icon:(0,v.jsx)(Xr.Z,{style:{fontSize:"24px"}})}];function ts(e){return null!==e&&void 0!==e&&e.includes("dark")?es.find((function(e){return"dark"===e.key})).icon:null!==e&&void 0!==e&&e.includes("default")?es.find((function(e){return"default"===e.key})).icon:void 0}var ns=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).icon=ts(a.props.themeAlgorithm),a}return(0,J.Z)(n,[{key:"getThemeItems",value:function(){var e=this;return es.map((function(t){return r.rV((0,v.jsxs)(m.Z,{children:[Z.Z.t("theme:".concat(t.label)),e.props.themeAlgorithm.includes(t.key)?(0,v.jsx)(_r.Z,{style:{marginLeft:"5px"}}):null]}),t.key,t.icon)}))}},{key:"render",value:function(){var e=this;return(0,v.jsx)(o.Z,{menu:{items:this.getThemeItems(),onClick:function(t){var n;n="compact"===t.key?e.props.themeAlgorithm.includes("compact")?e.props.themeAlgorithm.filter((function(e){return"compact"!==e})):[].concat((0,Ve.Z)(e.props.themeAlgorithm),["compact"]):e.props.themeAlgorithm.includes(t.key)?(0,Ve.Z)(e.props.themeAlgorithm):"dark"===t.key?[].concat((0,Ve.Z)(e.props.themeAlgorithm.filter((function(e){return"default"!==e}))),[t.key]):[].concat((0,Ve.Z)(e.props.themeAlgorithm.filter((function(e){return"dark"!==e}))),[t.key]),e.icon=ts(n),e.props.onChange(n)},selectable:!0,multiple:!0,selectedKeys:(0,Ve.Z)(this.props.themeAlgorithm)},children:(0,v.jsx)("div",{className:"select-box",children:this.icon})})}}]),n}(y.Component),as=ns,is=n(69888),rs=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a,i;return(0,G.Z)(this,n),(i=t.call(this,e)).canTour=function(){var e=window.location.pathname.replace("/","");return-1!==M.W1.indexOf(e)||""===e},i.state={isTourVisible:null!==(a=e.isTourVisible)&&void 0!==a?a:M.x5()},i}return(0,J.Z)(n,[{key:"render",value:function(){return this.canTour()?(0,v.jsx)(l.Z,{title:"Click to open tour",children:(0,v.jsx)("div",{className:"select-box",style:(0,a.Z)({display:r.tq()?"none":null},this.props.style),onClick:function(){return M.o4(!0)},children:(0,v.jsx)(is.Z,{style:{fontSize:"24px"}})})}):(0,v.jsx)("div",{className:"select-box",style:(0,a.Z)({display:r.tq()?"none":null,cursor:"not-allowed"},this.props.style),children:(0,v.jsx)(is.Z,{style:{fontSize:"24px",color:"#adadad"}})})}}]),n}(y.Component),ss=n(30036);function os(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/delete-transaction"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}var ls=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return fetch("".concat(r.nn,"/api/get-transactions?owner=").concat(e,"&p=").concat(t,"&pageSize=").concat(n,"&field=").concat(a,"&value=").concat(i,"&sortField=").concat(s,"&sortOrder=").concat(o),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}(r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newTransaction",value:function(){var e=r.VO();return{owner:r.jb(this.props.account),name:"transaction_".concat(e),createdTime:Fe()().format(),displayName:"New Transaction - ".concat(e),provider:"provider_pay_paypal",category:"",type:"PayPal",productName:"computer-1",productDisplayName:"A notebook computer",detail:"This is a computer with excellent CPU, memory and disk",tag:"Promotion-1",currency:"USD",amount:0,returnUrl:"https://door.casdoor.com/transactions",user:"admin",application:"",payment:"payment_bhn1ra",state:"Paid"}}},{key:"deleteTransaction",value:function(e){var t=this;os(this.state.data[e]).then((function(e){"ok"===e.status?(r.PV("success",Z.Z.t("general:Successfully deleted")),t.fetch({pagination:(0,a.Z)((0,a.Z)({},t.state.pagination),{},{current:t.state.pagination.current>1&&1===t.state.data.length?t.state.pagination.current-1:t.state.pagination.current})})):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(e.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"addTransaction",value:function(){var e=this,t=this.newTransaction();(function(e){var t=r.p$(e);return fetch("".concat(r.nn,"/api/add-transaction"),{method:"POST",credentials:"include",body:JSON.stringify(t),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(t).then((function(n){"ok"===n.status?(e.props.history.push({pathname:"/transactions/".concat(t.owner,"/").concat(t.name),mode:"add"}),r.PV("success",Z.Z.t("general:Successfully added"))):r.PV("error","".concat(Z.Z.t("general:Failed to add"),": ").concat(n.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"180px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/transactions/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",fixed:"left",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Provider"),dataIndex:"provider",key:"provider",width:"150px",sorter:!0},this.getColumnSearchProps("provider")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/providers/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(t.owner,"/").concat(e),children:e})}}),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},{title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"140px",align:"center",filterMultiple:!1,filters:r.oz("Payment").map((function(e){return{text:e.id,value:e.name}})),sorter:!0,render:function(e,t,n){return t.category="Payment",la.Il(t)}},(0,a.Z)((0,a.Z)({title:Z.Z.t("payment:Product"),dataIndex:"productDisplayName",key:"productDisplayName",sorter:!0},this.getColumnSearchProps("productDisplayName")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/products/".concat(t.owner,"/").concat(t.productName),children:e})}}),(0,a.Z)({title:Z.Z.t("payment:Currency"),dataIndex:"currency",key:"currency",width:"120px",sorter:!0},this.getColumnSearchProps("currency")),(0,a.Z)({title:Z.Z.t("transaction:Amount"),dataIndex:"amount",key:"amount",width:"120px",sorter:!0},this.getColumnSearchProps("amount")),(0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Application"),dataIndex:"application",key:"application",width:"120px",sorter:!0},this.getColumnSearchProps("application")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/applications/".concat(t.owner,"/").concat(t.application),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Payment"),dataIndex:"payment",key:"payment",width:"120px",sorter:!0},this.getColumnSearchProps("payment")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/payments/".concat(t.owner,"/").concat(t.payment),children:e})}}),(0,a.Z)({title:Z.Z.t("general:State"),dataIndex:"state",key:"state",width:"120px",sorter:!0},this.getColumnSearchProps("state")),{title:Z.Z.t("general:Action"),dataIndex:"",key:"op",width:"240px",fixed:r.tq()?"false":"right",render:function(e,n,a){return(0,v.jsxs)("div",{children:[(0,v.jsx)(d.ZP,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:function(){return t.props.history.push("/transactions/".concat(n.owner,"/").concat(n.name))},children:Z.Z.t("general:Edit")}),(0,v.jsx)(Ke,{title:Z.Z.t("general:Sure to delete")+": ".concat(n.name," ?"),onConfirm:function(){return t.deleteTransaction(a)}})]})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Transactions"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{type:"primary",size:"small",onClick:t.addTransaction.bind(t),children:Z.Z.t("general:Add")})]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),cs=ls,ds=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(e){var a;return(0,G.Z)(this,n),(a=t.call(this,e)).state={classes:e,organizationName:void 0!==e.organizationName?e.organizationName:e.match.params.organizationName,transactionName:e.match.params.transactionName,application:null,transaction:null,providers:[],mode:void 0!==e.location.mode?e.location.mode:"edit"},a}return(0,J.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getTransaction()}},{key:"getTransaction",value:function(){var e,t,n=this;(e=this.state.organizationName,t=this.state.transactionName,fetch("".concat(r.nn,"/api/get-transaction?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))).then((function(e){null!==e.data?(n.setState({transaction:e.data}),r.cx("invoice-area")):n.props.history.push("/404")}))}},{key:"submitTransactionEdit",value:function(e){var t=this,n=r.p$(this.state.transaction);(function(e,t,n){var a=r.p$(n);return fetch("".concat(r.nn,"/api/update-transaction?id=").concat(e,"/").concat(encodeURIComponent(t)),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))})(this.state.transaction.owner,this.state.transactionName,n).then((function(n){"ok"===n.status?(r.PV("success",Z.Z.t("general:Successfully saved")),t.setState({transactionName:t.state.transaction.name}),e?t.props.history.push("/transactions"):t.props.history.push("/transactions/".concat(t.state.organizationName,"/").concat(t.state.transaction.name))):(r.PV("error","".concat(Z.Z.t("general:Failed to save"),": ").concat(n.msg)),t.updatePaymentField("name",t.state.transactionName))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"deleteTransaction",value:function(){var e=this;os(this.state.transaction).then((function(t){"ok"===t.status?e.props.history.push("/transactions"):r.PV("error","".concat(Z.Z.t("general:Failed to delete"),": ").concat(t.msg))})).catch((function(e){r.PV("error","".concat(Z.Z.t("general:Failed to connect to server"),": ").concat(e))}))}},{key:"parseTransactionField",value:function(e,t){return[""].includes(e)&&(t=r.Js(t)),t}},{key:"getApplication",value:function(){var e=this;W.i6("admin",this.state.applicationName).then((function(t){if(null!==t.data)if("error"!==t.status){var n=t.data;null!==n.grantTypes&&void 0!==n.grantTypes&&0!==n.grantTypes.length||(n.grantTypes=["authorization_code"]),null!==n.tags&&void 0!==n.tags||(n.tags=[]),e.setState({application:n}),e.getCerts(n),e.getSamlMetadata(n.enableSamlPostBinding)}else r.PV("error",t.msg);else e.props.history.push("/404")}))}},{key:"renderTransaction",value:function(){var e=this;return(0,v.jsxs)(h.Z,{size:"small",title:(0,v.jsxs)("div",{children:["add"===this.state.mode?Z.Z.t("transaction:New Transaction"):Z.Z.t("transaction:Edit Transaction"),"\xa0\xa0\xa0\xa0",(0,v.jsx)(d.ZP,{onClick:function(){return e.submitTransactionEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",onClick:function(){return e.submitTransactionEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},onClick:function(){return e.deleteTransaction()},children:Z.Z.t("general:Cancel")}):null]}),style:r.tq()?{margin:"5px"}:{},type:"inner",children:[(0,v.jsxs)(R.Z,{style:{marginTop:"10px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Organization"),Z.Z.t("general:Organization - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.owner,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Name"),Z.Z.t("general:Name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.name,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Display name"),Z.Z.t("general:Display name - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.displayName,onChange:function(t){e.updatePaymentField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Provider"),Z.Z.t("general:Provider - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.provider,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Category"),Z.Z.t("provider:Category - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.category,onChange:function(t){e.updatePaymentField("displayName",t.target.value)}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("provider:Type"),Z.Z.t("payment:Type - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.type,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Product"),Z.Z.t("payment:Product - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.productName,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Detail"),Z.Z.t("product:Detail - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.detail,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("user:Tag"),Z.Z.t("transaction:Tag - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.tag,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("payment:Currency"),Z.Z.t("payment:Currency - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.currency,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("transaction:Amount"),Z.Z.t("transaction:Amount - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.amount,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("product:Return URL"),Z.Z.t("product:Return URL - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.user,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:User"),Z.Z.t("general:User - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.user,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Application"),Z.Z.t("general:Application - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.application,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:Payment"),Z.Z.t("general:Payment - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.payment,onChange:function(e){}})})]}),(0,v.jsxs)(R.Z,{style:{marginTop:"20px"},children:[(0,v.jsxs)(L.Z,{style:{marginTop:"5px"},span:r.tq()?22:2,children:[r.id(Z.Z.t("general:State"),Z.Z.t("general:State - Tooltip"))," :"]}),(0,v.jsx)(L.Z,{span:22,children:(0,v.jsx)(ae.Z,{disabled:!0,value:this.state.transaction.state,onChange:function(e){}})})]})]})}},{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{children:[null!==this.state.transaction?this.renderTransaction():null,(0,v.jsxs)("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[(0,v.jsx)(d.ZP,{size:"large",onClick:function(){return e.submitTransactionEdit(!1)},children:Z.Z.t("general:Save")}),(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:function(){return e.submitTransactionEdit(!0)},children:Z.Z.t("general:Save & Exit")}),"add"===this.state.mode?(0,v.jsx)(d.ZP,{style:{marginLeft:"20px"},size:"large",onClick:function(){return e.deleteTransaction()},children:Z.Z.t("general:Cancel")}):null]})]})}}]),n}(y.Component);var ps=function(e){(0,Q.Z)(n,e);var t=(0,K.Z)(n);function n(){var e;(0,G.Z)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchedColumn,i=t.searchText,s=t.sortField,o=t.sortOrder;void 0!==t.type&&null!==t.type&&(n="type",i=t.type),e.setState({loading:!0}),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return fetch("".concat(r.nn,"/api/get-verifications?owner=").concat(e,"&p=").concat(n,"&pageSize=").concat(a,"&field=").concat(i,"&value=").concat(s,"&sortField=").concat(o,"&sortOrder=").concat(l),{method:"GET",credentials:"include",headers:{"Accept-Language":r.CI()}}).then((function(e){return e.json()}))}("",r.Qy(e.props.account)?"":r.jb(e.props.account),t.pagination.current,t.pagination.pageSize,n,i,s,o).then((function(n){e.setState({loading:!1}),"ok"===n.status?e.setState({data:n.data,pagination:(0,a.Z)((0,a.Z)({},t.pagination),{},{total:n.data2}),searchText:t.searchText,searchedColumn:t.searchedColumn}):r.Ai(n)?e.setState({isAuthorized:!1}):r.PV("error",n.msg)}))},e}return(0,J.Z)(n,[{key:"newVerification",value:function(){var e=r.VO();return{owner:"admin",name:"Verification_".concat(e),createdTime:Fe()().format()}}},{key:"renderTable",value:function(e){var t=this,n=[(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0},this.getColumnSearchProps("owner")),{},{render:function(e,t,n){return"admin"===e?"(".concat(Z.Z.t("general:empty"),")"):(0,v.jsx)(T.rU,{to:"/organizations/".concat(e),children:e})}}),(0,a.Z)({title:Z.Z.t("general:Name"),dataIndex:"name",key:"name",width:"260px",fixed:"left",sorter:!0},this.getColumnSearchProps("name")),{title:Z.Z.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:function(e,t,n){return r.L0(e)}},(0,a.Z)({title:Z.Z.t("provider:Type"),dataIndex:"type",key:"type",width:"90px",sorter:!0},this.getColumnSearchProps("type")),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:User"),dataIndex:"user",key:"user",width:"120px",sorter:!0},this.getColumnSearchProps("user")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/users/".concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Provider"),dataIndex:"provider",key:"provider",width:"150px",sorter:!0},this.getColumnSearchProps("provider")),{},{render:function(e,t,n){return(0,v.jsx)(T.rU,{to:"/providers/".concat(t.owner,"/").concat(e),children:e})}}),(0,a.Z)((0,a.Z)({title:Z.Z.t("general:Client IP"),dataIndex:"remoteAddr",key:"remoteAddr",width:"100px",sorter:!0},this.getColumnSearchProps("remoteAddr")),{},{render:function(e,t,n){var a=e;return a.endsWith(": ")&&(a=a.slice(0,-2)),(0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://db-ip.com/".concat(a),children:a})}}),(0,a.Z)({title:Z.Z.t("verification:Receiver"),dataIndex:"receiver",key:"receiver",width:"120px",sorter:!0},this.getColumnSearchProps("receiver")),(0,a.Z)({title:Z.Z.t("login:Verification code"),dataIndex:"code",key:"code",width:"150px",sorter:!0},this.getColumnSearchProps("code")),{title:Z.Z.t("verification:Is used"),dataIndex:"isUsed",key:"isUsed",width:"90px",sorter:!0,render:function(e,t,n){return(0,v.jsx)(re.Z,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:e})}}],i={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(){return Z.Z.t("general:{total} in total").replace("{total}",t.state.pagination.total)}};return(0,v.jsx)("div",{children:(0,v.jsx)(Ee.Z,{scroll:{x:"max-content"},columns:n,dataSource:e,rowKey:function(e){return"".concat(e.owner,"/").concat(e.name)},size:"middle",bordered:!0,pagination:i,title:function(){return(0,v.jsxs)("div",{children:[Z.Z.t("general:Verifications"),"\xa0\xa0\xa0\xa0"]})},loading:this.state.loading,onChange:this.handleTableChange})})}}]),n}(jt),us=ps;var hs=(0,f.EN)((function(e){var t=(0,y.useState)(!1),n=(0,i.Z)(t,2),g=n[0],m=n[1];function x(){var t=[];!1===e.requiredEnableMfa&&t.push(r.rV((0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(k.Z,{}),"\xa0\xa0",Z.Z.t("account:My Account")]}),"/account")),t.push(r.rV((0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(C.Z,{}),"\xa0\xa0",Z.Z.t("account:Logout")]}),"/logout"));return(0,v.jsx)(o.Z,{menu:{items:t,onClick:function(t){"/account"===t.key?e.history.push("/account"):"/subscription"===t.key?e.history.push("/subscription"):"/logout"===t.key&&ss.kS().then((function(t){if("ok"===t.status){var n=e.account.owner;e.setLogoutState(),(0,Ea.clearWeb3AuthToken)(),r.PV("success",Z.Z.t("application:Logged out successfully"));var a=t.data2;null!==a&&void 0!==a&&""!==a?r.iF(a):"built-in"!==n?r.iF("".concat(window.location.origin,"/login/").concat(n)):r.d8({props:e},"/")}else r.PV("error","Failed to log out: ".concat(t.msg))}))}},children:(0,v.jsxs)("div",{className:"rightDropDown",children:[""===e.account.avatar?(0,v.jsx)(s.Z,{style:{backgroundColor:r.hx(e.account.name),verticalAlign:"middle"},size:"large",children:r.VQ(e.account.name)}):(0,v.jsx)(s.Z,{src:e.account.avatar,style:{verticalAlign:"middle"},size:"large",icon:(0,v.jsx)(Xe.Z,{src:e.account.avatar,style:{verticalAlign:"middle"},size:40}),children:r.VQ(e.account.name)}),"\xa0 \xa0",r.tq()?null:r.xu(r.w2(e.account.displayName),30)," \xa0 ",(0,v.jsx)(b.Z,{}),"\xa0 \xa0 \xa0"]})},"/rightDropDown")}function E(){var t,n=[];if(null===e.account||void 0===e.account)return[];var a="black",i=e.themeData.colorPrimary,s=e.account.organization.logo?e.account.organization.logo:r.R7(e.themeAlgorithm);e.themeAlgorithm.includes("dark")&&(e.account.organization.logoDark&&(s=e.account.organization.logoDark),a="white"),!r.tq()&&n.push({label:(0,v.jsx)(T.rU,{to:"/",children:(0,v.jsx)("img",{className:"logo",src:null!==(t=s)&&void 0!==t?t:e.logo,alt:"logo"})}),disabled:!0,key:"logo",style:{padding:0,height:"auto"}}),n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/",children:Z.Z.t("general:Home")}),"/home",(0,v.jsx)(w.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/",children:Z.Z.t("general:Dashboard")}),"/"),r.rV((0,v.jsx)(T.rU,{to:"/shortcuts",children:Z.Z.t("general:Shortcuts")}),"/shortcuts"),r.rV((0,v.jsx)(T.rU,{to:"/apps",children:Z.Z.t("general:Apps")}),"/apps")].filter((function(t){return r.$J(e.account)})))),r.$J(e.account)&&(At.M9&&n.push(r.rV((0,v.jsx)("a",{href:"https://casdoor.com",children:(0,v.jsx)("span",{style:{fontWeight:"bold",backgroundColor:"rgba(87,52,211,0.4)",marginTop:"12px",paddingLeft:"5px",paddingRight:"5px",display:"flex",alignItems:"center",height:"40px",borderRadius:"5px"},children:"\ud83d\ude80 SaaS Hosting \ud83d\udd25"})}),"#")),n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/organizations",children:Z.Z.t("general:User Management")}),"/orgs",(0,v.jsx)(P.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/organizations",children:Z.Z.t("general:Organizations")}),"/organizations"),r.rV((0,v.jsx)(T.rU,{to:"/groups",children:Z.Z.t("general:Groups")}),"/groups"),r.rV((0,v.jsx)(T.rU,{to:"/users",children:Z.Z.t("general:Users")}),"/users"),r.rV((0,v.jsx)(T.rU,{to:"/invitations",children:Z.Z.t("general:Invitations")}),"/invitations")])),n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/applications",children:Z.Z.t("general:Identity")}),"/identity",(0,v.jsx)(A.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/applications",children:Z.Z.t("general:Applications")}),"/applications"),r.rV((0,v.jsx)(T.rU,{to:"/providers",children:Z.Z.t("general:Providers")}),"/providers"),r.rV((0,v.jsx)(T.rU,{to:"/resources",children:Z.Z.t("general:Resources")}),"/resources"),r.rV((0,v.jsx)(T.rU,{to:"/certs",children:Z.Z.t("general:Certs")}),"/certs")])),n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/roles",children:Z.Z.t("general:Authorization")}),"/auth",(0,v.jsx)(I.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/roles",children:Z.Z.t("general:Roles")}),"/roles"),r.rV((0,v.jsx)(T.rU,{to:"/permissions",children:Z.Z.t("general:Permissions")}),"/permissions"),r.rV((0,v.jsx)(T.rU,{to:"/models",children:Z.Z.t("general:Models")}),"/models"),r.rV((0,v.jsx)(T.rU,{to:"/adapters",children:Z.Z.t("general:Adapters")}),"/adapters"),r.rV((0,v.jsx)(T.rU,{to:"/enforcers",children:Z.Z.t("general:Enforcers")}),"/enforcers")].filter((function(t){return!(!r.$J(e.account)&&["/models","/adapters","/enforcers"].includes(t.key))})))),n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/sessions",children:Z.Z.t("general:Logging & Auditing")}),"/logs",(0,v.jsx)(F.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/sessions",children:Z.Z.t("general:Sessions")}),"/sessions"),At.pf?r.rV((0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:At.pf,children:Z.Z.t("general:Records")}),"/records"):r.rV((0,v.jsx)(T.rU,{to:"/records",children:Z.Z.t("general:Records")}),"/records"),r.rV((0,v.jsx)(T.rU,{to:"/tokens",children:Z.Z.t("general:Tokens")}),"/tokens"),r.rV((0,v.jsx)(T.rU,{to:"/verifications",children:Z.Z.t("general:Verifications")}),"/verifications")])),n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/products",children:Z.Z.t("general:Business & Payments")}),"/business",(0,v.jsx)(z.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/products",children:Z.Z.t("general:Products")}),"/products"),r.rV((0,v.jsx)(T.rU,{to:"/payments",children:Z.Z.t("general:Payments")}),"/payments"),r.rV((0,v.jsx)(T.rU,{to:"/plans",children:Z.Z.t("general:Plans")}),"/plans"),r.rV((0,v.jsx)(T.rU,{to:"/pricings",children:Z.Z.t("general:Pricings")}),"/pricings"),r.rV((0,v.jsx)(T.rU,{to:"/subscriptions",children:Z.Z.t("general:Subscriptions")}),"/subscriptions"),r.rV((0,v.jsx)(T.rU,{to:"/transactions",children:Z.Z.t("general:Transactions")}),"/transactions")])),r.VN(e.account)?n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/sysinfo",children:Z.Z.t("general:Admin")}),"/admin",(0,v.jsx)(N.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/sysinfo",children:Z.Z.t("general:System Info")}),"/sysinfo"),r.rV((0,v.jsx)(T.rU,{to:"/syncers",children:Z.Z.t("general:Syncers")}),"/syncers"),r.rV((0,v.jsx)(T.rU,{to:"/webhooks",children:Z.Z.t("general:Webhooks")}),"/webhooks"),r.rV((0,v.jsx)("a",{target:"_blank",rel:"noreferrer",href:r.a8()?"".concat(r.nn,"/swagger"):"/swagger",children:Z.Z.t("general:Swagger")}),"/swagger")])):n.push(r.rV((0,v.jsx)(T.rU,{style:{color:a},to:"/syncers",children:Z.Z.t("general:Admin")}),"/admin",(0,v.jsx)(N.Z,{twoToneColor:i}),[r.rV((0,v.jsx)(T.rU,{to:"/syncers",children:Z.Z.t("general:Syncers")}),"/syncers"),r.rV((0,v.jsx)(T.rU,{to:"/webhooks",children:Z.Z.t("general:Webhooks")}),"/webhooks")])));var o=e.account.organization.navItems;return Array.isArray(o)?o.includes("all")?n:n.map((function(e){if(!Array.isArray(e.children))return e;var t=[];return e.children.forEach((function(e){o.includes(e.key)&&t.push(e)})),e.children=t,e})).filter((function(e){return"#"===e.key||"logo"===e.key||Array.isArray(e.children)&&e.children.length>0})):n}function R(t){return null===e.account?(sessionStorage.setItem("from",window.location.pathname),(0,v.jsx)(f.l_,{to:"/login"})):void 0===e.account?null:e.account.needUpdatePassword?(0,v.jsx)(f.l_,{to:"/forget/"+e.application.name}):t}function L(){var t=e.account,n=e.onChangeTheme,i=e.onfinish;return(0,v.jsxs)(f.rs,{children:[(0,v.jsx)(f.AW,{exact:!0,path:"/",render:function(e){return R((0,v.jsx)(B,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/apps",render:function(e){return R((0,v.jsx)(ee,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/shortcuts",render:function(e){return R((0,v.jsx)(te,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/account",render:function(e){return R((0,v.jsx)(xt,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/organizations",render:function(e){return R((0,v.jsx)(kt,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/organizations/:organizationName",render:function(e){return R((0,v.jsx)(fn,(0,a.Z)({account:t,onChangeTheme:n},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/organizations/:organizationName/users",render:function(e){return R((0,v.jsx)(bn,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/trees/:organizationName",render:function(e){return R((0,v.jsx)(zn,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/trees/:organizationName/:groupName",render:function(e){return R((0,v.jsx)(zn,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/groups",render:function(e){return R((0,v.jsx)(Un,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/groups/:organizationName/:groupName",render:function(e){return R((0,v.jsx)(En,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/users",render:function(e){return R((0,v.jsx)(bn,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/users/:organizationName/:userName",render:function(e){return(0,v.jsx)(gt,(0,a.Z)({account:t},e))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/invitations",render:function(e){return R((0,v.jsx)(qn,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/invitations/:organizationName/:invitationName",render:function(e){return R((0,v.jsx)(Mn,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/applications",render:function(e){return R((0,v.jsx)(ea,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/applications/:organizationName/:applicationName",render:function(e){return R((0,v.jsx)(ba,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/providers",render:function(e){return R((0,v.jsx)(wa,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/providers/:organizationName/:providerName",render:function(e){return R((0,v.jsx)(qa,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/records",render:function(e){return R((0,v.jsx)(Ba,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/resources",render:function(e){return R((0,v.jsx)(Ha,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/certs",render:function(e){return R((0,v.jsx)(Ja,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/certs/:organizationName/:certName",render:function(e){return R((0,v.jsx)(Ya,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/verifications",render:function(e){return R((0,v.jsx)(us,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/roles",render:function(e){return R((0,v.jsx)(ni,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/roles/:organizationName/:roleName",render:function(e){return R((0,v.jsx)(ai,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/permissions",render:function(e){return R((0,v.jsx)(li,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/permissions/:organizationName/:permissionName",render:function(e){return R((0,v.jsx)(ui,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/models",render:function(e){return R((0,v.jsx)(gi,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/models/:organizationName/:modelName",render:function(e){return R((0,v.jsx)(fi,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/adapters",render:function(e){return R((0,v.jsx)(Ci,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/adapters/:organizationName/:adapterName",render:function(e){return R((0,v.jsx)(Si,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/enforcers",render:function(e){return R((0,v.jsx)(Ai,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/enforcers/:organizationName/:enforcerName",render:function(e){return R((0,v.jsx)(Ni,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/sessions",render:function(e){return R((0,v.jsx)(Ei,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/tokens",render:function(e){return R((0,v.jsx)(Oi,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/tokens/:tokenName",render:function(e){return R((0,v.jsx)(Di,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/products",render:function(e){return R((0,v.jsx)(Wi,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/products/:organizationName/:productName",render:function(e){return R((0,v.jsx)(Ji,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/products/:organizationName/:productName/buy",render:function(e){return R((0,v.jsx)(Hi.Z,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/payments",render:function(e){return R((0,v.jsx)(_i,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/payments/:organizationName/:paymentName",render:function(e){return R((0,v.jsx)(Xi,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/payments/:organizationName/:paymentName/result",render:function(e){return R((0,v.jsx)(er.Z,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/plans",render:function(e){return R((0,v.jsx)(ar,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/plans/:organizationName/:planName",render:function(e){return R((0,v.jsx)(rr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/pricings",render:function(e){return R((0,v.jsx)(lr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/pricings/:organizationName/:pricingName",render:function(e){return R((0,v.jsx)(dr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/subscriptions",render:function(e){return R((0,v.jsx)(xr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/subscriptions/:organizationName/:subscriptionName",render:function(e){return R((0,v.jsx)(vr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/sysinfo",render:function(e){return R((0,v.jsx)(br,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/syncers",render:function(e){return R((0,v.jsx)(Pr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/syncers/:syncerName",render:function(e){return R((0,v.jsx)(zr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/transactions",render:function(e){return R((0,v.jsx)(cs,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/transactions/:organizationName/:transactionName",render:function(e){return R((0,v.jsx)(ds,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/webhooks",render:function(e){return R((0,v.jsx)(Er,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/webhooks/:webhookName",render:function(e){return R((0,v.jsx)(Dr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/ldap/:organizationName/:ldapId",render:function(e){return R((0,v.jsx)(Hr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/ldap/sync/:organizationName/:ldapId",render:function(e){return R((0,v.jsx)(Gr,(0,a.Z)({account:t},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/mfa/setup",render:function(e){return R((0,v.jsx)(le.ZP,(0,a.Z)({account:t,onfinish:i},e)))}}),(0,v.jsx)(f.AW,{exact:!0,path:"/.well-known/openid-configuration",render:function(e){return(0,v.jsx)(Qr,{})}}),(0,v.jsx)(f.AW,{path:"",render:function(){return(0,v.jsx)(c.ZP,{status:"404",title:"404 NOT FOUND",subTitle:Z.Z.t("general:Sorry, the page you visited does not exist."),extra:(0,v.jsx)("a",{href:"/",children:(0,v.jsx)(d.ZP,{type:"primary",children:Z.Z.t("general:Back Home")})})})}})]})}var O=function(){m(!1)};return(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(j,{account:e.account}),(0,v.jsxs)(rn.h4,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0",marginBottom:"4px",backgroundColor:e.themeAlgorithm.includes("dark")?"black":"white"},children:[e.requiredEnableMfa||(r.tq()?(0,v.jsxs)(y.Fragment,{children:[(0,v.jsx)(p.Z,{title:Z.Z.t("general:Close"),placement:"left",open:g,onClose:O,children:(0,v.jsx)(u.Z,{items:E(),mode:"inline",selectedKeys:[e.selectedMenuKey],style:{lineHeight:"64px"},onClick:O})}),(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(U.Z,{}),onClick:function(){m(!0)},type:"text",children:Z.Z.t("general:Menu")})]}):(0,v.jsx)("div",{style:{flex:1,overflow:"hidden",paddingBottom:"1px"},children:(0,v.jsx)(u.Z,{onClick:O,items:E(),mode:"horizontal",selectedKeys:[e.selectedMenuKey],style:{backgroundColor:e.themeAlgorithm.includes("dark")?"black":"white"}})})),(0,v.jsx)("div",{style:{flexShrink:0},children:function(){return void 0===e.account?null:null===e.account?(0,v.jsx)(y.Fragment,{children:(0,v.jsx)(Kr.Z,{})}):(0,v.jsxs)(y.Fragment,{children:[x(),(0,v.jsx)(as,{themeAlgorithm:e.themeAlgorithm,onChange:e.setLogoAndThemeAlgorithm}),(0,v.jsx)(Kr.Z,{languages:e.account.organization.languages}),(null===(t=At.MD)||void 0===t?void 0:t.trim())&&(0,v.jsx)(l.Z,{title:"Click to open AI assistant",children:(0,v.jsx)("div",{className:"select-box",onClick:e.openAiAssistant,children:(0,v.jsx)(S.Z,{style:{fontSize:"24px"}})})}),(0,v.jsx)(rs,{}),r.VN(e.account)&&-1===e.uri.indexOf("/trees")&&(0,v.jsx)(In.Z,{initValue:r.Xu(),withAll:!0,className:"org-select",style:{display:r.tq()?"none":"flex"},onChange:function(e){r.nD(e)}})]});var t}()})]}),(0,v.jsx)(rn.VY,{style:{display:"flex",flexDirection:"column"},children:r.tq()||window.location.pathname.startsWith("/trees")?L():(0,v.jsx)(h.Z,{className:"content-warp-card",children:L()})})]})}))},97578:function(e,t,n){"use strict";n.r(t),n.d(t,{authViaMetaMask:function(){return F},authViaWeb3Onboard:function(){return R},checkEthereumSignedTypedData:function(){return I},clearWeb3AuthToken:function(){return S},delWeb3AuthToken:function(){return b},detectMetaMaskPlugin:function(){return w},generateNonce:function(){return j},getWeb3AuthToken:function(){return C},getWeb3AuthTokenKey:function(){return T},getWeb3OnboardWalletsOptions:function(){return U},initWeb3Onboard:function(){return E},requestEthereumAccount:function(){return P},setWeb3AuthToken:function(){return k},signEthereumTypedData:function(){return A}});var a=n(74165),i=n(29439),r=n(15861),s=n(3548),o=n(96351),l=n(95162),c=n(2109),d=n(20293),p=n(40918),u=n(7826),h=n(34530),g=n(24054),m=n(20913),x=n(23328),Z=n(35068),y=n(68943),f=n(85708),v=n(63601);function j(){return(0,l.Z)()}function T(e){return"Web3AuthToken_".concat(e)}function k(e){var t=T(e.address);localStorage.setItem(t,JSON.stringify(e))}function C(e){var t=T(e);return JSON.parse(localStorage.getItem(t))}function b(e){var t=T(e);localStorage.removeItem(t)}function S(){Object.keys(localStorage).forEach((function(e){e.startsWith("Web3AuthToken_")&&localStorage.removeItem(e)}))}function w(){return window.ethereum&&window.ethereum.isMetaMask}function P(){return window.ethereum.request({method:"eth_requestAccounts"}).then((function(e){return e[0]}))}function A(e,t){var n=new Date,a=JSON.stringify({domain:{chainId:window.ethereum.chainId,name:"Casdoor",version:"1"},message:{prompt:"In order to authenticate to this website, sign this request and your public address will be sent to the server in a verifiable way.",nonce:t,createAt:"".concat(n.toLocaleString())},primaryType:"AuthRequest",types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"}],AuthRequest:[{name:"prompt",type:"string"},{name:"nonce",type:"string"},{name:"createAt",type:"string"}]}}),i=[e,a];return window.ethereum.request({method:"eth_signTypedData_v4",params:i}).then((function(t){return{address:e,createAt:Math.floor(n.getTime()/1e3),typedData:a,signature:t}}))}function I(e){return void 0!==e&&null!==e&&(!!(e.address&&e.typedData&&e.signature)&&(0,c.recoverTypedSignature)({data:JSON.parse(e.typedData),signature:e.signature,version:c.SignTypedDataVersion.V4})===e.address)}function F(e,t,n){return z.apply(this,arguments)}function z(){return(z=(0,r.Z)((0,a.Z)().mark((function e(t,n,i){var r,l,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w()){e.next=3;break}return(0,s.PV)("error","".concat(o.Z.t("login:MetaMask plugin not detected"))),e.abrupt("return");case 3:return e.prev=3,e.next=6,P();case 6:if(r=e.sent,I(C(r))){e.next=14;break}return l=j(),e.next=12,A(r,l);case 12:k(e.sent);case 14:c="".concat((0,d.N6)(t,n,i),"&web3AuthTokenKey=").concat(T(r)),(0,s.iF)(c),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),(0,s.PV)("error","".concat(o.Z.t("login:Failed to obtain MetaMask authorization"),": ").concat(e.t0.message));case 21:case"end":return e.stop()}}),e,null,[[3,18]])})))).apply(this,arguments)}n.g.Buffer=p.Buffer;var N={injected:{label:"Injected",wallet:(0,h.ZP)()},coinbase:{label:"Coinbase",wallet:(0,f.Z)()},trust:{label:"Trust",wallet:(0,x.Z)()},gnosis:{label:"Gnosis",wallet:(0,v.Z)()},sequence:{label:"Sequence",wallet:(0,m.Z)()},taho:{label:"Taho",wallet:(0,y.Z)()},frontier:{label:"Frontier",wallet:(0,Z.Z)()},infinityWallet:{label:"Infinity Wallet",wallet:(0,g.Z)()}};function U(){return Object.entries(N).map((function(e){var t=(0,i.Z)(e,2),n=t[0];return{label:t[1].label,value:n}}))}function E(e,t){var n=function(e){return null!==e&&void 0!==e&&Array.isArray(e)?e.map((function(e){var t,n;if(e&&null!==(t=N[e])&&void 0!==t&&t.wallet)return null===(n=N[e])||void 0===n?void 0:n.wallet})):[]}(JSON.parse(t.metadata));return(0,u.Z)({wallets:n,chains:[{id:"0x13881",token:"MATIC",label:"Polygon - Mumbai",rpcUrl:"https://matic-mumbai.chainstacklabs.com"},{id:"0x38",token:"BNB",label:"Binance",rpcUrl:"https://bsc-dataseed.binance.org/"},{id:"0xA",token:"OETH",label:"Optimism",rpcUrl:"https://mainnet.optimism.io"},{id:"0xA4B1",token:"ARB-ETH",label:"Arbitrum",rpcUrl:"https://rpc.ankr.com/arbitrum"}],appMetadata:{name:"Casdoor",description:"Connect a wallet using Casdoor",recommendedInjectedWallets:[{name:"MetaMask",url:"https://metamask.io"},{name:"Coinbase",url:"https://www.coinbase.com/wallet"}]}})}function R(e,t,n){return L.apply(this,arguments)}function L(){return(L=(0,r.Z)((0,a.Z)().mark((function e(t,n,i){var r,l,c,p,u,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=E(0,n),e.next=4,r.connectWallet();case 4:(l=e.sent).length>0&&(c=l[0],p=c.accounts[0],u=p.address,k({address:u,walletType:c.label,createAt:Math.floor((new Date).getTime()/1e3)}),h="".concat((0,d.N6)(t,n,i),"&web3AuthTokenKey=").concat(T(u)),(0,s.iF)(h)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),(0,s.PV)("error","".concat(o.Z.t("login:Failed to obtain Web3-Onboard authorization"),": ").concat(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}},993:function(){},32772:function(){},44814:function(){},68329:function(){},5612:function(){},46601:function(){},72260:function(){},72895:function(){},13121:function(){},31865:function(){}}]);